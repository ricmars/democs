var gridSortFieldName="";
if("undefined"!=typeof pega){var filterDBP=function(f){this.gridObj=f;this.po=pega.u.d.getPopOver();this.bind=function(){var f=pega.ctx.dom.getElementById("clearFilter"),l=pega.u.d.getPopOverLevel(f);0<=l&&(this.po=pega.u.d.getPopOver(l));pega.util.Event.addListener(f,Grids.EVENT_CLICK,this.onClearFilterClick,this,!0);pega.util.Event.addListener(f,"keypress",this.onClearFilterClick,this,!0)};this.unbind=function(){var f=pega.ctx.dom.getElementById("clearFilter");pega.util.Event.removeListener(f,Grids.EVENT_CLICK,
this.onClearFilterClick);pega.util.Event.removeListener(f,"keypress",this.onClearFilterClick)};this.onClearFilterClick=function(f){var k=f.type;pega.util.Event.getTarget(f);f=f.keyCode;if("click"==k||"keypress"==k&&13==f)this.gridObj.clearFiltering(),this.po.close("clearFilter")}},userAgentString=navigator.userAgent.toLowerCase();0<userAgentString.indexOf("chrome")&&0>userAgentString.indexOf("edge")&&document.documentElement.className&&0>document.documentElement.className.indexOf("chrome")&&(document.documentElement.className+=
" chrome ");pega.ctx.Grid||(pega.ctx.Grid={isFilterMenuItemClicked:!1,map:{},dataSourceToUId:{},activeGrid:null});if(!window.Grids||1===window.Grids.nodeType&&"Grids"==window.Grids.id)window.Grids={filterMap:{},iAttribute:"dataSource",INIT_GRID_TABLES:0,SET_UL_HEIGHT:1,EVENT_CLICK:"click",EVENT_RIGHT_CLICK:"contextmenu",EVENT_DOUBLE_CLICK:"dblclick",adjustVisibleGrids:function(f){for(var k in pega.ctx.Grid.map)if(pega.ctx.Grid.map.hasOwnProperty(k)&&f.querySelector("#"+k)){var l=pega.ctx.Grid.map[k];
l.bAdjusted||(l.fixVisibleGrid(),l.bAdjusted=!0)}},getGrid:function(f){return pega.ctx.Grid.map[f]},getActiveGrid:function(f){return this.getElementsGrid(pega.util.Event.getTarget(f))},filterActiveGrid:function(f){var k=this.getActiveGrid(f);k&&k.menusOnProperEvent(null,f)},getElementsGrid:function(f){if(!pega.ctx.Grid)return null;pega.ctx.Grid.activeGrid=null;if(f&&null!=f){for(;f&&f.getAttribute&&null==f.getAttribute("bGrid")&&null==f.getAttribute("gridId")&&!(f=f.parentNode,null==f||f.tagName&&
"HTML"==f.tagName););if(f&&null!=f&&f.tagName&&"HTML"!=f.tagName)if(f.getAttribute("gridId"))f=f.getAttribute("gridId"),pega.ctx.Grid.map[f]&&(pega.ctx.Grid.activeGrid=pega.ctx.Grid.map[f]);else for(var k in pega.ctx.Grid.map)if(pega.ctx.dom.getElementById(k)==f){pega.ctx.Grid.activeGrid=pega.ctx.Grid.map[k];break}}return pega.ctx.Grid.activeGrid},setActiveGrid:function(f){pega.ctx.Grid.activeGrid=pega.ctx.Grid.map[f]},addGrid:function(f,k){pega.ctx.Grid.map[f]=k;var l=k.gridDiv,a=l.getAttribute("datasource")||
"",b=k.getPLPGProperty()||"",c=a.lastIndexOf(b),c=c+b.length,a=a.substring(0,c);k.dataSourceRef=a;(b=pega.ctx.Grid.dataSourceToUId[a])&&pega.ctx.dom.getElementById(b)||(pega.ctx.Grid.dataSourceToUId[a]=f);f=pega.u.d.getSectionId(pega.u.d.getSectionDiv(l));pega.u.d.registerAsHarnessElement(k,f)},deleteGrid:function(f){pega.ctx.Grid.map[f]==pega.ctx.Grid.activeGrid&&(pega.ctx.Grid.activeGrid=null);pega.ctx.Grid.map[f]==pega.ctx.Grid.focusedGrid&&(pega.ctx.Grid.focusedGrid=null);pega.u.d.ClientEventAPI&&
pega.ctx.Grid.map[f]==pega.u.d.ClientEventAPI.srcGrid&&(pega.u.d.ClientEventAPI.srcGrid=null);pega.ctx.Grid.map[f]=null;delete pega.ctx.Grid.map[f]},deleteAllGridObjects:function(){try{if(Grids&&pega.ctx.Grid){for(var f in pega.ctx.Grid.map)pega.ctx.Grid.map[f].nullify(!0);pega.ctx.Grid.map={};pega.ctx.isMDC||(Grids=null)}}catch(k){console.log(k)}},getAllGrids:function(){return pega.ctx.Grid.map},deleteAllGrids:function(){pega.ctx.Grid.map={}},initGridContextObject:function(){pega.ctx.Grid||(pega.ctx.Grid=
{isFilterMenuItemClicked:!1,map:{},dataSourceToUId:{},activeGrid:null})},findActiveGrid:function(f,k){f=void 0==f?window.event:f;Grids.setActiveGrid(k.getAttribute(Grids.iAttribute));pega.util.Event.stopPropagation(f)},getActiveGridDetails:function(f){f=f||window.event;f=pega.util.Event.getTarget(f);var k=null,l;for(l in pega.ctx.Grid.map){var a=pega.ctx.Grid.map[l];a.editConfig==a.EDIT_HARNESS?pega.util.Dom.isAncestor(a.gridDetailsDiv,f)&&(k=a):a.editConfig==a.EDIT_EXPANDPANE&&pega.util.Dom.isAncestor(a.gridDiv,
f)&&(k=a)}return k},storeCurrentFocussedElem:function(f){f||(f=window.event);f.which||(f.which=f.keyCode);if(9==f.which)try{var k=Grids.getActiveGrid(f).gridDiv.getAttribute("dataSource"),l=Grids.getActiveTHIndex(document.activeElement);pega.ctx.Grid.cacheInfo||(pega.ctx.Grid.cacheInfo={});0<=l&&(pega.ctx.Grid.cacheInfo[encodeURIComponent(k)]||(pega.ctx.Grid.cacheInfo[encodeURIComponent(k)]={}),pega.ctx.Grid.cacheInfo[encodeURIComponent(k)].focussedElementIndex=""+l,pega.ctx.Grid.cacheInfo[encodeURIComponent(k)].focussedElementTagName=
document.activeElement.tagName,pega.ctx.Grid.cacheInfo[encodeURIComponent(k)].focussedElementID=document.activeElement.id)}catch(a){}},getActiveTHIndex:function(f){try{if("TH"!=f.tagName)for(var k=1;"th"!=f.tagName.toLowerCase()&&10>k;)f=f.parentNode,k++;if(f.tagName&&"th"!=f.tagName.toLowerCase())return-1;var l=f.parentNode;if(l.tagName&&"tr"!=l.tagName.toLowerCase())return-2;for(var a=l.getElementsByTagName("th"),k=0;k<a.length;k++)if(a[k].parentNode===l&&a[k]===f)return k;return-3}catch(b){return-4}},
reFocusPrevFocussedElem:function(f){try{var k=f.gridDiv.getAttribute("dataSource");if(pega.ctx.Grid.cacheInfo[encodeURIComponent(k)]){var l=pega.ctx.Grid.cacheInfo[encodeURIComponent(k)].focussedElementIndex,a=pega.ctx.Grid.cacheInfo[encodeURIComponent(k)].focussedElementTagName,b=pega.ctx.Grid.cacheInfo[encodeURIComponent(k)].focussedElementID,c,d=f.gridcontDiv.getElementsByTagName("th")[0].parentNode;if(d&&d.tagName&&"tr"==d.tagName.toLowerCase()){var e=d.getElementsByTagName("th"),g;f=!1;for(k=
0;k<e.length&&!f;k++)e[k].parentNode===d&&k==l&&(g=e[k],f=!0);if(g){if("th"==a.toLowerCase()||"div"==a.toLowerCase()){c=g;g.removeAttribute("aria-describedby");for(var h=g.getElementsByTagName("span"),k=0;k<h.length;k++)"sort"==h[k].id&&(c=h[k])}else if("span"==a.toLowerCase()||"a"==a.toLowerCase())for(h=g.getElementsByTagName(a),k=0;k<h.length;k++)"sort"==b?"sort"==h[k].id&&(c=h[k]):"pui_filter"==h[k].id&&(c=h[k]);g.querySelector("a#pui_colmenu")&&"sort"===c.id&&(c=g.querySelector(".divCont"));c&&
c.focus&&c.focus()}}}}catch(m){}}};window.doGridAction||(window.doGridAction=function(f,k,l,a,b,c,d){f=void 0==f?window.event:f;var e=null;if(d||"PAGINATE"!=k||!(pega.u.d.bModalDialogOpen&&pega.u.d.isAjaxInProgress()||!pega.u.d.bModalDialogOpen&&pega.c&&pega.c.actionSequencer&&!pega.c.actionSequencer.isQueueEmpty())){a&&a.dataSource&&(e=pega.ctx.Grid.dataSourceToUId[a.dataSource],(e=pega.ctx.Grid.map[e])&&e!==pega.ctx.Grid.activeGrid&&(pega.ctx.Grid.activeGrid=e));e||(e=Grids.getActiveGrid(f));if(!e){e=
f.cachedGridObj;if(!e||!pega.util.Dom.inDocument(e.gridDiv,document)&&(e=pega.ctx.Grid.dataSourceToUId[e.dataSourceRef],e=pega.ctx.Grid.map[e],!e))return;if(e&&e!==pega.ctx.Grid.activeGrid){var g=e;if(d=f.cachedGridRowId)if(d=pega.ctx.dom.getElementById(d)){g=pega.util.Dom.getFirstChild(d);e.setActiveRow(null,null,e.getRowIndex(g));var h=f.cachedGridCellIndex,g=-1==h||"TR"!=d.tagName?g:d.cells.length>h?d.cells[h]:d}f.target?f.target=g:f.srcElement=g;pega.ctx.Grid.activeGrid=e}}(d=e.getActiveRowIndex())||
(d="");e.editConfig==e.EDIT_ROW&&""!=d&&"DELETE"!=k&&"EDITITEM"!=k&&(g=e.rightBodyTbl.rows[e.getIndex(d)],pega.util.Dom.hasClass(g,"editMode")&&(g=f.type,h=pega.util.Event.getTarget(f),g={type:g,target:h,keyCode:f.keyCode,context:e},g.handler=e.submitRow,g.args=e,e.pushToQueue(g)));if(e.editConfig==e.EDIT_ROW&&""!=d&&"EDITITEM"==k&&pega.util.Event.isIE&&8>=pega.util.Event.isIE&&(g=e.rightBodyTbl.rows[e.getIndex(d)],!pega.util.Dom.hasClass(g,"editMode")))try{document.selection&&document.selection.empty()}catch(n){}if(e.editConfig==
e.EDIT_ROW&&""!=d&&"EDITITEM"==k){var g=e.rightBodyTbl.rows[e.getIndex(d)],m;e.getIndex(d+1)&&(m=e.rightBodyTbl.rows[e.getIndex(d+1)]);if(pega.util.Dom.hasClass(g,"editMode")||pega.util.Dom.hasClass(m,"editMode"))return}"DELETE"==k&&(window.rowDeleted=!0);e.doGridAction(f,k,l,a,b,"false"===c?!1:c)}},window.getGridProperty=function(f,k){return Grids.getActiveGrid(f).getPropertyText(k)});pega.ui.initGrids=function(f){if(pega.util.Dom.hasClass(document.body,"forPrinting")){window.printWin=!0;f=window.opener.pega.ctx.Grid.map;
for(var k in f){var l=pega.ctx.dom.getElementById(k);l&&(f=new pega.ui.grid(l),Grids.addGrid(l.id,f))}}else if(k=f&&"undefined"!=typeof f?pega.util.Dom.getElementsById("PEGA_GRID",f.gridDiv):pega.ctx.dom.querySelectorAll("#PEGA_GRID")){pega.ctx.Grid||(pega.ctx.Grid={isFilterMenuItemClicked:!1,map:{},dataSourceToUId:{},activeGrid:null});pega.ctx.isMDC&&pega.ui.EventsEmitter.subscribeOnce("postMDCRender",Grids.initGridContextObject,null);f=k.length;for(var a=0;a<f;a++)if(l=k[a],!l||l.hasAttribute("class")&&
l.hasAttribute("bGrid")){var b=l.id+pega.ui.gridCounter;l.id=b;var c=new pega.ui.grid(l);c.pzHarnessID=pega.ctx.pzHarnessID;Grids.addGrid(b,c);pega.ui.gridCounter++;pega.ctx.isMDC&&0===c.gridDiv.offsetHeight&&pega.ui.EventsEmitter.subscribeOnce("postMDCRender",c.onPostMDCRenderFixGrid.bind(c),null);if(pega.u.d.tabViewMap&&0===c.gridDiv.offsetHeight){for(l=l.parentNode;!l.getAttribute("tabgroupid");)if(l=l.parentNode,"HARNESS_CONTENT"==l.id.toUpperCase()||"BODY"==l.nodeName){l=null;break}if(l&&(l=
pega.u.d.tabViewMap[l.id])&&(b=l._configs.tabs.value[l.get("activeIndex")])&&!pega.util.Dom.isAncestor(b._configs.contentEl.value,c.gridDiv))l.on("activeTabChange",c.fixVisibleGrid,null,c)}}}};pega.ui.grid||function(){var f=pega.util.Dom,k=pega.util.Event;pega.ui.gridCounter=0;var l=pega.u.d;l.inCall=!1;pega.u.d.eventsArray=[];pega.u.d.changeInEventsArray=new pega.util.CustomEvent("changeInEventsArray");l.changeInEventsArray.subscribe(function(a,b,c){pega.ui.grid.prototype.executeNextEvent()});pega.ui.grid=
function(a){this.gridDiv=a;this.init()};pega.ui.grid.prototype={ROW_REPEAT:"row",COL_REPEAT:"col",SELECTED_CLASS:"gridCellSelected",EDIT_READWRITE:"readWrite",EDIT_ROW:"row",EDIT_MODAL:"modal",EDIT_READONLY:"readOnly",EDIT_HARNESS:"harness",EDIT_EXPANDPANE:"expandPane",CONTENT_DIV_ID:"PEGA_GRID_CONTENT",MODAL_ACTION:"",EDIT_ACTION:"EDITROW",SUBMIT_ACTION:"SUBMITROW",REFRESH_ROWS_ACTION:"REFRESHROWS",FLOW_ACTION:"FLOWACTION",dirty:!1,sortType:"",sortProperty:"",DONOT_SUBMIT:!1,widthSet:!1,performWriteOperations:function(){for(var a=
this.writeCases,b=this.writeCasesVars,c=a.length,d,e=0;e<c;e++)switch(d=a[e],d){case Grids.INIT_GRID_TABLES:!this.bTree&&this.bTreegrid&&this.fixedRow&&this.leftHeaderDiv&&this.leftBodyDiv&&1==f.hasClass(this.gridcontDiv,"gPercent")&&(this.leftBodyDiv.style.width=this.leftHeaderDiv.offsetWidth+"px");this.bPXFixed&&this.fixedCol&&this.fixedRow&&(d=0,this.leftBodyUL&&(d=this.leftBodyUL.offsetHeight),this.leftBodyDiv&&0<d&&parseInt(this.leftBodyDiv.style.height)>d&&(this.leftBodyDiv.style.height=d+"px"));
d=b.INIT_GRID_TABLES.leftBodyULNewID;var g=b.INIT_GRID_TABLES.rightHeaderTblNewID;d&&(this.leftBodyUL.id=d);g&&(this.rightHeaderTbl.id=g);break;case Grids.SET_UL_HEIGHT:if(this.bTreegrid||this.fixedCol)d=f.getFirstChild(f.getFirstChild(this.leftBodyUL)),g=this.rightBodyTbl.rows[0].cells[0].offsetHeight,d&&g&&(d.style.height=g+"px")}this.writeCases=[];this.writeCasesVars={}},init:function(){this.writeCases=[];this.writeCasesVars={};this.gridcontDiv=pega.util.Dom.getElementsById(this.CONTENT_DIV_ID,
this.gridDiv)[0];this.initGridConfig();this.initGridTables();this.dynamicGridHeaderA11y();this.bRowVisibleWhen||this.removeFilteredGridAttribute();this.initPLProps();this.setFilterPage();this.selectNewRow();this.setRowHandleCellWidth();var a=this;if(window.printWin)this.prepareForPrint();else if(this.initEventHandlers(),this.initScrollbars(),this.bTreegrid&&!pega.u.d.DISABLE_TREEGRID_HEIGHT_ADJUSTMENT&&this.updateTreeGridRowHeight(),1==f.hasClass(this.gridcontDiv,"gPercent")&&!this.fixedCol&&this.fixedRow){var b=
this;this.gridResizeHandler2=function(){b.synchHeadersForPercent();b.setHeadersWidth();b.updateHeaderCellsWidth()};pega.u.d.registerResize(this.gridResizeHandler2)}var c=a.gridDiv.closest("#EXPAND-INNERDIV");c&&"none"===c.style.display&&k.addListener(c.parentNode,"click",a.onExpandFixGrid,a,!0);c=this.rightBodyTbl.rows;if("true"===this.gridDiv.getAttribute("data-virtualrd")&&this.gridDiv.getAttribute("data-click")&&this.gridDiv.getAttribute("oafunc"))try{if(c[1]&&!this.bTreegrid)for(var d=f.hasClass(c[1],
"grid-categorize-header")?2:1;d<c.length;d++)if(c[d]&&c[d].cells[0]&&!c[d].cells[0].classList.contains("expandPane")){c[d].cells[0].firstChild.role="link";c[d].cells[0].firstChild.tabIndex="0";var e=c[d].cells[0].textContent,g=c[d].getAttribute("oaargs");g&&-1!==g.indexOf(" ")&&(g=g.split(" "),g=g[g.length-1],g!==e&&(e=e+" "+g));c[d].cells[0].firstChild.setAttribute("aria-label",e);c[d].cells[0].firstChild.setAttribute("data-ctl","")}}catch(r){}else try{c[1]&&!this.bTreegrid&&(d=f.hasClass(c[1],"grid-categorize-header")?
2:1,c[d]&&c[d].cells[0]&&!c[d].cells[0].classList.contains("expandPane")&&(c[d].cells[0].tabIndex="0"))}catch(r){}if(this.bTreegrid)for(d=f.getChildren(this.leftBodyUL),e=0;e<d.length;e++)d[e].getAttribute("PL_INDEX");this.bCategorizedGrid&&this.updateCategoryCounts();this.setCalculationsForProgressiveLoad();this.autoAdjustProgressiveGridHeight();this.hideScrollHeadForMobile();if(this.bTreegrid&&f.hasClass(this.rightBodyTbl,"resizedTable")&&(c=this.rightBodyTbl.rows,g=0,c&&0<c.length&&(e=c[1].cells)&&
0<e.length&&(g=e[0].offsetHeight),(d=f.getChildren(this.leftBodyUL))&&0<d.length))for(e=1;e<d.length;e++)(c=f.getFirstChild(d[e]))&&0!=g&&(c.style.height=g+"px");this.bTreegrid&&this.gridBodyLeftParent&&1==f.hasClass(this.gridcontDiv,"gPercent")&&(e=pega.util.Dom.getElementsById("gridLayoutTable",this.gridcontDiv)[0],""!=this.gridBodyLeftParent.style.width&&e&&e.rows&&e.rows[0].cells&&(e.rows[0].cells[1].width="100%"));if(c=this.rightBodyTbl.rows)for(var h=c[0].cells,e=0;e<h.length;e++)pega.util.Dom.hasClass(h[e],
"wrapText")&&(c=f.getFirstChild(h[e]),k.isIE?f.getNextSibling(f.getFirstChild(c)):(f.getNextSibling(f.getFirstChild(f.getFirstChild(c))),c.style.height="auto"));if(this.bTreegrid&&k.isIE&&(d=f.getChildren(this.leftBodyUL),g=0,d&&0<d.length))for(e=1;e<d.length;e++)if("true"==d[e].getAttribute("isWrapEnabled")){var c=f.getFirstChild(d[e]),m=f.getNextSibling(f.getFirstChild(c)),g=f.getNextSibling(f.getFirstChild(m)).offsetHeight;if(c&&0!=g){c.style.height=g+"px";f.getFirstChild(c).style.height=g+"px";
m.style.height=g+"px";for(var c=this.rightBodyTbl.rows,n=e;n<c.length;n++)for(h=c[n].cells,m=1;m<h.length;m++)h[m].style.height=g+"px"}}if(pega.env.ua.webkit&&f.hasClass(this.rightBodyTbl,"resizedTable")&&(c=this.rightBodyTbl.rows)&&0<c.length)for(e=0;e<c.length;e++)if((g=c[e].children)&&0<g.length)for(m=0;m<g.length;m++)null!=f.getFirstChild(g[m])&&(f.getFirstChild(g[m]).style.maxHeight="none");this.setHeightForNoResults();if((e=this.gridcontDiv.getAttribute("gridActiveRow"))||"true"===this.gridcontDiv.getAttribute("callFADetails"))this.bSelectRowOnLoad=
!1,this.selectRow(1,!1);"true"===this.gridcontDiv.getAttribute("refreshLayoutFromConfig")&&(this.refreshLayoutFromConfig="true");c=f.getElementsById("Grid_NoResults",this.gridDiv);this.bSelectRowOnLoad&&!c&&(e={rowEle:this.getLeftRow(1),refObj:this},this.selectPage(null,null,1),pega.c&&pega.c.actionSequencer&&!pega.u.d.gIsScriptsLoading&&!pega.u.d.isAjaxInProgress()?this.triggerEditInHarness(e):this.setTopPriorityAction(this.triggerEditInHarness,e),pega.ctx.Grid.focusedGrid&&this!=pega.ctx.Grid.focusedGrid&&
pega.ctx.Grid.focusedGrid.focusGrid(!1),this.focusGrid(!0),pega.ctx.Grid.focusedGrid=this);if("true"===this.gridcontDiv.getAttribute("callFADetails")||"true"===this.gridcontDiv.getAttribute("callNextFADetails")&&this.editConfig==this.EDIT_HARNESS)if(e={},g=this.gridcontDiv.getAttribute("editRowIndex"),g=f.getElementsById(g,this.gridDiv))g=g[0],e.target=f.getChildren(g)[0],e.nodeName="TD",e.type=Grids.EVENT_CLICK,e.skipPreProcessingActivity=!0,"true"===this.gridcontDiv.getAttribute("callFADetails")&&
(this.comingFromAdd="true"),this.doGridAction(e,"EDITITEM");"CSS1Compat"!==document.compatMode&&-1!=navigator.userAgent.indexOf("MSIE 8")&&"readWrite"==this.editConfig&&(e=this.gridcontDiv.getElementsByTagName("select"))&&0<e.length&&(this.disableRowHovering=!0);"true"==this.bHideGridHdrWhenNoRows&&this.toggleGridStylesForNoResultsCase();"Progressive Load"==this.pageMode&&this.attachOnloadProgressiveGridHeightAdjust();window.Grids&&pega.util.Event.addListener(this.gridcontDiv,"keyup",Grids.storeCurrentFocussedElem,
this,!0);if(window.Grids&&(Grids.reFocusPrevFocussedElem(this),""!=gridSortFieldName&&!pega.ctx.Grid.isFilterMenuItemClicked)){g=pega.ctx.dom.getElementsByTagName("th");for(e=0;e<g.length;e++)g[e].hasAttribute("sortfield")&&g[e].getAttribute("sortfield")==gridSortFieldName&&g[e].focus();gridSortFieldName=""}!(e=this.gridcontDiv.getAttribute("gridActiveRow"))||this.bSelectRowOnLoad||c||(this.getLeftRow(e)&&(this.activeRow=e,this.selectRow(e,!0)),this.gridcontDiv.removeAttribute("gridActiveRow"));this.performWriteOperations();
pega.u.d.HeavyOperations.registerOnceOnInit("resizeHarness");this.bResponsiveGrid&&(this.previousMode=this.getCurrentMode(),this.gridResizeHandler=function(){a.callAPIsToAdjustGrid()},pega.u.d.registerResize(this.gridResizeHandler));c&&this.bTreegrid&&!this.bHideGridHdrWhenNoRows&&null!=this.getLeftRow(1)&&(e=parseFloat(this.getLeftRow(1).offsetHeight),(c=this.rightBodyTbl.rows)&&0<c.length&&(g=c[1].children)&&0<g.length&&(g[0].style.height=e+"px"));this.bFilterable&&k.isIE&&this.addHeightToFilterIcon()},
addHeightToFilterIcon:function(){var a;a=this.fixedRow&&this.rightHeaderTbl&&this.rightHeaderTbl.rows?this.rightHeaderTbl.rows[0]:this.rightBodyTbl.rows[0];for(var b=a.cells.length,c=0;c<b;c++){var d=a.cells[c];if(f.getElementsById("pui_filter",d)){var e=f.getElementsById("pui_filter",d,"span"),g=f.getElementsById("pui_filter",d,"a"),d=d.offsetHeight||d.style.height;if(d="number"==typeof d?d+"px":0<d.indexOf("px")?d:0)e&&e[0]&&(e[0].style.height=d),g&&g[0]&&(g[0].style.height=d)}}},toggleGridStylesForNoResultsCase:function(){var a=
f.getNextSibling(this.gridcontDiv);this.rightBodyTbl&&this.rightBodyTbl.rows&&1<this.rightBodyTbl.rows.length?(pega.u.d.inStandardsMode?pega.env.ua.ie?this.gridcontDiv.style.display="inline":1==f.hasClass(this.gridcontDiv,"gPercent")?this.gridcontDiv.style.display="block":this.gridcontDiv.style.display="inline-block":this.gridcontDiv.style.display="block",a.style.display="none"):(this.gridcontDiv.style.display="none",a.style.display="block")},setCalculationsForProgressiveLoad:function(a){if("Progressive Load"==
this.pageMode&&0<this.totalRecords){var b=1;this.noOfPagesLoaded=1;this.totalRecords>this.rangeSize&&!a&&(this.noOfPagesLoaded=2);(this.editConfig==this.EDIT_EXPANDPANE||this.bCategorizedGrid)&&this.updateExpandedDtlsHeight();this.bDiscardInvisibleRows&&(this.currentScrollTop=this.layoutWrapperDiv.scrollTop,this.updateTopBottomBufferHeights(),this.originalTotalRecords=this.totalRecords,this.customLoadStartIndex&&""!=this.customLoadStartIndex&&(this.customLoadStartIndex=""));if(this.currentPageIndex&&
1<this.currentPageIndex){if(!this.bDiscardInvisibleRows)if(this.totalRecords<this.currentPageIndex*this.rangeSize&&(this.currentPageIndex=2),this.noOfPagesLoaded=this.currentPageIndex,--this.currentPageIndex,""!=this.getActiveRowIndex()&&"undefined"!=typeof this.getActiveRowIndex())var c=this.getLeftRow();else b=(this.currentPageIndex-1)*this.rangeSize+1,c=this.getLeftRow(b);a||this.regBeforeProgressiveLoad(this.stopProgressiveLoad);this.bDiscardInvisibleRows?window.scrollTopBeforeReorder&&this.bFilteredGrid?
(this.layoutWrapperDiv.scrollTop=window.scrollTopBeforeReorder,delete window.scrollTopBeforeReorder):(b=(this.currentPageIndex-1)*this.rangeSize+1,this.layoutWrapperDiv.scrollTop=b*this.rowHeight):this.layoutWrapperDiv.scrollTop=c.offsetTop}this.bDiscardInvisibleRows||(this.rowHeight=this.getLeftRow(b).offsetHeight);this.rowHeight&&(this.layoutWrapperDiv.style.height=Math.floor(this.rowHeight*this.rangeSize)+2+"px");this.shrinkHeightToContainer&&!a&&(a=pega.u.d.noScrollContainer)&&a.attachOnLoads([this.shrinkToContainer,
[a.getContentContainerElement()],this])}},getCurrentMode:function(){return this.isInFatList()?"fatlist":this.isColumnsDropped()?"otherlist":"normallist"},attachOnloadProgressiveGridHeightAdjust:function(){var a=this;this.adjustProgressiveGridSize=function(){setTimeout(function(){try{a.autoAdjustProgressiveGridHeight({invokedFromAttachOnLoad:"yes"})}catch(b){}a=null},300)};pega.u.d.attachOnload(this.adjustProgressiveGridSize,!0)},updateHeaderCellsWidth:function(){if(!(this.bResponsiveGrid&&this.isInFatList()||
this.bTree||this.bTreegrid||!this.fixedRow&&"Progressive Load"!=this.pageMode||1!=f.hasClass(this.gridcontDiv,"gPercent"))&&this.rightHeaderTbl){var a,b=this.rightBodyTbl.rows;if(this.editConfig!=this.EDIT_EXPANDPANE)for(var c=1;b&&c<b.length;c++){if(!f.hasClass(b[c],"grid-categorize-header")){a=b[c];break}}else for(c=1;b&&c<b.length;c++)if("true"!=b[c].getAttribute("expanded")&&!f.hasClass(b[c],"grid-categorize-header")){a=b[c];break}if(a&&"Grid_NoResults"!=a.id){for(var d=this.rightHeaderTbl.rows[0],
e=0,g=d.offsetWidth,c=0;a&&a.cells&&c<a.cells.length;c++){var h=a.cells[c],m=h.offsetWidth;f.hasClass(h,"rowHandle")&&0!=m&&(d.cells[c].style.width=m+"px",b[0].cells[c].style.width=m+"px");e+=parseFloat(m,10)}for(c=0;0<e&&a&&a.cells&&c<a.cells.length;c++)if(h=a.cells[c],m=h.offsetWidth,!f.hasClass(h,"rowHandle")&&d&&d.cells[c]&&(h=parseFloat(m/g*100,10),h=isNaN(h)?"auto":h+"%",d.cells[c].style.width=h),h=b[0]&&b[0].cells[c])h.style.width=m/e*100+"%"}}},updateHeaderCellsAlignment:function(){if(this.rightBodyTbl&&
!this.bTree&&!this.bTreegrid){var a,b;a=this.rightHeaderTbl?this.rightHeaderTbl.rows[0]:this.rightBodyTbl.rows[0];b=this.rightBodyTbl.rows;if(null!=a&&null!=b){var c;if(this.editConfig!=this.EDIT_EXPANDPANE)for(var d=1;b&&d<b.length;d++){if(!f.hasClass(b[d],"grid-categorize-header")){c=b[d];break}}else for(d=1;b&&d<b.length;d++)if("true"!=b[d].getAttribute("expanded")&&!f.hasClass(b[d],"grid-categorize-header")){c=b[d];break}if(c)for(b=0;b<a.cells.length;b++){var e=c.cells[b],g="true"===a.cells[b].getAttribute("data-alignwithdata"),
d=f.getElementsByClassName("divCont","div",a.cells[b]);g&&e&&d&&1==d.length&&((g=f.getElementsByClassName("rightJustifyStyle","span",e))&&1<=g.length?(d[0].style.width="100%",d[0].className="rightJustifyStyle "+d[0].className,(e=f.getElementsById("pui_filter",a.cells[b],"a"))&&1<=e.length&&(d[0].style.paddingRight=parseInt(e[0].offsetWidth)+2+"px"),e||(d[0].style.paddingRight="2px")):(e=f.getElementsByClassName("centerJustifyStyle","span",e))&&1<=e.length&&(d[0].style.margin="0 auto",d[0].style.width=
"auto"))}}}},setHeightForNoResults:function(){var a=f.getElementsById("Grid_NoResults",this.gridDiv);if(a){if(a[0]&&(this.bTreegrid||this.fixedCol)){var b=f.getElementsBy(function(a){return""!=a.getAttribute("node_name")},"div",a[0])[0];b&&b.offsetHeight&&(a[0].style.height=b.offsetHeight+12+"px",f.getFirstChild(a[0]).style.height=b.offsetHeight+12+"px");var c=a[0].parentNode,d=a[0].offsetHeight+f.getFirstChild(c).offsetHeight;0!=d&&(c.style.height=d+"px");a[1]&&b&&(f.getFirstChild(a[1]).style.height=
b.offsetHeight+12+"px")}this.setHeadersWidth()}else this.setHeadersWidth(),this.updateHeaderCellsAlignment()},autoAdjustProgressiveGridHeight:function(a){if(this.pageMode&&"Progressive Load"==this.pageMode&&this.gridAutoHeight&&"true"==this.gridAutoHeight){var b=0;this.rightBodyTbl&&(b+=this.rightBodyTbl.offsetHeight);var c=this.getAvgRowHeight(),d=this.rowHeight;d||(d=0);c=c&&c>d?c:d;b&&!this.pyPaginateActivity&&c&&b<Math.floor(c*this.rangeSize)+2?(this.layoutWrapperDiv.style.height="auto",this.addRemoveScrollHeadToProgressiveGrid({scrollHead:"hide"}),
this.layoutWrapperDiv.style.overflowY="hidden"):f.getElementsById("Grid_NoResults",this.gridDiv)?(this.layoutWrapperDiv.style.height=0!=b?parseInt(b+2,10)+"px":"auto",this.addRemoveScrollHeadToProgressiveGrid({scrollHead:"hide",noitems:"true"}),this.layoutWrapperDiv.style.overflowY="hidden"):(a&&a.expandPane&&"true"==a.expandPane?this.layoutWrapperDiv.style.height=Math.floor(c*this.rangeSize)+2+"px":a&&a.afterLoadRow&&"true"==a.afterLoadRow&&this.layoutWrapperDiv.offsetHeight<parseInt(b+2,10)&&b<
Math.floor(c*this.rangeSize)+2?this.layoutWrapperDiv.style.height=parseInt(b+2,10)+"px":this.rangeSize==this.totalRecords&&(this.layoutWrapperDiv.style.height="auto"),this.addRemoveScrollHeadToProgressiveGrid({scrollHead:"show"}),this.layoutWrapperDiv.style.overflowY="auto");this.layoutWrapperDiv.style.overflowX="hidden";this.totalRecords==this.rangeSize&&this.adjustLayoutWrapperWidth();this.triggerBrowserReflow()}else a&&"true"==a.expandPane&&this.addRemoveScrollHeadToProgressiveGrid({scrollHead:"show"});
a&&"yes"==a.invokedFromAttachOnLoad&&5<this.layoutWrapperDiv.offsetHeight&&pega.u.d.detachOnload(this.adjustProgressiveGridSize)},shrinkToContainer:function(a){if(this.pageMode&&"Progressive Load"==this.pageMode){var b=a.offsetHeight,c=10;b<this.layoutWrapperDiv.offsetHeight&&(!pega.u.d.inStandardsMode&&k.isIE&&a.clientWidth<a.scrollWidth&&0!=a.clientWidth&&(c+=this.getScrollbarWidth()),this.layoutWrapperDiv.style.height=b-c+"px")}},updateCategoryCounts:function(){var a=f.getElementsById("categoryCounts",
this.gridDiv);if(a&&a[0]&&(a=a[0],(a=a.getAttribute("categoryCountsJSON"))&&""!=a)){var a=JSON.parse(a),b;for(b in a){var c=a[b],d=f.getElementsById(b,this.gridcontDiv);d&&d[0]&&(d[0].innerHTML=c)}}},triggerBrowserReflow:function(){for(var a=navigator.userAgent,b=["MSIE 8","MSIE 9"],c=0;c<b.length;c++)if(-1!=a.indexOf(b[c])){document.body.className=document.body.className;break}},hideScrollHeadForMobile:function(){var a=window.navigator.userAgent,b=f.getFirstChild(this.rightHeaderDiv),c=a.match(/iPad/i),
d=a.match(/iPhone/i),e=a.match(/Android/i),a=a.match(/safari/i)&&!a.match(/chrome/i);if(b&&(b=f.getElementsByClassName("scrollHead","th",b))&&0<b.length)if(c||d||e){if(d||c||e)b[0].parentNode.parentNode.parentNode.style.paddingRight="1px";b[0].parentNode.removeChild(b[0])}else!a||1<this.getScrollbarWidth()||b[0].parentNode.removeChild(b[0])},addRemoveScrollHeadToProgressiveGrid:function(a){if((!this.bResponsiveGrid||!this.isInFatList())&&a&&"Progressive Load"==this.pageMode&&this.rightHeaderDiv)if("show"==
a.scrollHead){a=!1;if(0==f.hasClass(this.gridcontDiv,"gPercent")&&-1!=navigator.userAgent.indexOf("MSIE")&&"CSS1Compat"===document.compatMode){a=!0;try{0<this.layoutWrapperDiv.offsetWidth&&(this.rightHeaderDiv.style.width=this.layoutWrapperDiv.offsetWidth-2+"px")}catch(e){}}for(var b=f.getFirstChild(this.rightHeaderDiv).getElementsByTagName("th"),c=!1,d=0;d<b.length;d++)if(f.hasClass(b[d],"scrollHead")){c=!0;break}if(!this.scrollHeadAdded||-1!=navigator.userAgent.indexOf("MSIE")&&!c)c=f.getFirstChild(this.rightHeaderDiv),
this.layoutWrapperDiv.scrollHeight>this.layoutWrapperDiv.clientHeight&&0!=this.layoutWrapperDiv.clientHeight&&c&&c.rows&&"none"!=c.rows[0].style.display&&(b=document.createElement("th"),b.style.width=this.getScrollbarWidth()+"px",f.addClass(b,"cellCont"),f.addClass(b,"scrollHead"),b.innerHTML="\x26nbsp;",0==f.hasClass(this.gridcontDiv,"gPercent")?(c=c.rows[0],c.appendChild(b),a&&this.rightHeaderDiv.offsetWidth<c.offsetWidth&&(this.rightHeaderDiv.style.width=c.offsetWidth+"px",this.layoutWrapperDiv.style.width=
c.offsetWidth+"px"),this.layoutWrapperDiv.offsetWidth<this.rightHeaderDiv.offsetWidth&&(this.layoutWrapperDiv.style.width=this.rightHeaderDiv.offsetWidth+"px")):(c=c.rows[0],c.appendChild(b)),this.scrollHeadAdded=!0,pega.env.ua.webkit&&!this.bTreegrid&&(a=b)&&0<a.length&&(a=a[0],a.style.width=parseInt(a.style.width)+1+"px",a.style.minWidth=a.style.width))}else if("hide"==a.scrollHead||"true"==a.noitems){if(0==f.hasClass(this.gridcontDiv,"gPercent")&&-1!=navigator.userAgent.indexOf("MSIE")&&"CSS1Compat"===
document.compatMode)try{0<this.rightHeaderDiv.offsetWidth&&(this.layoutWrapperDiv.style.width=this.rightHeaderDiv.offsetWidth+"px")}catch(e){}this.scrollHeadAdded&&(c=f.getFirstChild(this.rightHeaderDiv),this.layoutWrapperDiv.scrollHeight>this.layoutWrapperDiv.clientHeight&&0!=this.layoutWrapperDiv.clientHeight&&c&&c.rows&&"none"!=c.rows[0].style.display||(a=0==f.hasClass(this.gridcontDiv,"gPercent")?f.getElementsByClassName("scrollHead","th",c):f.getElementsByClassName("scrollHead","div",this.rightHeaderDiv))&&
0<a.length&&(a[0].parentNode.removeChild(a[0]),f.hasClass(this.gridcontDiv,"gPercent")&&(f.getFirstChild(this.rightHeaderDiv).style.width="100%")),this.scrollHeadAdded=!1)}},setTopPriorityAction:function(a,b){this.bTopPriorityActionSet=!0;pega.c.actionSequencer.setTopPriorityAction(a,b)},removeFilteredGridAttribute:function(){if(this.gridDiv.getAttribute("bFilteredGrid")&&"true"==this.gridDiv.getAttribute("bFilteredGrid")){for(var a=this.rightBodyTbl.rows[0],b=a.cells.length,c=0;c<b;c++){var d=a.cells[c];
if(f.getElementsById("pui_filter",d)&&(d=f.getElementsById("pui_filter",d)[0],f.hasClass(d,"filtered")))return}if(this.bTreegrid&&this.leftBodyUL&&(a=f.getFirstChild(this.leftBodyUL),f.getElementsById("pui_filter",a)&&(d=f.getElementsById("pui_filter",a)[0],f.hasClass(d,"filtered"))))return;this.gridDiv.removeAttribute("bFilteredGrid")&&(this.refreshLayout=this.bFilteredGrid=!1)}},DoNotFocusFADetails:function(){this.editConfig==this.EDIT_HARNESS&&(this.bDoNotFocusFADetails=!0)},stopProgressiveLoad:function(){this.unregBeforeProgressiveLoad();
return!1},regBeforeProgressiveLoad:function(a){this.beforeProgressiveLoadFn=a},unregBeforeProgressiveLoad:function(){this.beforeProgressiveLoadFn=""},setRowHandleCellWidth:function(){if(this.bNumberedSkin&&this.bGrid&&1<this.rightBodyTbl.rows.length){var a=f.getElementsByAttribute("onclick","*","span",this.rightBodyTbl.rows[this.rightBodyTbl.rows.length-1].cells[0]);if(0<a.length&&(a=a[0],a=a.offsetWidth)&&(a+=4,this.rightBodyTbl.rows[0].cells[0].style.width=a+"px",this.fixedRow&&this.rightHeaderTbl))if(0==
f.hasClass(this.gridcontDiv,"gPercent"))this.rightHeaderTbl.rows[0].cells[0].style.width=a+"px";else if(1==f.hasClass(this.gridcontDiv,"gPercent")){var b=this.rightHeaderTbl.rows[0].cells[0].getElementsByTagName("div");b&&0<b.length&&(b[0].style.width=pega.util.Event.isIE?a+2+"px":a-1+"px")}}},selectNewRow:function(){null!=this.gridcontDiv.getAttribute("editRowIndex")&&""!=this.gridcontDiv.getAttribute("editRowIndex")&&f.getElementsById(this.gridcontDiv.getAttribute("editRowIndex"),this.rightBodyTbl)&&
(this.activeRow=f.getElementsById(this.gridcontDiv.getAttribute("editRowIndex"),this.rightBodyTbl)[0].rowIndex,this.rightBodyTbl.rows[this.getIndex(this.activeRow)]||--this.activeRow,this.editRowCallback([this,this.activeRow]),"true"==this.gridcontDiv.getAttribute("reloadSomePages")&&(this.customLoadStartIndex=this.activeRow))},getScrollObj:function(a){a=a.parentNode;for(var b=window,c=0;a;){if("HARNESS_CONTENT"==a.id&&"true"==pega.u.d.keepFixedVisible){var d=pega.ctx.dom.getElementById("HARNESS_BUTTONS");
if(d&&(d.getElementsByTagName("button")&&0<d.getElementsByTagName("button").length||d.hasChildNodes()&&"HarnessFooter"==d.children[0].id))return[a,b,c]}if(a.offsetHeight<a.scrollHeight)return[a,b,c];a=a.parentNode;if(a==b.document.body)if(b.frameElement){if(a.offsetHeight<a.scrollHeight)return!k.isIE&&b.document.body.offsetHeight<b.document.body.scrollHeight?[b.document.body,b,c]:[b.document.documentElement,b,c];a=b.frameElement;c+=this.getAbsoluteTop(a);try{b=b.parent}catch(e){}}else return!k.isIE&&
b.document.body.offsetHeight<b.document.body.scrollHeight?[b.document.body,b,c]:[b.document.documentElement,b,c]}},getAbsoluteTop:function(a){var b=a.offsetTop;for(a=a.offsetParent;null!=a;)b+=a.offsetTop,a=a.offsetParent;return b},executeNextEvent:function(){if(!l.inCall&&0<l.eventsArray.length){var a=l.eventsArray.shift();a.context.isPartialRefresh&&"true"==a.context.isPartialRefresh&&(l.inCall=!0);a.context.refreshLayout=a.refreshLayout?!0:!1;"action"==a.type?(a.gridAction&&(a.context.action=a.gridAction),
a.handler.call(a.context,a.args)):a.handler.call(a.context,a.type,a.target,a.keyCode,a.args)}},pushToQueue:function(a){this.eventQueueEnd||(pega.u.d.eventsArray.push(a),pega.u.d.changeInEventsArray.fire())},nullify:function(a){pega.u.d.eventsArray=[];try{k.removeListener(this.gridDiv)}catch(e){}try{k.removeListener(this.leftBodyUL)}catch(e){}try{k.removeListener(this.rightBodyTbl)}catch(e){}try{k.removeListener(this.layoutWrapperDiv)}catch(e){}this.focusEventHandler&&!pega.env.ua.ie&&(this.gridDiv.removeEventListener("focus",
this.focusEventHandler,!0),this.focusEventHandler=null);if(this.editConfig==this.EDIT_HARNESS&&this.threadProcessing&&this.gridcontDiv.getAttribute("pyTargetSection")){k.removeListener(this.gridDetailsDiv,"focusin");k.removeListener(this.gridDetailsDiv,"focusout");k.removeListener(this.gridDetailsDiv,"mouseover");k.removeListener(this.gridDetailsDiv,"mouseout");this.tempSetExecutionThread&&this.tempResetExecutionThread&&!pega.env.ua.ie&&(this.gridDetailsDiv.removeEventListener("focus",this.tempSetExecutionThread,
!0),this.gridDetailsDiv.removeEventListener(Grids.EVENT_CLICK,this.tempSetExecutionThread,!0),this.gridDetailsDiv.removeEventListener("mouseover",this.tempSetExecutionThread,!0),this.gridDetailsDiv.removeEventListener("mouseout",this.tempResetExecutionThread,!0));try{k.removeListener(this.gridDetailsDiv)}catch(e){}}k.removeListener(document.body,Grids.EVENT_CLICK,this.resetExecutionThread);this.tempGridEventHandler&&(pega&&pega.capabilityList&&pega.capabilityList.isTouchAble()&&k.removeListener(document.body,
"touchstart",this.tempGridEventHandler),k.removeListener(document.body,"mouseup",this.tempGridEventHandler),this.bInlineEditGridInModal&&this.modalDetailsDiv&&k.removeListener(document.body,"mousedown",this.setModalScrollLeft),"true"==this.gridcontDiv.getAttribute("haswidth")&&this.editConfig==this.EDIT_ROW&&k.removeListener(document.body,"mousedown",this.setGridScrollLeft),this.tempGridEventHandler=null);this.tempSetExecutionThread&&this.tempResetExecutionThread&&!pega.env.ua.ie&&(document.body.removeEventListener("blur",
this.tempResetExecutionThread,!0),document.body.removeEventListener(Grids.EVENT_CLICK,this.tempResetExecutionThread,!0));this.tempSetExecutionThread&&this.tempResetExecutionThread&&!pega.env.ua.ie&&(this.tempResetExecutionThread=this.tempSetExecutionThread=null);if(this.threadProcessing&&(this.editConfig==this.EDIT_HARNESS||this.editConfig==this.EDIT_EXPANDPANE&&this.expandedElem&&f.isAncestor(this.rightBodyTbl,this.expandedElem))&&"undefined"!=typeof this.modalThreadContext&&""!=this.modalThreadContext&&
this.modalThreadContext!=this.baseThreadContext){var b=SafeURL_createFromURL(l.url);b.put("pyActivity","removeThead");b.put("threadName",this.modalThreadContext);l.asyncRequest("POST",b)}var c=this,d=function(){c.gridResizeHandler&&pega.u.d.unregisterResize(c.gridResizeHandler);c.gridResizeHandler2&&pega.u.d.unregisterResize(c.gridResizeHandler2);c.adjustProgressiveGridSize&&pega.u.d.detachOnload(c.adjustProgressiveGridSize);c.dbp&&(delete c.dbp.gridObj,delete c.dbp.po,delete c.dbp);k.removeListener(c.gridcontDiv,
"keyup");window.Grids.deleteGrid(c.gridDiv.id)},b=function(){var a=pega.ctx;setTimeout(function(){pega.ctxmgr.setContext(a);d();pega.ctxmgr.resetContext()},10)};a?d():b()},initGridConfig:function(){this.dbp=new filterDBP(this);var a=this.gridDiv,b=this.gridcontDiv;this.iKey=a.getAttribute("dataSource");this.bGrid="true"==a.getAttribute("bGrid");this.fixedRow="true"==a.getAttribute("fixedRow");this.bPXFixed=1==f.hasClass(this.gridcontDiv,"gPXFixed");this.fixedCol="true"==a.getAttribute("fixedCol");
this.repeatType=a.getAttribute("repeatType");this.bPageGroup="true"==a.getAttribute("bPageGroup");this.bValueList="true"==a.getAttribute("bValueList");this.bEditable="true"==a.getAttribute("bEditable");this.bRefreshOnUpdate="true"==a.getAttribute("bRefreshLayout");this.editConfig=a.getAttribute("editConfig");this.editFormat=a.getAttribute("editFormat");this.bShowExpandCollapseColumn="true"==a.getAttribute("bShowExpandCollapseColumn");this.bExpandMultipleRows="true"==a.getAttribute("bExpandMultipleRows");
this.bTreegrid="true"==a.getAttribute("bTreegrid");this.bTreegridSingleCol="true"==b.getAttribute("bTreegridSingleCol");this.bTree="true"==a.getAttribute("bTree");this.pageMode=b.getAttribute("pyPageMode");this.returnResultCount=b.getAttribute("pyReturnResultCount");this.gridAutoHeight=b.getAttribute("pyGridAutoHeight");this.shrinkHeightToContainer=b.getAttribute("pyNoScrollContainer");this.bDragDrop="true"==a.getAttribute("bDragDrop");this.deferLoadAct=a.getAttribute("deferLoadAct");this.appendAct=
a.getAttribute("appendAct");this.deleteAct=a.getAttribute("deleteAct");this.bRowHovering="true"==a.getAttribute("bRowHovering");this.bNumberedSkin=-1!=a.className.indexOf("numberedgrid");this.isPartialRefresh=this.gridcontDiv.getAttribute("ParitalRefresh");this.bOpenOnDblClick=this.editConfig==this.EDIT_READONLY||this.editConfig==this.EDIT_HARNESS||this.editConfig==this.EDIT_EXPANDPANE?"true"==a.getAttribute("openOnDblClick"):!1;this.OAFunc=a.getAttribute("OAFunc");this.bSelectRowOnLoad=this.editConfig==
this.EDIT_HARNESS?"true"==a.getAttribute("selectRowOnLoad"):!1;this.bSortable="true"==a.getAttribute("bSorting");this.sortProperty=this.gridcontDiv.getAttribute("sortProperty");this.sortType=this.gridcontDiv.getAttribute("sortType");this.categorizeBy=this.gridcontDiv.getAttribute("categorizeBy");this.bCategorizedGrid=this.editConfig==this.EDIT_READONLY&&"true"==this.gridcontDiv.getAttribute("categorizedGrid");this.bResponsiveGrid=-1!=this.gridcontDiv.className.indexOf("grid-responsive");this.gridPopoverLevel=
pega.u.d.getPopOverLevel(a);if(this.bInlineEditGridInModal=this.editConfig==this.EDIT_ROW&&pega.u.d.bModalDialogOpen)this.modalDetailsDiv=pega.ctx.dom.getElementsByClassName("modal-scroll-panel")[0],this.modalScrollLeft=0;"true"==this.gridcontDiv.getAttribute("haswidth")&&this.editConfig==this.EDIT_ROW&&(this.gridScrollLeft=0);this.bReportDefinition="true"==a.getAttribute("bReportDefinition");this.bDataObject="true"==a.getAttribute("bDataObject");this.bCBOptimize="true"==a.getAttribute("bCBOptimize");
this.gridPreActivity=a.getAttribute("grid-preactivity");this.gridPostActivity=a.getAttribute("grid-postactivity");this.bShowExpandDetails="true"==a.getAttribute("bShowExpandDetails");this.bShowExpandedAll="true"==this.gridcontDiv.getAttribute("showExpandedAll");this.threadProcessing="true"==this.gridcontDiv.getAttribute("threadProcessing");this.bAlwaysExpandRoot="true"==this.gridcontDiv.getAttribute("bAlwaysExpandRoot");this.editConfig==this.EDIT_READONLY&&this.bShowExpandDetails&&(this.bReadOnlyShowDetails=
!0,this.editConfig=this.EDIT_EXPANDPANE);this.bDataObject&&(this.hashedDPName=a.getAttribute("hashed-dp-page"));this.templateName=a.getAttribute("template-name")||this.getFATemplateName(null,!0);this.RDAppliesToClass=this.RDName="";this.bReportDefinition&&(this.RDName=a.getAttribute("RDName"),this.RDAppliesToClass=a.getAttribute("RDAppliesToClass"),this.RDContPage=a.getAttribute("RDContPage"),this.RDPageName=a.getAttribute("RDPageName"),this.RDParams=this.gridcontDiv.getAttribute("rdParams"),this.gridLayoutID=
a.getAttribute("gridLayoutID"),this.dynamicColumnIndex=this.gridcontDiv.getAttribute("dynamicColumnIndex"),this.bLoadActivity=a.getAttribute("bLoadActivity"));this.bDataObject&&(this.DPParams=this.gridcontDiv.getAttribute("dpParams"),this.DPSectionID=a.getAttribute("DPSectionID"));this.currentPageIndex=this.gridcontDiv.getAttribute("currentPageIndex");this.bPagingEnabled=!1;this.currentPageIndex&&""!=this.currentPageIndex&&(this.bPagingEnabled=!0,this.currentPageIndex=parseInt(this.currentPageIndex),
this.totalRecords=parseInt(this.gridcontDiv.getAttribute("totalRecords"),10),this.rangeSize=parseInt(this.gridcontDiv.getAttribute("pyPageSize"),10),this.pyPaginateActivity=(this.pyPaginateActivity=this.gridcontDiv.getAttribute("pyPaginateActivity"))?this.pyPaginateActivity:"",this.pySortHandled="true"==this.gridcontDiv.getAttribute("pySortHandled"),this.pyFilterHandled="true"==this.gridcontDiv.getAttribute("pyFilterHandled"));if(this.editConfig==this.EDIT_HARNESS){var c=this.gridcontDiv.getAttribute("pyTargetSection");
""==c?(this.gridDetailsDiv=f.getElementsById("PEGA_GRID_DETAILS",this.gridDiv)[0],this.gridDetailsDiv.innerHTML=""):((this.gridDetailsDiv=l.getSectionByName(c))&&this.gridDetailsDiv.setAttribute("gridId",this.gridDiv.id),this.gridDetailsDiv||(this.gridDetailsDiv=f.getElementsById("PEGA_GRID_DETAILS",this.gridDiv)[0]),window.avoidEmptyingGridDetails)?this.threadProcessing||(window.avoidEmptyingGridDetails=!1,this.gridDetailsDiv.setAttribute("StaleDetails","true")):this.gridDetailsDiv.innerHTML=""}if(this.pageMode&&
"Progressive Load"==this.pageMode||this.fixedRow&&!this.fixedCol)this.layoutWrapperDiv=f.getElementsById("gridLayoutWrapper",this.gridDiv)[0],this.fixedRow=!0;c=this.gridcontDiv.getAttribute("columnList")||"";c=pega.lang.trim(c);this.columnsList=c.split(" ");this.DnD=!1;this.contextMenuObjs={};this.menuRootNodes={};this.bFilterable="true"==b.getAttribute("bFiltering");this.bRowVisibleWhen="true"==a.getAttribute("bRowVisibleWhen");a.getAttribute("bFilteredGrid")&&(this.bFilteredGrid="true"==a.getAttribute("bFilteredGrid"));
this.refreshLayout=this.bFilteredGrid?!0:!1;this.bRODetails="true"==b.getAttribute("bRODetails");this.bFocusibleGrid="true"==b.getAttribute("focusibleGrid");this.editConfig==this.EDIT_HARNESS&&(this.bEditableGrid="true"==b.getAttribute("editableGrid"));this.pageMode&&"Progressive Load"==this.pageMode&&(this.editConfig==this.EDIT_READONLY||this.editConfig==this.EDIT_MODAL||this.bReadOnlyShowDetails)&&(this.bDiscardInvisibleRows=!0);this.bHideGridHdrWhenNoRows=b.getAttribute("bHideGridHdrWhenNoRows")},
updateExpandedDtlsHeight:function(){this.categorizedHeadersHeight=this.expDetailsHeight=0;for(var a=this.rightBodyTbl.rows,b=a.length,c=0;c<b;c++){var d=a[c];d&&""==d.id&&("true"==d.getAttribute("expanded")?this.expDetailsHeight+=d.offsetHeight:pega.util.Dom.hasClass(d,"grid-categorize-header")&&(this.categorizedHeadersHeight+=d.offsetHeight))}},initGridTables:function(){var a=pega.util.Dom.getElementsById("gridBody_right",this.gridcontDiv);if(this.bTreegrid||this.bTree)try{if(a&&a.length&&1<a.length)var b=
pega.util.Dom.getElementsById("gridLayoutTable",this.gridcontDiv)[0],a=pega.util.Dom.getElementsById("gridBody_right",b.rows[0].cells[1])}catch(d){}a&&a[0]&&(this.rightBodyDiv=a[0]);a=pega.util.Dom.getElementsById("bodyTbl_right",this.gridcontDiv);if(this.bTreegrid||this.bTree)try{a&&a.length&&1<a.length&&(b=pega.util.Dom.getElementsById("gridLayoutTable",this.gridcontDiv)[0],a=pega.util.Dom.getElementsById("bodyTbl_right",b.rows[0].cells[1]))}catch(d){}this.rightBodyTbl=a?a[0]:"";if(this.bTreegrid||
this.bTree||this.fixedCol)this.leftBodyDiv=pega.util.Dom.getElementsById("gridBody_left",this.gridcontDiv),this.gridBodyLeftParent=pega.util.Dom.getElementsById("bodyTbl_gbl",this.gridcontDiv);a=b="";this.gridBodyLeftParent&&(this.gridBodyLeftParent=this.gridBodyLeftParent[0]);this.leftBodyDiv&&(this.leftBodyDiv=this.leftBodyDiv[0]);if(this.leftBodyDiv&&("row"==this.repeatType||"column"==this.repeatType&&1==this.fixedRow)){var c=pega.util.Dom.getElementsById("gridNode",this.leftBodyDiv);c&&(this.leftBodyUL=
c[0],b=this.leftBodyUL.id+pega.ui.gridCounter)}if(this.rightHeaderDiv=pega.util.Dom.getElementsById("gridHead_right",this.gridcontDiv))this.rightHeaderDiv=this.rightHeaderDiv[0];if(this.rightHeaderTbl=pega.util.Dom.getElementsById("headTbl_right",this.gridcontDiv)||pega.util.Dom.getElementsById("headTbl_right"+this.gridDiv.id.split("PEGA_GRID")[1],this.gridcontDiv))this.rightHeaderTbl=this.rightHeaderTbl[0],pega.util.Dom.isAncestor(this.rightBodyTbl,this.rightHeaderTbl)||(a=this.rightHeaderTbl.id+
pega.ui.gridCounter);if(this.leftHeaderDiv=pega.util.Dom.getElementsById("gridHead_left",this.gridcontDiv))this.leftHeaderDiv=this.leftHeaderDiv[0];!this.bTree&&this.bTreegrid&&this.fixedRow&&this.leftHeaderDiv&&this.leftBodyDiv&&1==f.hasClass(this.gridcontDiv,"gPercent")&&(this.leftBodyDiv.style.width=this.leftHeaderDiv.offsetWidth+"px");this.bPXFixed&&this.fixedCol&&this.fixedRow&&(c=0,this.leftBodyUL&&(c=this.leftBodyUL.offsetHeight),this.leftBodyDiv&&0<c&&parseInt(this.leftBodyDiv.style.height)>
c&&(this.leftBodyDiv.style.height=c+"px"));if(this.leftHeaderTbl=pega.util.Dom.getElementsById("headTbl_left",this.gridcontDiv))this.leftHeaderTbl=this.leftHeaderTbl[0];this.bDiscardInvisibleRows&&(this.topBuffer=pega.util.Dom.getElementsById("grid-topBuffer",this.gridcontDiv)[0],this.bottomBuffer=pega.util.Dom.getElementsById("grid-bottomBuffer",this.gridcontDiv)[0]);this.writeCasesVars.INIT_GRID_TABLES={leftBodyULNewID:b,rightHeaderTblNewID:a};this.writeCases.push(Grids.INIT_GRID_TABLES)},initPLProps:function(){if(this.rightBodyTbl){this.bPageGroup?
(this.property=this.rightBodyTbl.getAttribute("PG_PROP"),this.propertyClass=this.rightBodyTbl.getAttribute("PG_PROP_CLASS")):(this.property=this.rightBodyTbl.getAttribute("PL_PROP"),this.propertyClass=this.rightBodyTbl.getAttribute("PL_PROP_CLASS"));var a=this.getPLPGProperty()||"";this.PLPGName=a.substring(a.lastIndexOf("."));this.sectionName=pega.u.d.getSectionDiv(this.gridDiv).getAttribute("NODE_NAME");this.primPage=this.rightBodyTbl.getAttribute("PRIM_PAGE");this.gridReferencePage=this.rightBodyTbl.getAttribute("GRID_REF_PAGE");
this.baseRef=l.getBaseRef(this.rightBodyTbl)}},setFilterPage:function(){var a=this.iKey;this.bDataObject&&this.DPParams&&(a=a.replace(this.getPLPGProperty(),this.getConfiguredPLPGProperty()));this.gridFilterPage=("pyFilterCriteria_"+a).replace(/[\(\.\)|\-]/g,"_")},getConfiguredPLPGProperty:function(){return this.property},getPLPGProperty:function(){return this.bDataObject&&(this.DPParams||this.isACGrid)?this.hashedDPName:this.property},doGridAction:function(a,b,c,d,e,g){a=void 0==a?window.event:a;
if(!this.DDProcessing){if(!this.bFilteredGrid||"ADDCHILD"==b||this.bFilteredGrid&&"DELETE"==b&&this.bReportDefinition)this.refreshLayout=null!=g?g:!1;this.bFilteredGrid&&"true"===g&&(this.refreshLayoutFromConfig="true");g=k.getTarget(a);var h;f.isAncestor(this.leftBodyUL,g)?h=this.leftBodyUL:f.isAncestor(this.rightBodyTbl,g)&&(h=this.rightBodyTbl);if("DELETE"==b&&"true"==this.comingFromAdd&&this.editConfig==this.EDIT_EXPANDPANE&&this.threadProcessing&&this.propRef&&""!=this.propRef){g=pega.ui.property.toHandle(this.propRef);
var m=this.getRightRow()?this.getRightRow().id:null;if(g==m){if(this.threadProcessing)return this.cancelModal(a),!1;this.comingFromAdd="false"}}!h||this.submitErrors||h!=this.leftBodyUL&&h!=this.rightBodyTbl||this.selectPage(a,h);g=this.getActiveRowIndex();g&&""!=g||"First X Results"!=this.pageMode||"INSERTAFTER"!=b||0==this.totalRecords||(g=this.activeRow=this.getLastRowIndex());if("ADDCHILD"==b&&h){if(m=this.findCell(a,h))var n=this.getRowIndex(m);n&&(g=n)}else if("SETFOCUS"==b&&d&&d.focusIndex){if("last"==
d.focusIndex||parseInt(d.focusIndex,10)>this.getExpandPaneTableLength())d.focusIndex=this.getLastRowIndex();g=d.focusIndex}this.action=b;g||(g="");if("DELETE"==b||"EDITITEM"==b||"FLOWACTION"==b||"ADDCHILD"==b||"SETFOCUS"==b||"OPEN"==b)if(""==g||g>this.rightBodyTbl.rows.length-1)return a.target!==this.gridDiv&&alert(pega.u.d.fieldValuesList.get("Please_select_a_row")),!1;this.sectionName||(this.sectionName=l.getSectionDiv(this.gridDiv).getAttribute("NODE_NAME"));this.callback=e;if("DELETE"==b||!this.submitErrors){if(this.gridDiv.getAttribute("editConfig")==
this.EDIT_READONLY&&("INSERTBEFORE"==b||"INSERTAFTER"==b||"DELETE"==b))return this.action="",!1;if("OPEN"==b)if(this.bReportDefinition&&this.bTreegrid)m=null,h&&(m=this.findCell(a,h)),this.handleSummaryGridOpen(m,g,a);else if(m=this.rightBodyTbl.rows[this.getIndex(g)],n=m.getAttribute("OAArgs"),n||(n=f.getElementsById(m.id,this.leftBodyUL)[0],n=f.getFirstChild(n).getAttribute("OAArgs")),n&&""!=n){m="";m=0==n.indexOf("open")?n:this.OAFunc+"('"+n+"');";try{eval(m)}catch(r){}}else return;if("DELETE"==
b){if(this.editConfig==this.EDIT_READONLY)return this.action="",!1;if(1==g&&this.rightBodyTbl&&this.rightBodyTbl.rows&&"none"==this.rightBodyTbl.rows[0].style.display&&2<this.rightBodyTbl.rows.length)for(d=1;d<this.rightBodyTbl.rows.length;d++)if(this.rightBodyTbl.rows[1].cells&&0<this.rightBodyTbl.rows[1].cells.length)for(a=0;a<this.rightBodyTbl.rows[1].cells.length;a++)this.rightBodyTbl.rows[1].cells[a]&&this.rightBodyTbl.rows[2].cells[a]&&(this.rightBodyTbl.rows[2].cells[a].style.width=this.rightBodyTbl.rows[1].cells[a].style.width);
"true"==this.comingFromAdd&&(this.comingFromAdd="false");this.pushToQueue({type:"action",handler:this.remove,context:this,args:g,refreshLayout:this.refreshLayout})}else if("INSERTBEFORE"==b)if("Progressive Load"==this.pageMode&&(g=this.ensurePositiveIndex(g,b)),this.editConfig==this.EDIT_ROW||this.editConfig==this.EDIT_READWRITE||this.editConfig==this.EDIT_EXPANDPANE&&!this.threadProcessing&&this.bExpandMultipleRows)this.pushToQueue({type:"action",handler:this.insertBefore,context:this,args:g,refreshLayout:this.refreshLayout});
else{if(this.editConfig==this.EDIT_MODAL||this.editConfig==this.EDIT_HARNESS||this.editConfig==this.EDIT_EXPANDPANE&&(this.threadProcessing||!this.bExpandMultipleRows))this.bPageGroup?this.appendLast(a):(""==g&&0<this.getTableLength(this.rightBodyTbl)&&!f.getElementsById("Grid_NoResults",this.gridDiv)&&(this.activeRow=g=1),""!=g?this.insertBeforeModal(a):this.appendLast(a))}else if("INSERTAFTER"==b)if("Progressive Load"==this.pageMode&&(g=this.ensurePositiveIndex(g,b)),this.editConfig==this.EDIT_ROW||
this.editConfig==this.EDIT_READWRITE||this.editConfig==this.EDIT_EXPANDPANE&&!this.threadProcessing&&this.bExpandMultipleRows||!this.bGrid)this.pushToQueue({type:"action",handler:this.insert,context:this,args:g,refreshLayout:this.refreshLayout,gridAction:this.action});else{if(this.editConfig==this.EDIT_MODAL||this.editConfig==this.EDIT_HARNESS||this.editConfig==this.EDIT_EXPANDPANE&&(this.threadProcessing||!this.bExpandMultipleRows))""==g&&!this.bTreegrid&&this.currentPageIndex&&""!=this.currentPageIndex&&
""==this.pyPaginateActivity&&1<this.rightBodyTbl.rows.length&&!f.getElementsById("Grid_NoResults",this.gridDiv)&&(this.activeRow=this.rightBodyTbl.rows.length-1,g=(this.currentPageIndex-1)*this.rangeSize+this.rightBodyTbl.rows.length-1),""==g||this.bPageGroup?this.appendLast(a):this.insertAfter(a)}else if("ADDCHILD"==b){if(this.editConfig==this.EDIT_READONLY)return this.action="",!1;if(this.bPageGroup)return alert("Insert Child is not supported for Page Group"),!1;this.pushToQueue({type:"action",
handler:this.addChild,context:this,args:g,refreshLayout:this.refreshLayout})}else if("REFRESHLIST"==b)this.refreshList(a,d);else if("ACTIVITY"==b)this.doCustomAction(g,c,d,e);else if("FLOWACTION"==b)e="",g=k.getTarget(a),f.isAncestor(this.gridDiv,g)||(e=this.getLeftRow()),pega.ctx.activeGrid=this,h=new SafeURL,g=this.getLeftRow(),n=this.activeRow+this.getFirstLoadedRowIndex()-1,this.getPreviousGridRow(g)||h.put("PrevDisabled","true"),this.bDiscardInvisibleRows&&1<n&&h.put("PrevDisabled","false"),
this.isOpenLocalAction=!0,this.bNoThreadProcess="true"==d.noThreadProcess,this.getNextGridRow(g)||h.put("NextDisabled","true"),this.bDiscardInvisibleRows&&n<this.totalRecords&&h.put("NextDisabled","false"),0==this.propertyClass.indexOf("Assign-")&&h.put("ShowOnlyOKCancel",!0),h.put("pzHarnessID",pega.ctx.pzHarnessID),h.put("activeGridObj",this),h.put("UITemplatingStatus","N"),"true"==pega.u.d.KeepMessages&&h.put("KeepMessages",pega.u.d.KeepMessages),processAction(c,"","","","",!0,a,d.templateName||
"",h,e,!0);else if("PAGINATE"==b)this.paginateGrid(a,d);else if("SETFOCUS"==b){if(f.getElementsById("Grid_NoResults",this.gridDiv)&&1==f.getElementsById("PEGA_GRID_SKIN",this.gridDiv).length)return;if(d&&(d.offset||d.focusIndex))this.changeSetFocus(d.focusIndex,d.offset);else{c=k.getTarget(a);d=f.isAncestor(this.rightBodyTbl,c)?this.rightBodyTbl:this.leftBodyUL;m=this.findCell(null,d,c);if(this.bCategorizedGrid&&m&&!m.parentNode.id)return;m?d==this.rightBodyTbl?this.selectPage(a,this.rightBodyTbl):
this.selectPage(a,this.leftBodyUL):this.selectPage(null,null,this.getIndex(g))}!pega.u.d.inStandardsMode&&k.isIE&&this.triggerBrowserReflow()}else if("EDITITEM"==b)this.handleEditItem(a,h,g);else if(b==this.REFRESH_ROWS_ACTION)if(a={},d&&"[object Array]"===Object.prototype.toString.call(d))a.rowsArray=d,this.refreshRows(a);else if(d&&"object"===typeof d&&"[object Array]"!==Object.prototype.toString.call(d)){c="0";if("0"===d.offset&&this.activeRow)c=this.activeRow;else if(d.refreshIndex)if(c=d.refreshIndex,
"last"===c)c=this.getLastRowIndex();else{if("active"===c){if(!this.activeRow)return;c=this.activeRow}}else return;e=[];e.push(this.getEntryHandle(c));a.rowsArray=e;a.disableSubmit=d.bDisableSubmit;this.refreshRows(a)}this.editConfig!=this.EDIT_READONLY||"INSERTAFTER"!=b&&"INSERTBEFORE"!=b||(this.action="")}"PAGINATE"==b||"SETFOCUS"==b||"OPEN"==b||"EDITITEM"==b&&(this.bRODetails||this.bReadOnlyShowDetails)||this.markAsDirty();"CSS1Compat"!==document.compatMode&&-1!=navigator.userAgent.indexOf("MSIE")&&
setTimeout(function(){document.body.className=document.body.className},200)}},refreshRows:function(a){try{var b=a.rowsArray,c="true"==a.disableSubmit,d=new SafeURL;d.put("PageListProperty",this.getPLPGProperty());d.put("refreshLayout","false");var e=b.length;a=[];for(var g=new SafeURL,h=0;h<e;h++){var m={pyPropRef:b[h]},n=pega.ui.property.toHandle(b[h]),k;if(this.fixedCol||this.bTreegrid){k=pega.util.Dom.getElementsById(n,this.leftBodyUL,"LI");if(!k||!k.length)continue;k=k[0];c||g.copy(l.getQueryString(k))}(k=
pega.util.Dom.getElementsById(n,this.rightBodyTbl))&&k.length&&(k=k[0],this.bFilteredGrid&&(m.curRowNum=k.rowIndex,!this.currentPageIndex||""==this.currentPageIndex||""!=this.pyPaginateActivity||this.bReportDefinition||"Progressive Load"==this.pageMode&&!this.bDiscardInvisibleRows||(m.curRowNum=(this.currentPageIndex-1)*this.rangeSize+m.curRowNum)),this.bCategorizedGrid&&(m.curRowClass=this.getRowClass(k)),this.editConfig==this.EDIT_ROW&&f.hasClass(k,"editMode")&&(m.editRow="true",this.rightrowbefore=
this.leftrowbefore=null),c||g.copy(l.getQueryString(k)),a.push(m))}g.put("strIndexInList",JSON.stringify(a));d.put("EditRow","false");(this.bReportDefinition||this.pyPaginateActivity)&&d.put("startIndex",(this.currentPageIndex-1)*this.rangeSize+1);var q=pega.u.d.getLayoutIndex(this.gridcontDiv),p={partialTrigger:"editRow"+this.getConfiguredPLPGProperty()+q,domAction:"replace",beforeDomAction:this.loadRefreshRows,beforeDomActionContext:this,beforeParams:null,afterDomAction:this.refreshRowsCallback};
p.appendExtraQueryString=g;var t=[this.getPLPGProperty(),this.activeRow];d.put("gridAction",this.REFRESH_ROWS_ACTION);this.gridPreActivity&&d.put("gridPreActivity",this.gridPreActivity);this.gridPostActivity&&d.put("gridPostActivity",this.gridPostActivity);d.put("KeepGridMessages",!0===pega.u.d.KEEP_GRID_MESSAGES?"true":"false");var v=d.toQueryString();l.reloadRepeatLayout("pzdoGridAction",v,null,t,this.gridDiv,p,!0)}catch(u){return this.resetInCall(),console&&console.log(u),!1}},loadRefreshRows:function(a){var b=
a.responseText.split("||END||")[0],c=a.argument[0],d=document.createElement("div");d.innerHTML=b;var b=null,e=f.getElementsById("bodyTbl_right",d);e&&e[0]&&(b=e[0]);var e=null,g=f.getElementsById("gridNode",d,"UL");(this.fixedCol||this.bTreegrid)&&g&&g[0]&&(e=g[0]);a=a.argument[6];var h=this,g=function(a){a&&"PegaOnlyOnce"!=a.id&&pega.u.d.processOnloads(a);pega.u.d.gridLoadManager&&pega.u.d.gridLoadManager.afterLoad();var b=f.getElementsById("bodyTbl_right",a);if(b&&b.length)for(var b=b[0],c=b.rows,
d=b.rows.length,b=0;b<d;b++){var e=c[0];if(e&&e.id){var g=f.getElementsById(e.id,h.rightBodyTbl);if(g&&g.length){g=g[0];f.hasClass(g,"notFocused")&&f.addClass(e,"notFocused");g.style&&"none"==g.style.display&&(e.style.display="none");if(h.bExpandMultipleRows){var m=f.getElementsById("rowDetail"+g.id,h.rightBodyTbl),k=null;m&&m[0]&&(m=m[0],k=m.parentNode.parentNode);(m=f.getNextSibling(e))&&null!=m.getAttribute("expanded")&&k?k.parentNode.replaceChild(m,k):k&&null!=k.getAttribute("expanded")&&"none"==
k.style.display&&k.parentNode.removeChild(k)}if(h.editConfig!=h.EDIT_READWRITE&&h.editConfig!=h.EDIT_READONLY||!f.hasClass(h.gridcontDiv,"gPercent")||1!=h.activeRow)g.parentNode.replaceChild(e,g);else for(b=0;b<g.cells.length;b++)g.cells[b].innerHTML=e.cells[b].innerHTML;(h.threadProcessing||!h.bExpandMultipleRows)&&(e=f.getElementsById("rowDetail"+g.id,h.rightBodyTbl))&&e[0]&&(e=e[0],h.expandedElem=null,e=e.parentNode.parentNode,e.parentNode.removeChild(e))}}}if((b=f.getElementsById("gridNode",a))&&
b.length)for(b=b[0],a=f.getChildren(b),c=a.length,b=0;b<c;b++)d=a[b],d.id&&(e=f.getElementsById(d.id,h.leftBodyDiv))&&e.length&&(e=e[0],e.replaceChild(f.getFirstChild(d),f.getFirstChild(e)));pega.u.d.gIsScriptsLoading=!1;(b=f.getElementsById("refreshRowsTempDiv",h.gridDiv))&&b.length&&b[0].parentNode.removeChild(b[0]);h.selectRow(h.activeRow,!0)};if(b||e)b=document.createElement("div"),d.id="refreshRowsTempDiv",d.style.visibility="hidden",d.style.position="absolute",d.style.zIndex="-1",this.gridcontDiv.parentNode&&
this.gridcontDiv.parentNode.insertBefore(b,this.gridcontDiv),a.domElement=b,l.loadDOMObject(c,d.outerHTML,g,a);return!1},ensurePositiveIndex:function(a,b){if(f.getElementsById("Grid_NoResults",this.gridDiv))return"";if(a&&0<a)return a;var c=this.currentPageIndex?this.currentPageIndex:0,d=a?!1:!0;"INSERTAFTER"===b?0!=c?(a=this.bDiscardInvisibleRows?this.getNoOfRowsLoaded():c*this.rangeSize,b=this.getTableLength(this.rightBodyTbl),a>b&&(a=b)):a=this.rangeSize:"INSERTBEFORE"===b&&(a=0==c||this.bDiscardInvisibleRows?
1:(c-1)*this.rangeSize+1);this.bDiscardInvisibleRows&&d?this.activeRow=a:this.selectPage(null,null,a);return a},fireTopPriorityEvent:function(a,b){a&&pega.c.actionSequencer.fireTopPriorityEvent(a,b)},focusGrid:function(a){var b=null,b=a?pega.util.Dom.removeClass:pega.util.Dom.addClass;(this.bTreegrid||this.fixedCol)&&b(this.getLeftRow(this.getActiveRowIndex()),"notFocused");b(this.getRightRow(this.getActiveRowIndex()),"notFocused");"CSS1Compat"!==document.compatMode&&-1!=navigator.userAgent.indexOf("MSIE")&&
setTimeout(function(){document.body.className=document.body.className},100)},prepareForPrint:function(){if(this.rightBodyTbl){this.rightBodyTbl.style.tableLayout="auto";if(this.leftBodyDiv){var a=f.getElementsByClassName("rowContent","UL",this.leftBodyDiv),b=!1;a&&0==a.length&&(a=f.getElementsByClassName("gridRow","LI",this.leftBodyDiv),b=!0);for(var c=0;c<this.rightBodyTbl.rows.length;c++){var d=document.createElement("td");if(0==b)d.appendChild(a[c]);else{var e=document.createElement("UL");f.addClass(e,
"gridNode");e.appendChild(a[c]);d.appendChild(e)}this.rightBodyTbl.rows[c].insertBefore(d,this.rightBodyTbl.rows[c].cells[0])}this.rightBodyTbl.rows[0].cells[0].style.width=this.leftBodyDiv.style.width;this.leftBodyDiv.parentNode.removeChild(this.leftBodyDiv)}if(this.rightHeaderTbl=pega.util.Dom.getElementsById("headTbl_right"+this.gridDiv.id.split("PEGA_GRID")[1],this.gridcontDiv))this.rightHeaderTbl=this.rightHeaderTbl[0],this.rightBodyTbl.rows[0].parentNode.insertBefore(this.rightHeaderTbl.rows[0],
this.rightBodyTbl.rows[0]),this.rightHeaderTbl.parentNode.removeChild(this.rightHeaderTbl),this.leftHeaderTbl&&(this.rightBodyTbl.rows[0].insertBefore(this.leftHeaderTbl.rows[0].cells[1],this.rightBodyTbl.rows[0].cells[0]),this.leftHeaderTbl.parentNode.removeChild(this.leftHeaderTbl))}this.rightBodyDiv&&(this.rightBodyDiv.style.height="auto",this.rightBodyDiv.style.width="auto");this.leftBodyDiv&&this.leftBodyDiv.parentNode.removeChild(this.leftBodyDiv);this.rightHeaderDiv&&this.rightHeaderDiv.parentNode.removeChild(this.rightHeaderDiv);
this.leftHeaderDiv&&this.leftHeaderDiv.parentNode.removeChild(this.leftHeaderDiv);this.gridcontDiv&&(this.gridcontDiv.style.height="auto",this.gridcontDiv.style.width="auto");pega.ctx.dom.getElementById("hScrollDiv")&&(a=pega.ctx.dom.getElementById("hScrollDiv"),a.parentNode.removeChild(a));pega.ctx.dom.getElementById("vScrollDiv")&&(a=pega.ctx.dom.getElementById("vScrollDiv"),a.parentNode.removeChild(a));this.addCSSclass("#pega_ui_load","visibility: hidden");this.addCSSclass("#pega_ui_mask","visibility: hidden");
this.addCSSclass(".hiddenCell","display: none")},addCSSclass:function(a,b){document.all?document.styleSheets[document.styleSheets.length-1].addRule(a,b):document.getElementById&&document.styleSheets[document.styleSheets.length-1].insertRule(a+" { "+b+" }",i+=1)},isLastFocussableElement:function(a,b){if(a){"LI"==a.nodeName&&f.hasClass(a,"gridRow")&&(a=f.getFirstChild(a));a=a.getElementsByTagName("*");for(var c=a.length-1;0<=c;c--){var d=a[c],e=d.nodeName;if(("A"==e||"BUTTON"==e||("TD"==e||"TH"==e||
"SPAN"==e||"DIV"==e||"IMG"==e||"I"==e)&&-1!=d.outerHTML.split("\x3e")[0].toUpperCase().indexOf("TABINDEX")||"SELECT"==e||"INPUT"==e||"TEXTAREA"==e)&&d.offsetWidth&&"hidden"!=d.type&&"none"!=d.style.display&&(d.currentStyle&&"hidden"!=d.currentStyle.visibility&&"none"!=d.currentStyle.display||window.getComputedStyle&&"hidden"!=window.getComputedStyle(d,"").visibility&&"none"!=window.getComputedStyle(d,"").display))if(e=!1,"radio"==b.type&&"radio"==d.type&&pega.ctx.dom.closest(b,"div[data-ctl\x3d'RadioGroup']").contains(d)&&
(e=!0),d==b||e)try{return d.focus(),d.focus(),d.select&&d.select(),!0}catch(g){}else return!1}}},hasFocusableContent:function(a){if(!a)return!1;a=a.getElementsByTagName("*");for(var b=0;b<a.length;b++)if(pega.u.d.isFocusableNode(a[b]))return!0;return!1},isFirstFocussableElement:function(a,b){if(a){a=a.getElementsByTagName("*");for(var c=0;c<a.length;c++){var d=a[c],e=d.nodeName;if(("A"==e||"BUTTON"==e||("TD"==e||"SPAN"==e||"DIV"==e||"IMG"==e||"I"==e)&&-1!=d.outerHTML.split("\x3e")[0].toUpperCase().indexOf("TABINDEX")||
"SELECT"==e||"INPUT"==e||"TEXTAREA"==e)&&d.offsetWidth&&"hidden"!=d.type&&(d.currentStyle&&"hidden"!=d.currentStyle.visibility&&"none"!=d.currentStyle.display||window.getComputedStyle&&"hidden"!=window.getComputedStyle(d,"").visibility&&"none"!=window.getComputedStyle(d,"").display))if(d==b)try{return d.focus(),d.focus(),d.select&&d.select(),!0}catch(g){}else return!1}}},keyDownHandlerLeft:function(a,b){if(this.repeatType!=this.COL_REPEAT&&(this.activeRow&&-1!=this.activeRow||this.selectPage(a,b),
"9"==a.keyCode)){b=a.type;for(var c=k.getTarget(a),d=a.keyCode,e=k.getTarget(a),g=this.getIndex(this.activeRow),h=e.parentElement,m=!0;h;)if("true"==h.getAttribute("expanded")){g+=1;m=!1;break}else if("TR"==h.nodeName&&h.id)break;else h=h.parentElement;try{if(!a.shiftKey){if(this.isLastFocussableElement(pega.util.Dom.getElementsById(this.rightBodyTbl.rows[g].id,this.leftBodyUL,"LI")[0],e))if(this.focusFirstElement(this.rightBodyTbl.rows[g]))k.preventDefault(a);else{if(this.editConfig==this.EDIT_ROW&&
this.activeRow&&this.activeRow&&f.hasClass(this.rightBodyTbl.rows[g],"editMode")){var n={type:b,target:c,keyCode:d,context:this};n.handler=this.submitRow;n.args=this;this.pushToQueue(n);this.submitErrors&&k.preventDefault(a)}var l=f.getNextSiblingBy(this.rightBodyTbl.rows[g],function(a){return"none"==a.style.display?!1:!0}),q=l&&"Grid_NoResults"!=l.id?l.rowIndex:-1,p=this.getIndex(q);!this.submitErrors&&-1!=q&&this.rightBodyTbl.rows[p]&&(k.preventDefault(a),pega.util.Dom.getElementsById(this.rightBodyTbl.rows[p].id,
this.leftBodyUL,"LI")&&this.focusFirstElement(pega.util.Dom.getElementsById(this.rightBodyTbl.rows[p].id,this.leftBodyUL,"LI")[0])||this.focusFirstElement(this.rightBodyTbl.rows[p]),this.selectPage(null,this.leftBodyUL,p))}}else if(!this.fixedCol&&this.isFirstFocussableElement(this.rightBodyTbl.rows[g],e)||this.fixedCol&&this.isFirstFocussableElement(pega.util.Dom.getElementsById(this.rightBodyTbl.rows[g].id,this.leftBodyUL,"LI")[0],e))this.editConfig==this.EDIT_ROW&&this.activeRow&&f.hasClass(this.rightBodyTbl.rows[g],
"editMode")&&(n={type:b,target:c,keyCode:d,context:this},n.handler=this.submitRow,n.args=this,this.pushToQueue(n),this.submitErrors&&k.preventDefault(a)),p=q=(l=f.getPreviousSiblingBy(this.rightBodyTbl.rows[g],function(a){return"none"==a.style.display?!1:!0}))&&"Grid_NoResults"!=l.id?l.rowIndex:-1,-1==q||"true"!=this.rightBodyTbl.rows[p].getAttribute("expanded")||"none"!=this.rightBodyTbl.rows[p].style.display&&0!=this.rightBodyTbl.rows[p].offsetHeight?-1!=q&&this.rightBodyTbl.rows[p]&&f.hasClass(this.rightBodyTbl.rows[p],
"grid-categorize-header")&&--p:--p,!this.submitErrors&&-1!=q&&this.rightBodyTbl.rows[p]&&(this.focusLastElement(this.rightBodyTbl.rows[p])?(k.preventDefault(a),m&&p&&this.selectPage(null,this.leftBodyUL,p)):pega.util.Dom.getElementsById(this.rightBodyTbl.rows[p].id,this.leftBodyUL,"LI")&&this.focusLastElement(pega.util.Dom.getElementsById(this.rightBodyTbl.rows[p].id,this.leftBodyUL,"LI")[0])&&(k.preventDefault(a),this.selectPage(null,this.leftBodyUL,p),this.focusLastElement(this.rightBodyTbl.rows[p])))}catch(t){}}},
keyDownHandlerRight:function(a,b){if(this.bGrid&&"9"==a.keyCode){for(var c=a.type,d=k.getTarget(a),e=a.keyCode,g=k.getTarget(a),h=this.activeRow?this.getIndex(this.activeRow):0,m=g.parentElement;m;)if("true"==m.getAttribute("expanded")){h+=1;break}else if("TR"==m.nodeName&&m.id)break;else m=m.parentElement;a.shiftKey?this.isFirstFocussableElement(this.rightBodyTbl.rows[h],g)&&(this.leftBodyUL&&this.focusLastElement(pega.util.Dom.getElementsById(this.rightBodyTbl.rows[h].id,this.leftBodyUL,"LI")[0])?
k.preventDefault(a):this.keyDownHandlerLeft(a,b)):this.isLastFocussableElement(this.rightBodyTbl.rows[h],g)&&(this.editConfig==this.EDIT_ROW&&this.activeRow&&f.hasClass(this.rightBodyTbl.rows[h],"editMode")&&(b={type:c,target:d,keyCode:e,context:this},b.handler=this.submitRow,b.args=this,this.pushToQueue(b),this.submitErrors&&k.preventDefault(a)),b=h=(h=f.getNextSiblingBy(this.rightBodyTbl.rows[h],function(a){return"none"==a.style.display?!1:!0}))&&"Grid_NoResults"!=h.id?h.rowIndex:-1,-1==h||"true"!=
this.rightBodyTbl.rows[b].getAttribute("expanded")||"none"!=this.rightBodyTbl.rows[b].style.display&&0!=this.rightBodyTbl.rows[b].offsetHeight?-1!=h&&this.rightBodyTbl.rows[b]&&f.hasClass(this.rightBodyTbl.rows[b],"grid-categorize-header")&&(b+=1):b+=1,!this.submitErrors&&-1!=h&&this.rightBodyTbl.rows[b]&&(this.leftBodyUL?this.focusFirstElement(pega.util.Dom.getElementsById(this.rightBodyTbl.rows[b].id,this.leftBodyUL,"LI")[0])&&(k.preventDefault(a),this.selectPage(null,this.leftBodyUL,b)):this.focusFirstElement(this.rightBodyTbl.rows[b])&&
(k.preventDefault(a),this.selectPage(null,this.rightBodyTbl,b))))}},isTargetComplexProperty:function(a){for(var b=pega.ctx.dom.querySelectorAll("div.autocomplete_main"),c=b.length,d=0;d<c;d++)if(f.isAncestor(b[d],a))return!0;b=a.getAttribute("data-ctl");if(null!=b&&"string"==typeof b&&'["autocompleteag"]'==b.toLowerCase())return!0;b=pega.ctx.dom.querySelectorAll("div.lookupPO");c=b.length;for(d=0;d<c;d++)if(f.isAncestor(b[d],a))return!0;return(b=pega.ctx.dom.getElementById("Pega_Cal_Cont"))&&f.isAncestor(b,
a)||pega.ui.menubar&&pega.ui.menubar.Manager&&(0<jQuery(a).closest(".menuitem").length||0<jQuery(a).closest(".menubar").length)||pega.c.menu&&pega.c.menu.isInMenu(a)||"function"==typeof OpenRuleAdvanced_isActive&&OpenRuleAdvanced_isActive()?!0:!1},isTargetNoResultsMsg:function(a){var b=f.getElementsById("Grid_NoResults",this.gridDiv);return b&&b[0]&&f.isAncestor(b[0],a)||b&&b[1]&&f.isAncestor(b[1],a)?!0:!1},isElementLayeredAboveGrid:function(a){if(this.isOpenLocalAction)return!0;a=pega.u.d.getPopOverLevel(a);
if(this.gridPopoverLevel<a)return!0},gridEventHandler:function(a,b){var c=a.type,d=k.getTarget(a),e=a.keyCode;e||(e="");if("keyup"==c)this.setIsLastEventFromRow(d);else if(this.repeatType!=this.COL_REPEAT||"mouseup"!=c&&"touchstart"!=c||!this.rightHeaderTbl||(this.rightHeaderTbl.style.position="relative"),f.isAncestor(this.leftBodyUL,d)?b=this.leftBodyUL:f.isAncestor(this.rightBodyTbl,d)&&(b=this.rightBodyTbl),!this.isTargetNoResultsMsg(d)){if(this.bRowHovering&&("mouseover"==c||"mouseout"==c)){var g=
this.findCell(a,b);if(!this.isElementFromSameGridContDiv(g)||!g||pega.util.Dom.hasClass(g,"rowHandle")||pega.util.Dom.hasClass(g,"expandPane"))return;var h=g.parentNode;if(h&&"true"==h.getAttribute("expanded"))for(h=h.previousSibling;1!=h.nodeType;)h=h.previousSibling;if(this.bTreegrid||this.fixedCol)var m=this.getRowIndex(g),h=this.rightBodyTbl.rows[this.getIndex(m)];if("mouseover"==c)this.onCellHover(h,!0);if("mouseout"==c)this.onCellHover(h,!1)}if("scroll"==c){if(this.bProgressiveLoading)return;
var n=this;n.scrollTimer&&clearTimeout(n.scrollTimer);g=pega.ctxmgr.getCurrentHarnessContext();h=pega.ctxmgr.getContextByTarget(d);pega.ctxmgr.setContext(h);n.scrollTimer=setTimeout(function(){n.progressiveLoadGrid()},300);pega.ctxmgr.resetContext(g)}pega.ui.statetracking.setBusy("gridEvent");if("keydown"==c){if(32===e&&d&&"pui_colmenu"==d.id){k.preventDefault(a);d.click();return}if(9==e&&(this.bringToView(a),this.editConfig==this.EDIT_EXPANDPANE||this.bShowExpandDetails)&&(!this.threadProcessing||
this.threadProcessing&&"true"!=this.comingFromAdd))for(c=d;;){c=c.parentNode;if(!c||c.id==this.gridDiv.id)break;if("modaldialog_con"==c.id){this.selectPage(a,b);(g=this.findCell(a,b))&&(m=this.getRowIndex(g))&&""!=m&&0!=m&&this.enableSaveDiscardButtons(a);break}}c=d.nodeName;if("SELECT"!=c&&"OPTION"!=c&&"INPUT"!=c&&"TEXTAREA"!=c||"hidden"==d.type||!(d.currentStyle&&"hidden"!=d.currentStyle.visibility&&"none"!=d.currentStyle.display||window.getComputedStyle&&"hidden"!=window.getComputedStyle(d,"").visibility&&
"none"!=window.getComputedStyle(d,"").display))40==e||9==e?"Progressive Load"==this.pageMode&&this.activeRow==this.getLastRowIndex()&&this.layoutWrapperDiv.scrollTop+this.layoutWrapperDiv.clientHeight!=this.layoutWrapperDiv.scrollHeight&&(this.layoutWrapperDiv.scrollTop+=this.getAvgRowHeight()):(38==e||9==e&&a.shiftKey)&&"Progressive Load"==this.pageMode&&this.activeRow==this.getFirstLoadedRowIndex()&&0!=this.layoutWrapperDiv.scrollTop&&(this.layoutWrapperDiv.scrollTop-=this.getAvgRowHeight());b==
this.leftBodyUL?this.keyDownHandlerLeft(a,b):b==this.rightBodyTbl&&this.keyDownHandlerRight(a,b)}else if(c==Grids.EVENT_DOUBLE_CLICK){g=this.findCell(a,b);if(!g){pega.ui.statetracking.setDone();return}m=this.getRowIndex(g);if(!m||""==m||0==m){pega.ui.statetracking.setDone();return}h=this.rightBodyTbl.rows[m];if(!h){pega.ui.statetracking.setDone();return}if(h.getAttribute("busyRow")){pega.ui.statetracking.setDone();return}this.bReportDefinition&&this.bTreegrid&&(e=null,"TD"==g.tagName&&(e=g.cellIndex),
1==!this.disableDD&&this.openDDReport(m,e))}else if(c==Grids.EVENT_CLICK){this.isLastEventFromRow=this.getIsLastEventFromRow(d);if(c==Grids.EVENT_CLICK){if(this.filterOnProperEvent(b,a,d)){pega.ui.statetracking.setDone();return}if(this.menusOnProperEvent(b,a,d)){pega.ui.statetracking.setDone();return}if(this.sortOnProperEvent(b,a,d)){pega.ui.statetracking.setDone();return}}this.submitErrors||b!=this.leftBodyUL&&b!=this.rightBodyTbl||(pega.control.isActionableElement(d)||!this.bGrid?this.bTreegrid&&
d&&"A"==d.tagName&&d.parentNode&&"iconExpandCollapse"==d.parentNode.id||(this.toBeCollapsed?this.setActiveRow(a,b):this.selectPage(a,b)):this.setActiveRow(a,b),this.editConfig!=this.EDIT_EXPANDPANE&&!this.bShowExpandDetails||this.isLastEventFromRow||!this.getLeftRow()||"true"!=this.getLeftRow().getAttribute("rowExpanded")||(g=f.getElementsById("rowDetail"+this.getLeftRow().id,this.gridDiv)[0],f.isAncestor(g,d)&&(!this.threadProcessing||this.threadProcessing&&"true"!=this.comingFromAdd)&&(this.toBeCollapsed?
this.setActiveRow(a,b):this.selectPage(a,b),this.bRODetails||(g=this.findCell(a,b))&&(m=this.getRowIndex(g))&&""!=m&&0!=m&&this.enableSaveDiscardButtons(a))));g={type:c,target:d,keyCode:e,context:this,refreshLayout:this.refreshLayout};if(d&&d.disabled)return;this.repeatType==this.ROW_REPEAT&&d&&d.id&&"RLDel"==d.id?("true"==this.comingFromAdd&&this.editConfig==this.EDIT_HARNESS&&(g.handler=this.cancelModal,this.pushToQueue(g)),g.handler=this.removeFromGrid,g.args=b,this.pushToQueue(g)):this.repeatType==
this.ROW_REPEAT&&d&&d.id&&"RLAdd"==d.id?this.editConfig&&""!=this.editConfig&&this.editConfig!=this.EDIT_READWRITE?doGridAction(a,"INSERTAFTER"):(g.handler=this.appendToGrid,g.args=b,this.pushToQueue(g)):d&&this.bTreegrid&&c==Grids.EVENT_CLICK&&(f.hasClass(d,"expandNode")||f.hasClass(d,"collapseNode"))&&(g.handler=this.doExpandCollapse,g.args=this,this.pushToQueue(g))}else if("keypress"==c){g={type:c,target:d,keyCode:e,context:this,refreshLayout:this.refreshLayout};if(13!=e){pega.ui.statetracking.setDone();
return}if(this.repeatType==this.ROW_REPEAT&&d&&d.id&&"RLDel"==d.id)g.handler=this.removeFromGrid,g.args=b,this.pushToQueue(g);else if(this.repeatType==this.ROW_REPEAT&&d&&d.id&&"RLAdd"==d.id)this.editConfig==this.EDIT_ROW?doGridAction(a,"INSERTAFTER"):(g.handler=this.appendToGrid,g.args=b,this.pushToQueue(g));else{if(13==e&&"RLDel"!=d.id&&"RLAdd"!=d.id&&"pui_filter"!=d.id&&("A"==d.tagName||"BUTTON"==d.tagName||"TEXTAREA"==d.tagName||"INPUT"===d.tagName&&"button"===d.type||pega.util.Event.isIE&&"INPUT"==
d.tagName&&"text"==d.type)){pega.ui.statetracking.setDone();return}if(this.filterOnProperEvent(b,a,d)){pega.ui.statetracking.setDone();return}if(this.sortOnProperEvent(b,a,d)){pega.ui.statetracking.setDone();return}this.selectPage(a,b);if(this.repeatType!=this.ROW_REPEAT||this.bPageGroup||this.editConfig!=this.EDIT_ROW)this.bPageGroup||this.repeatType!=this.ROW_REPEAT||this.editConfig&&""!=this.editConfig||(g.handler=this.appendToGrid,g.args=b,this.pushToQueue(g));else{if(this.gridDiv.getAttribute("data-keyup")&&
-1!=this.gridDiv.getAttribute("data-keyup").indexOf("enter")){pega.ui.statetracking.setDone();return}g.handler=this.submitAndAppendRow;g.args=b;this.pushToQueue(g)}}}else if("mouseup"==c||"touchstart"==c){if(jQuery(d)&&0<jQuery(d).closest("div.cke_dialog_body").length)return;this.gridRowDDInst&&(this.gridRowDDInst.DDM.handleMouseUp(a,this.gridRowDDInst),this.gridRowDDInst.unreg(),this.gridRowDDInst=null);if(this.activeResize&&this.activeResize.isActive){this.activeResize._handleMouseUp(a);this.activeResize=
null;pega.ui.statetracking.setDone();return}m=!1;if(this.editConfig!=this.EDIT_ROW||!this.activeRow){pega.ui.statetracking.setDone();return}h=this.rightBodyTbl.rows[this.activeRow];if(!f.hasClass(h,"editMode")){pega.ui.statetracking.setDone();return}g=this.findCell(a,b);b=!1;g&&this.getRowIndex(g)==this.getIndex(this.activeRow)&&(b=!0);if(this.bTreegrid&&(f.hasClass(d,"expandNode")||f.hasClass(d,"collapseNode"))&&(m=!0,b)){pega.ui.statetracking.setDone();return}if(d&&d.tagName&&("BUTTON"==d.tagName||
"A"==d.tagName)&&b&&"RLAdd"!=d.id&&!m){pega.ui.statetracking.setDone();return}if(this.bInlineEditGridInModal&&(this.modalDetailsDiv||(this.modalDetailsDiv=pega.ctx.dom.getElementsByClassName("modal-scroll-panel")[0]),this.modalDetailsDiv&&this.modalScrollLeft!=this.modalDetailsDiv.scrollLeft)||"true"==this.gridcontDiv.getAttribute("haswidth")&&this.editConfig==this.EDIT_ROW&&this.gridScrollLeft!=this.gridcontDiv.scrollLeft)return;g={type:c,target:d,keyCode:e,context:this};g.handler=this.submitRow;
g.args=this;this.pushToQueue(g)}else if("focusin"==c||"focus"==c)this.setIsLastEventFromRow(d),this.activeRow&&-1!=this.activeRow||this.selectPage(a,b);else if(c==Grids.EVENT_RIGHT_CLICK&&(this.isLastEventFromRow=this.getIsLastEventFromRow(d),!this.submitErrors&&(b==this.leftBodyUL||b==this.rightBodyTbl))){if(this.isTargetNoResultsMsg(k.getTarget(a))){pega.ui.statetracking.setDone();return}this.selectPage(a,b)}d&&d.id&&("RLAdd"==d.id||"RLDel"==d.id)&&k.stopPropagation(a);pega.ui.statetracking.setDone()}},
setModalScrollLeft:function(a,b){this.modalScrollLeft=b.scrollLeft},setGridScrollLeft:function(a,b){this.gridScrollLeft=b.scrollLeft},getIsLastEventFromRow:function(a){for(;a&&a!=this.gridDiv&&!a.getElementById&&(!a.getAttribute||null==a.getAttribute("PL_PROP")&&null==a.getAttribute("PG_PROP"));){if(a.getAttribute&&(a.getAttribute("PL_INDEX")||a.getAttribute("PG_SUBSCRIPT")))return this.isRowFromThisGrid(a);a=a.parentNode}return null},isRowFromThisGrid:function(a){if(a&&a.id){var b=pega.ui.property.toReference(a.id);
a=pega.ctx.dom.closest(a,"div#PEGA_GRID_SKIN");if(b&&a)return 0===b.indexOf(this.dataSourceRef)&&a.parentElement===this.gridDiv}return!1},setIsLastEventFromRow:function(a){this.isLastEventFromRow=this.getIsLastEventFromRow(a);this.isLastEventFromRow||(this.isLastEventFromRow=this.isLastEventFromFlowAction(a))},isLastEventFromFlowAction:function(a){if(this.editConfig==this.EDIT_HARNESS)for(;a&&!a.getElementById;){if(this.gridDetailsDiv==a)return this.activeRow;a=a.parentNode}else if(this.editConfig==
this.EDIT_EXPANDPANE)for(;a&&!a.getElementById;){if(a.getAttribute&&"true"==a.getAttribute("expanded"))return this.activeRow;a=a.parentNode}return null},onCellHover:function(a,b){if(!this.disableRowHovering){var c;c=b?f.addClass:f.removeClass;var d=pega.util.Dom.hasClass;if(a){var e=a.id,g=a.cells;if(g){a=g.length;var h=0;if(this.bDragDrop||this.bTreegrid||this.bNumberedSkin)h=1;this.editConfig==this.EDIT_EXPANDPANE&&!this.fixedCol&&this.bShowExpandCollapseColumn&&h++;for(var m=h;m<a;m++)b?d(g[m],
"cellHover")||c(g[m],"cellHover"):c(g[m],"cellHover");if(this.bTreegrid||this.fixedCol){a=pega.util.Dom.getElementsById(e,this.leftBodyUL,"LI");if(!a)return;a=a[0];e=a.getElementsByTagName("UL")[0];b?d(g[m],"cellHover")||c(e,"cellHover"):c(e,"cellHover");g=f.getChildren(e);a=g.length;for(m=h;m<a;m++)b?d(g[m],"cellHover")||c(g[m],"cellHover"):c(g[m],"cellHover")}-1!=navigator.userAgent.indexOf("MSIE 8")&&(document.body.className=document.body.className,this.writeCases.push(Grids.SET_UL_HEIGHT))}}}},
isElementFromSameGridContDiv:function(a){if(a){for(;"PEGA_GRID_CONTENT"!==a.id&&(a=a.parentNode,a););if(a&&a==this.gridcontDiv)return!0}return!1},isElementFromSameGridDiv:function(a){if(a){for(;(0!=a.id.indexOf("PEGA_GRID")||"true"!==a.getAttribute("bgrid"))&&(a=a.parentNode,a););if(a&&a==this.gridDiv)return!0}return!1},sortOnProperEvent:function(a,b,c){if(this.bSortable&&(a==this.gridDiv&&(a=pega.ctx.dom.closest(c,"table")),!(pega.desktop.support.getDesktopWindow()&&pega.ui&&pega.ui.inspector&&pega.ui.inspector.isClickingSuppressed&&
pega.desktop.support.getDesktopWindow().pega.ui&&pega.desktop.support.getDesktopWindow().pega.ui.inspector&&pega.desktop.support.getDesktopWindow().pega.ui.inspector.isClickingSuppressed())&&(a=this.findCell(b,a))&&"true"==a.getAttribute("bSortable")&&this.isElementFromSameGridContDiv(a))){var d={type:"action",context:this};d.handler=this.sortGrid;d.args=[b,c,a];this.pushToQueue(d);return!0}},filterOnProperEvent:function(a,b,c){if(this.bFilterable&&pega.ctx.dom.closest(c,"div#PEGA_GRID_SKIN").parentElement.contains(a)&&
(a==this.gridDiv&&(a=pega.ctx.dom.closest(c,"table")),a=this.findCell(b,a),"pui_filter"==c.id&&!(pega.desktop.support.getDesktopWindow()&&pega.ui&&pega.ui.inspector&&pega.ui.inspector.isClickingSuppressed&&pega.desktop.support.getDesktopWindow().pega.ui&&pega.desktop.support.getDesktopWindow().pega.ui.inspector&&pega.desktop.support.getDesktopWindow().pega.ui.inspector.isClickingSuppressed()))){var d=pega.u.d.getPopOver(),e=a.getAttribute("SortField");if(this.filteredColName&&this.filteredColName==
e&&d.isActive())return this.dbp.po.close("cancel"),!0;d={type:"action",context:this};d.handler=this.openFilterGadget;d.args=[b,c,a];this.pushToQueue(d);return!0}},menusOnProperEvent:function(a,b,c){var d;pega.ctx.Grid.isFilterMenuItemClicked=!1;if(c&&"pui_colmenu"==c.id)return this.menuSortOnProperEvent(a,b,c),!0;a=a||pega.ctx.dom.closest(b.target,"table");c=b.srcElement;!c&&b.$ev&&(c=b.$ev.target);d=(c=jQuery(c).closest("a"))&&c.attr("data-click");if(!d)return!1;if(-1!=d.indexOf("pzGridMenuFilter")){if(c=
pega.ui.menubar.eventNode,c.setAttribute("data-click",d),(d=pega.util.Event.getTarget(b))&&d.appendChild(c),pega.ctx.Grid.isFilterMenuItemClicked=!0,this.sortType=this.sortProperty="",document.body.click(),this.bFilterable){c.id="pui_filter";d=document.createAttribute("filterType");var e=c.parentElement.parentElement.getAttribute("filterType");e&&""!=e||(e="true");d.value=e;c.setAttributeNode(d);this.filterOnProperEvent(a,b,c);c.id=""}}else{if(-1!=d.indexOf("pzGridMenuSortAction"))return-1!=d.indexOf("sortType\x3dASC")?
this.sortType="ASC":-1!=d.indexOf("sortType\x3dDESC")&&(this.sortType="DESC"),!0;if(-1!=d.indexOf("pzModalTemplateAppearance"))return this.sortType=this.sortProperty="",!0}return!1},menuSortOnProperEvent:function(a,b,c){if(this.bSortable&&(a==this.gridDiv&&(a=pega.ctx.dom.closest(c,"table")),!(pega.desktop.support.getDesktopWindow()&&pega.ui&&pega.ui.inspector&&pega.ui.inspector.isClickingSuppressed&&pega.desktop.support.getDesktopWindow().pega.ui&&pega.desktop.support.getDesktopWindow().pega.ui.inspector&&
pega.desktop.support.getDesktopWindow().pega.ui.inspector.isClickingSuppressed()))){var d=this.findCell(b,a);gridSortFieldName=d.getAttribute("sortfield");if(d&&"true"==d.getAttribute("bSortable")&&this.isElementFromSameGridContDiv(a))return a={type:"action",context:this},a.handler=this.menuSortGrid,a.args=[b,c,d],this.pushToQueue(a),!0}},menuSortGrid:function(a){this.resetInCall();if(!this.submitErrors){var b=a[1],c=a[2];if("keypress"==a[0].type||!b||!b.tagName||"TH"!==b.tagName&&"LI"!==b.tagName){var d=
pega.u.d.getBaseRef(this.rightBodyTbl),e=c.getAttribute("sortField");""!=e&&(a=this.sortProperty,b=this.sortType,e==this.sortProperty?(e=this.sortType,this.sortType="DESC"==e?"ASC":"DESC"):(this.sortType="ASC",this.sortProperty=e),e=new SafeURL,e.put("gridAction","SORT"),this.gridPreActivity&&e.put("gridPreActivity",this.gridPreActivity),this.gridPostActivity&&e.put("gridPostActivity",this.gridPostActivity),(c=this.getFilteredColumnIndex(c))&&e.put("columnIndex",c),e.put("pyActivity","pzGridHeaderMenuContext"),
this.pyPaginateActivity&&(e.put("pyPaginateActivity",this.pyPaginateActivity),this.pySortHandled||this.pyFilterHandled?(this.pySortHandled&&e.put("pySortHandled",this.pySortHandled),this.pyFilterHandled&&e.put("pyFilterHandled",this.pyFilterHandled)):isNaN(this.totalRecords)||e.put("totalRecords",this.totalRecords),this.pySortHandled||isNaN(this.totalRecords)||e.put("totalRecords",this.totalRecords)),(c=this.getPLPGProperty())&&e.put("PageListProperty",c),this.propertyClass&&e.put("ClassName",this.propertyClass),
this.bReportDefinition&&(e.put("RDName",this.RDName),e.put("RDAppliesToClass",this.RDAppliesToClass),e.put("pgRepContPage",this.RDContPage),this.RDPageName&&e.put("pyReportPageName",this.RDPageName),e.put("RDParamsList",this.RDParams),e.put("gridLayoutID",this.gridLayoutID),this.returnResultCount&&e.put("pyReturnResultCount",this.returnResultCount),this.pageMode&&e.put("pyPageMode",this.pageMode),"Progressive Load"==this.pageMode&&e.put("bCBOptimize",this.bCBOptimize)),e.put("BaseReference",d),this.sortProperty&&
e.put("sortProperty",this.sortProperty),this.sortType&&e.put("sortType",this.sortType),this.rangeSize&&e.put("pyPageSize",this.rangeSize),this.bFilteredGrid&&(this.bReportDefinition||(c=pega.u.d.getLayoutIndex(this.gridDiv),(c="filterpopup"+this.getConfiguredPLPGProperty()+c)&&e.put("sortPartialTrigger",c),d=pega.u.d.getSectionDiv(this.gridDiv),c=d.getAttribute("pyclassname"),d=d.getAttribute("NODE_NAME"),c&&e.put("sectionClass",c),d&&e.put("sectionName",d)),e.put("pyGridFilterCriteriaPage",this.gridFilterPage)),
this.editConfig==this.EDIT_EXPANDPANE&&e.put("showSaveDiscard","true"),e.put("isReportDef",this.bReportDefinition),a&&e.put("prevSortProperty",a),b&&e.put("prevSortType",b),e.put("customSortActivity",""),this.categorizeBy&&e.put("categorizeBy",this.categorizeBy),this.gridcontDiv.getAttribute("stableSort")&&e.put("stableSort",this.gridcontDiv.getAttribute("stableSort")),l.asyncRequest("POST",e,null,""))}}},isCtxtMenuOpen:function(){for(var a in this.contextMenuObjs)if(!0===this.contextMenuObjs[a].active)return!0;
return!1},resetInCall:function(){pega.u.d.inCall=!1;pega.u.d.changeInEventsArray.fire()},initEventHandlers:function(){k.addListener(this.gridDiv,Grids.EVENT_CLICK,this.gridEventHandler,this.gridDiv,this);k.addListener(this.gridDiv,"keypress",this.gridEventHandler,this.gridDiv,this);k.addListener(this.gridDiv,"keyup",this.gridEventHandler,this.gridDiv,this);this.editConfig==this.EDIT_HARNESS&&this.gridcontDiv.getAttribute("pyTargetSection")&&(k.addListener(this.gridDetailsDiv,"keyup",function(a){this.isLastEventFromRow=
!0},this.gridDetailsDiv,this),k.addListener(this.gridDetailsDiv,Grids.EVENT_CLICK,function(a){this.isLastEventFromRow=!1},this.gridDetailsDiv,this),k.addListener(this.gridDetailsDiv,"focusin",function(a){this.isLastEventFromRow=!0},this.gridDetailsDiv,this));this.bRowHovering&&(k.addListener(this.gridDiv,"mouseover",this.gridEventHandler,this.gridDiv,this),k.addListener(this.gridDiv,"mouseout",this.gridEventHandler,this.gridDiv,this));"Progressive Load"==this.pageMode&&k.addListener(this.layoutWrapperDiv,
"scroll",this.gridEventHandler,this.gridDiv,this);var a=this;a.tempGridEventHandler=function(b){a.gridEventHandler(b)};pega.env.ua.ie?(this.bTreegrid||this.fixedCol?k.addListener(this.gridDiv,"focusin",this.gridEventHandler,this.leftBodyUL,this):k.addListener(this.gridDiv,"focusin",this.gridEventHandler,this,!0),this.editConfig==this.EDIT_HARNESS&&this.threadProcessing&&(k.addListener(this.gridDetailsDiv,"focusin",this.setExecutionThread,this,!0),k.addListener(this.gridDetailsDiv,"focusout",this.resetExecutionThread,
this,!0),k.addListener(this.gridDetailsDiv,"mouseover",this.setExecutionThread,this,!0),k.addListener(this.gridDetailsDiv,"mouseout",this.resetExecutionThread,this,!0)),this.editConfig!=this.EDIT_HARNESS&&this.editConfig!=this.EDIT_EXPANDPANE||!this.threadProcessing||k.addListener(document.body,Grids.EVENT_CLICK,this.resetExecutionThread,this,!0)):(a.focusEventHandler=function(b){a.gridEventHandler(b)},a.tempSetExecutionThread=function(b){a.setExecutionThread(b)},a.tempResetExecutionThread=function(b){a.resetExecutionThread(b)},
this.gridDiv.addEventListener("focus",a.focusEventHandler,!0),this.editConfig==this.EDIT_HARNESS&&this.threadProcessing&&(this.gridDetailsDiv.addEventListener("focus",a.tempSetExecutionThread,!0),this.gridDetailsDiv.addEventListener(Grids.EVENT_CLICK,a.tempSetExecutionThread,!0),document.body.addEventListener("blur",a.tempResetExecutionThread,!0),document.body.addEventListener(Grids.EVENT_CLICK,a.tempResetExecutionThread,!0),this.gridDetailsDiv.addEventListener("mouseover",a.tempSetExecutionThread,
!0),this.gridDetailsDiv.addEventListener("mouseout",a.tempResetExecutionThread,!0)),this.editConfig==this.EDIT_EXPANDPANE&&this.threadProcessing&&document.body.addEventListener(Grids.EVENT_CLICK,a.tempResetExecutionThread,!0));if(this.bTreegrid||this.fixedCol)k.addListener(this.leftBodyUL,Grids.EVENT_DOUBLE_CLICK,this.gridEventHandler,this.leftBodyUL,this),k.addListener(this.leftBodyUL,"keydown",this.gridEventHandler,this.leftBodyUL,this);k.addListener(this.rightBodyTbl,Grids.EVENT_DOUBLE_CLICK,this.gridEventHandler,
this.rightBodyTbl,this);k.addListener(this.rightBodyTbl,"keydown",this.gridEventHandler,this.rightBodyTbl,this);if(this.gridRowDDInst||this.activeResize||this.editConfig==this.EDIT_ROW||this.activeRow)pega&&pega.capabilityList&&pega.capabilityList.isTouchAble()&&k.addListener(document.body,"touchstart",a.tempGridEventHandler,document.body,this),k.addListener(document.body,"mouseup",a.tempGridEventHandler,document.body,this),this.bInlineEditGridInModal&&this.modalDetailsDiv&&k.addListener(document.body,
"mousedown",this.setModalScrollLeft,this.modalDetailsDiv,this),"true"==this.gridcontDiv.getAttribute("haswidth")&&this.editConfig==this.EDIT_ROW&&k.addListener(document.body,"mousedown",this.setGridScrollLeft,this.gridcontDiv,this);this.createResizables();this.bNumberedSkin&&this.createFrame();!this.bPageGroup&&this.bDragDrop&&(this.repeatType==this.ROW_REPEAT?(this.createFrame(),l.harness_execute(function(){a.unregRelatedDDTargets()},!0),this.bTreegrid||this.fixedCol?(k.addListener(this.leftBodyUL,
"mouseover",this.initDDTarget,this,!0),k.addListener(this.leftBodyUL,"mousedown",this.attachDrag,this,!0)):(k.addListener(this.rightBodyTbl,"mouseover",this.initDDTarget,this,!0),k.addListener(this.rightBodyTbl,"mousedown",this.attachDrag,this,!0))):this.rightHeaderTbl&&new pega.ui.gridColDD(this.rightHeaderTbl,this.rightBodyTbl,this.gridDiv,this));k.addListener(this.gridDiv,Grids.EVENT_RIGHT_CLICK,this.gridEventHandler,this.gridDiv,this)},arrangeIcons:function(a){for(var b=f.getChildren(a),c=0;c<
b.length;c++){var d=f.getChildren(b[c]);if(d&&0<d.length)for(var e=0;e<d.length;e++)if(d[e].getAttribute("PL_INDEX"))this.arrangeIcons(d[e]);else if(0==e){var g=pega.util.Dom.getElementsById("dragHandle",d[0],"DIV");g&&"none"==g[0].style.display&&(!this.bAlwaysExpandRoot||this.bAlwaysExpandRoot&&a.parentNode!=this.leftBodyUL)&&(d[0].style.width="16px")}}},getRowIndexFromPosition:function(a){this.rowHeight=this.getAvgRowHeight();a||(a=this.layoutWrapperDiv.scrollTop);a=this.bDiscardInvisibleRows&&
0>this.scrollDirection?this.layoutWrapperDiv.scrollHeight-(a+this.layoutWrapperDiv.offsetHeight):a;this.layoutWrapperDiv.offsetHeight>this.rowHeight*this.rangeSize&&(a+=this.layoutWrapperDiv.offsetHeight-this.rowHeight*this.rangeSize);this.rowHeight||(this.rowHeight=this.getLeftRow(1).offsetHeight);this.editConfig==this.EDIT_EXPANDPANE&&(a-=this.expDetailsHeight,a=0>a?0:a);this.bCategorizedGrid&&(a-=this.categorizedHeadersHeight);a=Math.round(a/this.rowHeight);this.bDiscardInvisibleRows&&0>this.scrollDirection&&
(a=this.totalRecords-a);return 0==a?1:a},getTopLevelLeftRow:function(a){var b=null,c=this.getTopLevelNodesLength();a<c&&(c=this.iKey,c=c.substring(0,c.indexOf("_")),c=pega.ui.property.toHandle(c),(c+="$l"+a)&&(b=pega.util.Dom.getElementsById(c,this.leftBodyUL,"LI")[0]));return b},isDummyRow:function(a){var b=this.getLeftRow(a);this.bTreegrid&&"none"==b.parentNode.style.display&&(b=this.getTopLevelLeftRow(a));b&&this.bTreegrid&&(b=f.getFirstChild(b));return b&&null!=b.getAttribute("OAArgs")?!1:!0},
progressiveLoadGrid:function(a){this.bDiscardInvisibleRows&&this.setScrollDirection(this.layoutWrapperDiv);if(!this.bProgressiveLoading&&(!this.beforeProgressiveLoadFn||""==this.beforeProgressiveLoadFn||this.beforeProgressiveLoadFn.call(this))){var b=pega.u.d.getBaseRef(this.rightBodyTbl),c=new SafeURL;c.put("gridAction","PAGINATE");this.bEditable||c.put("ReadOnly","true");this.gridPreActivity&&c.put("gridPreActivity",this.gridPreActivity);this.gridPostActivity&&c.put("gridPostActivity",this.gridPostActivity);
c.put("gridActivity","");c.put("PageListProperty",this.getPLPGProperty());c.put("ClassName",this.propertyClass);this.bReportDefinition&&(c.put("isReportDef","true"),c.put("RDName",this.RDName),c.put("RDAppliesToClass",this.RDAppliesToClass),c.put("pgRepContPage",this.RDContPage),this.RDPageName&&c.put("pyReportPageName",this.RDPageName),c.put("RDParamsList",this.RDParams),c.put("gridLayoutID",this.gridLayoutID),c.put("bCBOptimize",this.bCBOptimize));c.put("BaseReference",b);var d,e,g;if(this.bCustomLoad)if(a)g=
a;else if(!this.bDiscardInvisibleRows){var f=this.getActiveRowIndex();g=Math.ceil(f/this.rangeSize);e=(g-1)*this.rangeSize+1;a=e+parseInt(this.rangeSize)-1;if(!this.isDummyRow(a)){d=parseInt(f,10)+parseInt(this.rangeSize,10);if(!this.getLeftRow(d)||!this.isDummyRow(d)){this.bCustomLoad=!1;this.isDummyRow(this.noOfPagesLoaded*this.rangeSize)&&this.noOfPagesLoaded--;return}g+=1}}else{if(this.bDiscardInvisibleRows){if(("auto"==this.topBuffer.style.height?this.rightBodyTbl.offsetHeight:this.topBuffer.offsetHeight+
this.rightBodyTbl.offsetHeight)>this.layoutWrapperDiv.scrollTop+this.layoutWrapperDiv.offsetHeight)return;this.activeRow&&(this.prevActivePLIndex=this.activeRow+(this.getFirstLoadedRowIndex()-1));e=this.getRowIndexFromPosition();d=e+parseInt(this.rangeSize,10);var m=this.getFirstLoadedRowIndex(),n=m+this.getNoOfRowsLoaded()-1;if(d<=n)return;this.prevVisibleStartIndex=e;this.currentPageIndex=g=Math.ceil(e/this.rangeSize);e=this.getFirstLoadedRowIndex()}}else if(this.customLoadStartIndex&&""!=this.customLoadStartIndex)this.currentPageIndex=
g=Math.ceil(this.customLoadStartIndex/this.rangeSize),e=this.getRowIndexFromPosition(),this.isDummyRow(e)||(e+=parseInt(this.rangeSize,10)),d=e+parseInt(this.rangeSize,10),d=Math.ceil(d/this.rangeSize)*this.rangeSize,d<this.noOfPagesLoaded*this.rangeSize&&(d=this.noOfPagesLoaded*this.rangeSize);else{if(this.bDiscardInvisibleRows){d=this.layoutWrapperDiv.scrollTop;e=this.layoutWrapperDiv.scrollHeight;this.updateTopBottomBufferHeights();var k=parseInt(this.layoutWrapperDiv.scrollHeight/e*d)}e=this.getRowIndexFromPosition(k);
a=this.bTreegrid?this.getTopLevelNodesLength():this.bDiscardInvisibleRows?this.totalRecords:this.getTableLength(this.rightBodyTbl);if(e>a)return;var l=Math.ceil(this.totalRecords/this.rangeSize);if(this.bDiscardInvisibleRows)if(d=e+this.scrollDirection*parseInt(this.rangeSize,10),d=1>d?1:d,this.prevVisibleStartIndex=0<this.scrollDirection?e:d,m=this.getFirstLoadedRowIndex(),n=m+this.getNoOfRowsLoaded()-1,0<this.scrollDirection){if(this.currentPageIndex==l||this.currentPageIndex+1==l||d<=n)return}else{if(1==
this.currentPageIndex||2==this.currentPageIndex||d>=m)return}else f=this.getRightRow(e),d=e+parseInt(this.rangeSize,10);d>a&&(d=a);this.activeRow&&(this.prevActivePLIndex=this.activeRow+(this.getFirstLoadedRowIndex()-1));this.currentPageIndex=g=Math.ceil(e/this.rangeSize);if(this.bDiscardInvisibleRows)e=this.getFirstLoadedRowIndex();else{if((this.editConfig==this.EDIT_HARNESS||this.editConfig==this.EDIT_EXPAND_PANE&&this.threadProcessing)&&"true"==this.comingFromAdd&&this.gridPrevScrollTop<this.layoutWrapperDiv.scrollTop&&
this.currentPageIndex>=this.noOfPagesLoaded){alert("Please submit/discard the new row details before loading more items");return}if(0==e&&!this.isDummyRow(d)||!this.isDummyRow(e)&&!this.isDummyRow(d)){d==a&&(this.currentPageIndex=Math.ceil(a/this.rangeSize));return}f&&!this.isDummyRow(e)&&(e=d);if(this.editConfig==this.EDIT_EXPANDPANE&&e>this.totalRecords&&e>this.getExpandPaneTableLength())return;this.currentPageIndex=g=Math.ceil(e/this.rangeSize)}}this.bDiscardInvisibleRows||(e=(this.bCustomLoad?
g-1:this.noOfPagesLoaded)*this.rangeSize+1);this.bProgressiveLoading=!0;this.currentPageIndex=g;c.put("startIndex",e);c.put("currentPageIndex",g);c.put("pyPageSize",this.rangeSize);this.bDiscardInvisibleRows?(f=3*this.rangeSize,l==this.currentPageIndex&&(f=this.totalRecords-(l-1)*this.rangeSize+this.rangeSize),1==this.currentPageIndex&&(f=2*this.rangeSize),l=e+f-1,c.put("recordsInCurrentPage",f),this.pyPaginateActivity||this.bCBOptimize&&this.bReportDefinition||(e>=m&&e<=n?(n+=1,l=f-(n-e),c.put("startIndex",
n),c.put("recordsInCurrentPage",l),this.insertPosition="down",this.deleteRowsBeforeID=this.getRightRow(e-m+1).id):l>=m&&l<=n&&(c.put("recordsInCurrentPage",f-(l-(m-1))),this.insertPosition="up",this.deleteRowsAfterID=this.getRightRow(l-m+1).id))):c.put("recordsInCurrentPage",(this.currentPageIndex-this.noOfPagesLoaded+1)*this.rangeSize);this.customLoadStartIndex&&""!=this.customLoadStartIndex&&(e=(g-1)*this.rangeSize+1,!this.bDiscardInvisibleRows&&this.bFilteredGrid&&e>this.noOfPagesLoaded*this.rangeSize+
1?this.customLoadStartIndex="":(c.put("startIndex",e),c.put("recordsInCurrentPage",d-e+1)));(this.bFilteredGrid||this.isFilterPOOpen)&&c.put("pyGridFilterCriteriaPage",this.gridFilterPage);this.bDiscardInvisibleRows&&(this.pyPaginateActivity&&c.put("pyPaginateActivity",this.pyPaginateActivity),this.pyPaginateActivity||this.bCBOptimize&&this.bReportDefinition||this.bDataObject)&&(c.put("gridActivity","pzGridSortPaginate"),c.put("pyPageMode","Progressive Load"),c.put("sortProperty",this.sortProperty),
c.put("sortType",this.sortType));m={partialTrigger:"progressiveLoad",domAction:"replace",beforeDomAction:this.loadProgressiveRows,beforeDomActionContext:this,beforeParams:null,bTreegrid:this.bTreeGrid,sendSectionData:this.bReportDefinition||this.bDataObject||this.customLoadStartIndex&&""!=this.customLoadStartIndex?"true":"false"};d=new SafeURL;this.categorizeBy&&d.put("categorizeBy",this.categorizeBy);this.reloadGridLayout("pzdoGridAction",c.toQueryString(),null,null,this.gridDiv,m,!0,d)}},setScrollDirection:function(a){"undefined"==
typeof this.currentScrollTop&&(this.currentScrollTop=a.scrollTop);var b=this.currentScrollTop-a.scrollTop,c=0;0>b?c=1:0<b&&(c=-1);this.currentScrollTop=a.scrollTop;this.scrollDirection=c},sortGrid:function(a){this.resetInCall();if(!this.submitErrors){var b=a[0],c=a[1];a=a[2];if("keypress"==b.type||!c||!c.tagName||"TH"!==c.tagName&&"LI"!==c.tagName){var d=pega.u.d.getBaseRef(this.rightBodyTbl),e=a.getAttribute("sortField");""!=e&&(c=this.sortProperty,a=this.sortType,e==this.sortProperty?(e=this.sortType,
this.sortType="DESC"==e?"ASC":"DESC"):(this.sortType="ASC",this.sortProperty=e),e=new SafeURL,e.put("gridAction","SORT"),this.gridPreActivity&&e.put("gridPreActivity",this.gridPreActivity),this.gridPostActivity&&e.put("gridPostActivity",this.gridPostActivity),e.put("gridActivity","pzGridSortPaginate"),this.pyPaginateActivity&&(e.put("pyPaginateActivity",this.pyPaginateActivity),this.pySortHandled||this.pyFilterHandled?(this.pySortHandled&&e.put("pySortHandled",this.pySortHandled),this.pyFilterHandled&&
e.put("pyFilterHandled",this.pyFilterHandled)):isNaN(this.totalRecords)||e.put("totalRecords",this.totalRecords),this.pySortHandled||isNaN(this.totalRecords)||e.put("totalRecords",this.totalRecords)),e.put("PageListProperty",this.getPLPGProperty()),e.put("ClassName",this.propertyClass),this.bReportDefinition&&(e.put("RDName",this.RDName),e.put("RDAppliesToClass",this.RDAppliesToClass),e.put("pgRepContPage",this.RDContPage),this.bLoadActivity&&e.put("bLoadActivity",this.bLoadActivity),this.returnResultCount&&
e.put("pyReturnResultCount",this.returnResultCount),this.returnResultCount&&e.put("pyReturnResultCount",this.returnResultCount),this.pageMode&&e.put("pyPageMode",this.pageMode),this.RDPageName&&e.put("pyReportPageName",this.RDPageName),e.put("RDParamsList",this.RDParams),e.put("gridLayoutID",this.gridLayoutID),"Progressive Load"==this.pageMode&&e.put("bCBOptimize",this.bCBOptimize)),e.put("BaseReference",d),this.bEditable||e.put("ReadOnly","true"),e.put("sortProperty",this.sortProperty),e.put("sortType",
this.sortType),this.rangeSize&&e.put("pyPageSize",this.rangeSize),this.bFilteredGrid&&(this.bReportDefinition||(d=pega.u.d.getLayoutIndex(this.gridDiv),d="filterpopup"+this.getConfiguredPLPGProperty()+d,e.put("sortPartialTrigger",d),d=pega.u.d.getSectionDiv(this.gridDiv),e.put("sectionClass",d.getAttribute("pyclassname")),e.put("sectionName",d.getAttribute("NODE_NAME"))),e.put("pyGridFilterCriteriaPage",this.gridFilterPage)),this.editConfig==this.EDIT_EXPANDPANE&&e.put("showSaveDiscard","true"),e.put("isReportDef",
this.bReportDefinition),e.put("prevSortProperty",c),e.put("prevSortType",a),e.put("customSortActivity",""),e.put("KeepGridMessages",!0===pega.u.d.KEEP_GRID_MESSAGES?"true":"false"),c=new SafeURL,this.categorizeBy&&c.put("categorizeBy",this.categorizeBy),this.gridcontDiv.getAttribute("stableSort")&&c.put("stableSort",this.gridcontDiv.getAttribute("stableSort")),this.reloadGridLayout("pzdoGridAction",e.toQueryString(),b,null,this.gridDiv,null,!0,c))}}},reloadGridLayout:function(a,b,c,d,e,g,f,m){e=e?
e:pega.util.Event.getTarget(c);if(this.bProgressiveLoading||l.shouldSubmitProceed(c,this.gridDiv)){a={reloadElement:e,preActivity:a,preActivityParams:b,event:c,focusParams:d,strReloadType:"RepeatLayout",isResponseRO:"0",showOnlyMask:f,partialParams:g,oldGridObj:this};m&&(a.appendExtraQueryString=m);g&&(g.partialTrigger&&"progressiveLoad"==g.partialTrigger&&(a.gridAction="progressiveLoad"),g.sendSectionData&&(a.sendSectionData=g.sendSectionData));g=a.reloadElement;m=!0;for(b=pega.u.d.getSectionDiv(this.gridDiv);"EXPAND-OUTERFRAME"!=
g.id;)if(g=g.parentNode,null==g||g==b){m=!1;break}1==m?g.getAttribute("PARAM_NAME")?pega.u.d.refreshRepeatLayout(a):pega.u.d.reload(a):pega.u.d.reload(a)}},paginateGrid:function(a,b){var c=0==this.totalRecords%this.rangeSize?Math.floor(this.totalRecords/this.rangeSize):Math.ceil(this.totalRecords/this.rangeSize);if(1!=this.currentPageIndex||"previous"!=b&&"first"!=b)if(this.currentPageIndex!=c||"next"!=b&&"last"!=b){switch(b){case "next":b=this.currentPageIndex+1;break;case "previous":b=this.currentPageIndex-
1;break;case "first":b=1;break;case "last":b=c;break;case "nextbunch":b=0==this.currentPageIndex%10?this.currentPageIndex+1:10*Math.ceil(this.currentPageIndex/10)+1;break;case "previousbunch":b=0==this.currentPageIndex%10?this.currentPageIndex-10:10*Math.floor(this.currentPageIndex/10);break;default:b=this.currentPageIndex}this.gridPaginator(a,b)}},handleEditItem:function(a,b,c){var d=this;"CSS1Compat"!==document.compatMode&&-1!=navigator.userAgent.indexOf("MSIE 8")&&"row"==this.editConfig&&setTimeout(function(){var a=
d.gridcontDiv.getElementsByTagName("select");a&&0<a.length&&(d.disableRowHovering=!0)},100);var e=this.findCell(a,b);if((c=e?this.getRowIndex(e):c)&&""!=c&&0!=c&&!this.rightBodyTbl.rows[c].getAttribute("busyRow"))if(this.editConfig==this.EDIT_ROW)this.editRow(a,b,c);else if(this.editConfig==this.EDIT_MODAL)this.editInModal(a,b);else if(!this.submitErrors&&(b==this.leftBodyUL||b==this.rightBodyTbl))if(this.editConfig==this.EDIT_HARNESS)this.editInHarness(a,b);else if(this.editConfig==this.EDIT_EXPANDPANE||
this.bShowExpandDetails){(!this.threadProcessing||this.bReadOnlyShowDetails||this.bRODetails)&&this.bExpandMultipleRows||!this.expandedElem&&!this.toBeExpanded?c=this.getLeftRow(this.getActiveRowIndex()):this.expandedElem?(c=this.expandedElem,a=this.getLeftRow(this.getActiveRowIndex()),this.expandedElem!=a&&(this.toBeExpanded=a),a={type:Grids.EVENT_CLICK,target:this.expandedElem}):(c=this.toBeExpanded,a={type:Grids.EVENT_CLICK,target:this.toBeExpanded},this.toBeExpanded=null);if(c&&(e=this.bDragDrop||
this.bNumberedSkin?f.getNextSibling(f.getFirstChild(c)):f.getFirstChild(c)))var g=this.bShowExpandCollapseColumn?f.getFirstChild(e):e;if(!c.getAttribute("rowExpanded")){var h=a,m=this;"radio"===h.target.type?setTimeout(function(){m.expandRowDetails(h,b,g)}):this.expandRowDetails(h,b,g)}else if(c.getAttribute("rowExpanded")&&"true"==c.getAttribute("rowExpanded"))this.collapseRowDetails(a,b,g);else if(!this.threadProcessing||this.threadProcessing&&"true"!=this.comingFromAdd)this.selectPage(a,b),this.bRODetails||
(e=this.findCell(a,b))&&(c=this.getRowIndex(e))&&""!=c&&0!=c&&this.enableSaveDiscardButtons(a)}else this.selectPage(a,b)},handleSummaryGridOpen:function(a,b,c){var d=null;a&&"TD"==a.tagName&&(d=a.cellIndex);a=this.rightBodyTbl.rows[this.getActiveRowIndex()];var e=f.getElementsById(a.id,this.leftBodyUL)[0];a=f.getElementsByClassName("expandNode","a",e);var g=f.getElementsByClassName("collapseNode","a",e),e=f.getElementsByClassName("noEC","a",e)[0];if(0==a.length&&0==g.length&&e){a=SafeURL_createFromURL(pega.ctx.url);
g=this.getLeftRow(b);a.put("pyActivity","pzShowDrillDownReport");a.put("Page",pega.ui.property.toReference(g.id));a.put("ReportName",this.RDName);a.put("ReportClassName",this.RDAppliesToClass);a.put("openWorkInNewTab","true");d&&a.put("columnIndex",d);var h=Grids.getActiveGrid(c);l.asyncRequest("POST",a,{success:function(a){var c=a.responseText;""!=c&&"noInsKey"!=c?(c=c.split("|"),a=c[0],c=c[1],""!=a&&("Work"===c&&openWorkByHandle(a),"Assign"===c&&openAssignment(a))):1==!this.disableDD&&h.openDDReport(b,
d)},failure:function(a){alert("AJAX call failed")}},"")}},gridPaginator:function(a,b){var c={type:"action",context:this};c.handler=this.gridPagination;c.args=[a,b];this.pushToQueue(c)},gridPagination:function(a){this.resetInCall();var b="",c="";if(!this.submitErrors){var d=a[0],e=a[1];a=0==this.totalRecords%this.rangeSize?Math.floor(this.totalRecords/this.rangeSize):Math.ceil(this.totalRecords/this.rangeSize);if("First X Results"==e)b=e=1,c="First X Results";else if("Show All"==e)c="Show All",b=e=
1;else{e=parseInt(e);if(isNaN(e)||0>=e)return;e>a&&(e=a);b=(e-1)*this.rangeSize+1}a=new SafeURL;a.put("gridAction","PAGINATE");this.gridPreActivity&&a.put("gridPreActivity",this.gridPreActivity);this.gridPostActivity&&a.put("gridPostActivity",this.gridPostActivity);a.put("gridActivity","pzGridSortPaginate");a.put("pyPaginateActivity",this.pyPaginateActivity);a.put("PageListProperty",this.getPLPGProperty());a.put("ClassName",this.propertyClass);this.bReportDefinition&&(a.put("RDName",this.RDName),
this.bLoadActivity&&a.put("bLoadActivity",this.bLoadActivity),a.put("RDAppliesToClass",this.RDAppliesToClass),a.put("pgRepContPage",this.RDContPage),this.RDPageName&&a.put("pyReportPageName",this.RDPageName),a.put("RDParamsList",this.RDParams),a.put("gridLayoutID",this.gridLayoutID),"Progressive Load"==this.pageMode&&a.put("bCBOptimize",this.bCBOptimize));var g=pega.u.d.getBaseRef(this.rightBodyTbl);a.put("BaseReference",g);this.bEditable||a.put("ReadOnly","true");a.put("startIndex",b);a.put("currentPageIndex",
e);""!=c&&(a.put("currentDisplay",c),"Show All"==c&&a.put("pyTotalResultCount",this.totalRecords));this.returnResultCount&&a.put("pyReturnResultCount",this.returnResultCount);this.pageMode&&a.put("pyPageMode",this.pageMode);a.put("pyPageSize",this.rangeSize);this.sortProperty&&null!=this.sortProperty&&a.put("sortProperty",this.sortProperty);this.sortType&&null!=this.sortType&&a.put("sortType",this.sortType);a.put("isReportDef",this.bReportDefinition);a.put("prevStartIndex",(this.currentPageIndex-
1)*this.rangeSize+1);this.bFilteredGrid&&a.put("pyGridFilterCriteriaPage",this.gridFilterPage);this.pyPaginateActivity&&(a.put("pyPaginateActivity",this.pyPaginateActivity),this.pySortHandled||this.pyFilterHandled?(this.pySortHandled&&a.put("pySortHandled",this.pySortHandled),this.pyFilterHandled&&a.put("pyFilterHandled",this.pyFilterHandled)):a.put("totalRecords",this.totalRecords));this.editConfig==this.EDIT_EXPANDPANE&&a.put("showSaveDiscard","true");c=new SafeURL;this.categorizeBy&&c.put("categorizeBy",
this.categorizeBy);k.preventDefault(d);b=pega.util.Dom.getAncestorBy(pega.util.Event.getTarget(d),function(a){return"gridActionTop"==a.className||"gridActionBottom"==a.className?!0:!1});this.reloadGridLayout("pzdoGridAction",a.toQueryString(),d,{focus:"paginator-element","grid-action-class":b.className},this.gridDiv,null,!0,c)}},refreshList:function(a,b){var c=pega.u.d.getBaseRef(this.rightBodyTbl),d=this.currentPageIndex,e=new SafeURL;e.put("gridAction","REFRESHLIST");this.gridPreActivity&&e.put("gridPreActivity",
this.gridPreActivity);this.gridPostActivity&&e.put("gridPostActivity",this.gridPostActivity);var g=this.getActiveRowIndex();this.bFocusibleGrid&&g&&e.put("gridActiveRow",g);if(b)var f=b.dpParams;(this.pyPaginateActivity||this.bReportDefinition&&d)&&e.put("totalRecords",this.totalRecords);d&&this.rangeSize&&("Progressive Load"==this.pageMode?(b=1,this.bDiscardInvisibleRows?(e.put("bDiscardInvisibleRows","true"),b=this.getFirstLoadedRowIndex(),e.put("startIndex",b),g=3*this.rangeSize,1==this.currentPageIndex&&
(g=2*this.rangeSize),e.put("recordsInCurrentPage",g)):e.put("recordsInCurrentPage",(this.currentPageIndex+1)*this.rangeSize)):b=(d-1)*this.rangeSize+1,e.put("startIndex",b),e.put("pyPageSize",this.rangeSize),e.put("currentPageIndex",d));this.bFilteredGrid&&e.put("pyGridFilterCriteriaPage",this.gridFilterPage);this.bReportDefinition&&(e.put("RDName",this.RDName),e.put("RDAppliesToClass",this.RDAppliesToClass),e.put("pgRepContPage",this.RDContPage),this.RDPageName&&e.put("pyReportPageName",this.RDPageName),
e.put("gridLayoutID",this.gridLayoutID),"Progressive Load"==this.pageMode&&e.put("bCBOptimize",this.bCBOptimize));e.put("BaseReference",c);this.sortProperty&&this.sortType&&(e.put("sortProperty",this.sortProperty),e.put("sortType",this.sortType));e.put("isReportDef",this.bReportDefinition);this.reloadGridLayout("pzdoGridAction",e.toQueryString(),a,null,this.gridDiv,null,!0,f)},openFilterGadget:function(a,b){b=a[0];var c=a[2],d=a[1];a=pega.u.d.getPopOver(d);var e=c.getAttribute("SortField"),g=d.getAttribute("filterType");
if(!g)for(var f=d.attributes,m=f.length,k=0;k<m;k++)"filterType"===f[k].nodeName&&(g=f[k].nodeValue);this.filteredColName=e;l.fromFilterPopover=d;k=this.gridcontDiv.getAttribute("pyDisplaySelectedValuesFirst");null===k&&(k="false");m=c.getAttribute("pyCellType");null===m&&(m="static");f={bindings:{associatedElement:d,bindingProvider:this.dbp},position:{offsetAttach:{x:2,y:3},size:{min:{x:178,y:0},max:{}}},callbacks:{onContentDisplayed:[this.filterGadgetOnShow,[],this],onBeforeClose:[this.checkValidInput,
[e],this],onClose:[this.submitFilterCriteria,[e],this]},buttons:{ok:!0,cancel:!0,okText:pega.u.d.fieldValuesList.get("ApplyFilter"),cancelText:pega.u.d.fieldValuesList.get("CancelFilter")}};e={pyGridFilterCriteriaPage:this.gridFilterPage,PageListProperty:this.getPLPGProperty(),BaseReference:this.baseRef,pyColumnName:e,ClassName:this.propertyClass,sortProperty:this.sortProperty?this.sortProperty:"",sortType:this.sortType?this.sortType:"",pyPaginateActivity:this.pyPaginateActivity?this.pyPaginateActivity:
"",pyFilterHandled:this.pyPaginateActivity?this.pyFilterHandled:"",pyDisplaySelectedValuesFirst:k,pyCellType:m};k=pega.u.d.getSectionDiv(d);e.sectionName=k.getAttribute("NODE_NAME");e.sectionClass=k.getAttribute("pyclassname");k=pega.u.d.getLayoutIndex(this.gridDiv);e.partialTrigger="filterpopup"+this.getConfiguredPLPGProperty()+k;k=c.getAttribute("bFormattedControl");e.isFormattedControl=k;this.filteredColIndex=k=this.getFilteredColumnIndex(c);e.columnIndex=k;e.filterType=g;c.getAttribute("pyShowFilterUIBy")&&
(e.pyShowFilterUIBy=c.getAttribute("pyShowFilterUIBy"));"true"!=g&&"search"!=g||!c.getAttribute("pyRangeFiltering")||(e.pyRangeFiltering=c.getAttribute("pyRangeFiltering"));c.getAttribute("bsecinclude")&&(e.bsecinclude=c.getAttribute("bsecinclude"));c.getAttribute("data-dateFormat")&&(e.dateFormat=c.getAttribute("data-dateFormat"));c.getAttribute("data-dateTimeFormat")&&(e.dateTimeFormat=c.getAttribute("data-dateTimeFormat"));c.getAttribute("data-dateTimeCutoff")&&(e.pyDateTimeSecondCutoff=c.getAttribute("data-dateTimeCutoff"));
c.getAttribute("data-dontShowPastFuture")&&(e.pyDontShowPastFuture=c.getAttribute("data-dontShowPastFuture"));null!=this.gridDiv.getAttribute("bRangeFilterByFormat")&&(e.bRangeFilterByFormat=this.gridDiv.getAttribute("bRangeFilterByFormat"));if(this.bReportDefinition&&(this.bLoadActivity&&(e.bLoadActivity=this.bLoadActivity),e.isReportDef=this.bReportDefinition,e.RDName=this.RDName,e.RDAppliesToClass=this.RDAppliesToClass,e.pgRepContPage=this.RDContPage,this.RDPageName&&(e.pyReportPageName=this.RDPageName),
e.RDParamsList=this.RDParams,this.dynamicColumnIndex&&(e.dynamicColumnIndex=this.dynamicColumnIndex),"Progressive Load"==this.pageMode&&(e.bCBOptimize=this.bCBOptimize),""!=this.RDParams))for(c=this.gridLayoutID,e.gridLayoutID=this.gridLayoutID,g=this.RDParams.split(","),k=0;k<g.length;k++)if(d=pega.ctx.dom.getElementsByName(c+g[k])[0],e[d.name]=d.value,m=d.value.indexOf("."),0<m&&"PARAM"==d.value.substring(0,m).toUpperCase()&&(d=pega.ctx.dom.getElementsByName(d.value.substring(m+1))[0]))e[d.name]=
d.value;f.content={type:"section",name:"pzGridFilterPanel",preActivity:{name:"pzGetGridColUniqueValues",page:this.primPage,params:e}};a.open(f);pega.util.Event.stopPropagation(b)},filterGadgetOnShow:function(a){this.isFilterPOOpen=!0;pega.u.d.inCall=!1;pega.u.d.changeInEventsArray.fire();var b=pega.u.d.getFirstFocusableElement(a.id);if(b){try{window.setTimeout(function(){b.focus()},50)}catch(e){return}a.setAttribute("role","dialog");a.setAttribute("aria-labelledby","filterCriteria");try{var c=a.style.height.replace("px",
""),d=a.scrollHeight;c&&d&&c<d&&(a.style.overflowX="hidden")}catch(e){}}},checkValidInput:function(a,b,c){if(a&&("CANCEL"==a.toUpperCase()||"CLICKAWAY"==a.toUpperCase()||"CLEARFILTER"==a.toUpperCase()))return!0;if(c){if((a=c.popOverElement)&&"function"==typeof validation_validate&&!validation_validate(a))return!1;try{if(0==this.checkRangeFilter(a))return!1}catch(d){}}return!0},checkRangeFilter:function(a){a=pega.util.Dom.getElementsByAttribute("node_name","pzGridFilterRangeSearch","DIV",a);if(null!=
a[0]){var b=a[0].getElementsByTagName("input");if(b&&2<=b.length){for(var c=b.length,d=a="",e=0;e<c;e++)a=b[0],d=b[1];if(a.value&&d.value&&a.value.length&&d.value.length&&a.name.endsWith("pyStartDate")&&d.name.endsWith("pyEndDate")){var b=new Date(pega.u.d.wrapperProcessDate(a.value,"0")),c=new Date(pega.u.d.wrapperProcessDate(d.value,"0")),b=b.valueOf(),g=c.valueOf(),c=[],e=[],f=[];if(isNaN(b)||isNaN(g))return isNaN(b)&&c.push(display_getValidationError(a,"",invalidDateValue)),isNaN(g)&&c.push(display_getValidationError(d,
"",invalidDateValue)),display_showImageErrors(c,e,f),!1}if(a.name.endsWith("pyStartInteger")&&d.name.endsWith("pyEndInteger")&&(b=parseInt(a.value),c=parseInt(d.value),!isNaN(b)&&!isNaN(c)&&b>c)||a.name.endsWith("pyStartDecimal")&&d.name.endsWith("pyEndDecimal")&&(b=parseFloat(a.value.replace(/,/g,"")),c=parseFloat(d.value.replace(/,/g,"")),!isNaN(b)&&!isNaN(c)&&b>c)||a.name.endsWith("pyStartDouble")&&d.name.endsWith("pyEndDouble")&&(b=parseFloat(a.value),c=parseFloat(d.value),!isNaN(b)&&!isNaN(c)&&
b>c))return c=[],e=[],f=[],a=display_getValidationError(d,"",filterPanelRangeMsg1),c.push(a),display_showImageErrors(c,e,f),!1;if(a.name.endsWith("pyStartDateTime")&&d.name.endsWith("pyEndDateTime")&&(b=new Date(pega.u.d.wrapperProcessDate(a.value,"1")),c=new Date(pega.u.d.wrapperProcessDate(d.value,"1")),b&&c&&b>c)||a.name.endsWith("pyStartDate")&&d.name.endsWith("pyEndDate")&&(b=new Date(pega.u.d.wrapperProcessDate(a.value,"0")),c=new Date(pega.u.d.wrapperProcessDate(d.value,"0")),b&&c&&b>c))return c=
[],e=[],f=[],a=display_getValidationError(d,"",filterPanelRangeMsg2),c.push(a),display_showImageErrors(c,e,f),!1}}return!0},clearFiltering:function(){if(this.bFilteredGrid){var a=this.prepareFitleringRequest();this.pyPaginateActivity||this.bReportDefinition?a.put("clearFilterActivity","pzGetGridColUniqueValues"):a.put("gridActivity","pzGetGridColUniqueValues");"Progressive Load"==this.pageMode&&this.bReportDefinition&&a.put("bCBOptimize",this.bCBOptimize);a.put("pyColumnName",this.filteredColName);
a.put("columnIndex",this.filteredColIndex);a.put("pyClearFiltering",!0);this.bReportDefinition&&this.dynamicColumnIndex&&a.put("dynamicColumnIndex",this.dynamicColumnIndex);null!=this.gridDiv.getAttribute("bRangeFilterByFormat")&&a.put("bRangeFilterByFormat",this.gridDiv.getAttribute("bRangeFilterByFormat"));this.isClearGridFiltering()&&a.put("pzClearGridFiltering",!0);var b=new SafeURL;this.categorizeBy&&b.put("categorizeBy",this.categorizeBy);this.reloadGridLayout("pzdoGridAction",a.toQueryString(),
null,null,this.gridDiv,null,!0,b)}},isClearGridFiltering:function(){var a=f.getElementsByClassName("filtered","button",this.rightBodyTbl.rows[0]);return a&&1==a.length?!0:!1},submitFilterCriteria:function(a,b,c,d){delete this.isFilterPOOpen;l.fromFilterPopover=null;b=c.popOverElement;b.removeAttribute("role");b.removeAttribute("aria-labelledby");pega.ctx.Grid.isFilterMenuItemClicked=!1;if(!a||"CANCEL"!=a.toUpperCase()&&"CLICKAWAY"!=a.toUpperCase()&&"CLEARFILTER"!=a.toUpperCase())d=l.getQueryString(b),
this.categorizeBy&&d.put("categorizeBy",this.categorizeBy),a=this.prepareFitleringRequest(),this.reloadGridLayout("pzdoGridAction",a.toQueryString(),null,null,this.gridDiv,null,!0,d);else if(this.resetInCall(),Grids.reFocusPrevFocussedElem(this),this.filteredColName="",""!=gridSortFieldName&&"CLEARFILTER"!=a.toUpperCase()||!this.bFilteredGrid){a=pega.ctx.dom.getElementsByTagName("th");if(""!=d)for(b=0;b<a.length;b++)a[b].hasAttribute("sortfield")&&a[b].getAttribute("sortfield")==d&&a[b].focus();gridSortFieldName=
""}},prepareFitleringRequest:function(){var a=new SafeURL;a.put("gridAction","FILTER");a.put("gridActivity","pzGridSortPaginate");a.put("pyGridFilterCriteriaPage",this.gridFilterPage);this.pyPaginateActivity&&(a.put("pyPaginateActivity",this.pyPaginateActivity),this.pySortHandled&&a.put("pySortHandled",this.pySortHandled),this.pyFilterHandled&&a.put("pyFilterHandled",this.pyFilterHandled));a.put("PageListProperty",this.getPLPGProperty());null!=this.dynamicColumnIndex&&a.put("dynamicColumnIndex",this.dynamicColumnIndex);
a.put("ClassName",this.propertyClass);this.bReportDefinition&&(a.put("RDName",this.RDName),a.put("RDAppliesToClass",this.RDAppliesToClass),a.put("pgRepContPage",this.RDContPage),this.bLoadActivity&&a.put("bLoadActivity",this.bLoadActivity),this.RDPageName&&a.put("pyReportPageName",this.RDPageName),a.put("RDParamsList",this.RDParams),a.put("gridLayoutID",this.gridLayoutID),"Progressive Load"==this.pageMode&&(a.put("pyPageMode",this.pageMode),a.put("bCBOptimize",this.bCBOptimize)));a.put("BaseReference",
this.baseRef);this.bSortable&&(a.put("sortProperty",this.sortProperty),a.put("sortType",this.sortType));this.rangeSize&&a.put("pyPageSize",this.rangeSize);this.returnResultCount&&a.put("pyReturnResultCount",this.returnResultCount);this.pageMode&&a.put("pyPageMode",this.pageMode);a.put("isReportDef",this.bReportDefinition);this.gridPreActivity&&a.put("gridPreActivity",this.gridPreActivity);this.gridPostActivity&&a.put("gridPostActivity",this.gridPostActivity);return a},renderContextMenu:function(a,
b,c,d,e,g,f){if(g)e=e||{},b.usingPage&&""!=b.usingPage?e.pzPrimaryPageName=b.usingPage:this.getEntryHandle()&&(e.pzPrimaryPageName=this.getEntryHandle()),pega.control.menu.showContextMenu(e,b.relativeElement,f);else{var h=pega.tools.XMLDocument.get();this.resetExecutionThread();e=SafeURL_createFromURL(pega.ctx.url);e.put("pyActivity","pxMenuBarTranslator");e.put("Name",c);e.put("Class",d);e.put("Page",a);e.put("Refresh",!0);e.put("RemovePage",!1);e.put("gridAction","true");b.usingPage&&""!=b.usingPage?
e.put("pzPrimaryPageName",b.usingPage):this.getEntryHandle()&&e.put("pzPrimaryPageName",this.getEntryHandle());var k=this;pega.u.d.asyncRequest("POST",e,{success:function(c){h.loadXML(c.responseText);c=k.contextMenuObjs[a];var d;c||(c=new pega.ui.menubar.Manager,c.setAlignment("horizontal"),c.registerCallback(null,k),k.contextMenuObjs[a]=c);d=pega.util.Dom.selectSingleNode(h,"//pagedata");var e=d.childNodes,g=e.length;if(!pega.env.ua.ie)for(var f=g=0;f<e.length;f++)3!=e[f].nodeType&&g++;if(e=pega.util.Dom.selectSingleNode(h,
"//Menu"))e=e.childNodes.length,1==g&&0<e&&(d=pega.util.Dom.selectSingleNode(h,"//Menu"));g=d.cloneNode(!0);k.closeContextMenus(a);pega.env.ua.webkit?c.doContextMenu(d,b):c.doContextMenu(g,b);c.active=!0},failure:function(a){alert("AJAX call failed");k.resetInCall()}})}},getUpdatedXMLRootNode:function(a,b,c,d){var e=pega.tools.XMLDocument.get(),g=SafeURL_createFromURL(pega.ctx.url);g.put("pyActivity","pxMenuBarTranslator");g.put("Name",c);g.put("Class",d);g.put("Page",a);g.put("Refresh",!0);g.put("RemovePage",
!1);var f=this;pega.u.d.asyncRequest("POST",g,{success:function(c){e.loadXML(c.responseText);var d;c=new pega.ui.menubar.Manager;c.setAlignment("horizontal");c.registerCallback(null,this);d=pega.util.Dom.selectSingleNode(e,"//pagedata");var g=d.childNodes,h=g.length;if(!pega.env.ua.ie)for(var m=h=0;m<g.length;m++)3!=g[m].nodeType&&h++;if(g=pega.util.Dom.selectSingleNode(e,"//Menu"))g=g.childNodes.length,1==h&&0<g&&(d=pega.util.Dom.selectSingleNode(e,"//Menu"));f.contextMenuObjs[a]=c;f.menuRootNodes[a]=
d;h=d.cloneNode(!0);f.closeContextMenus(a);pega.env.ua.webkit?c.doContextMenu(d,{x:b.x,y:b.y}):c.doContextMenu(h,{x:b.x,y:b.y});c.active=!0},failure:function(a){alert("AJAX call failed");f.resetInCall()}})},closeContextMenus:function(a){var b=window.Grids.getAllGrids(),c;for(c in b){var d=b[c].contextMenuObjs;if(d)for(var e in d)b[c]==this?a!=e&&d[e]._hideAll():d[e]._hideAll()}},synchHeadersForPercent:function(){this.bResponsiveGrid&&this.isInFatList()||(!this.bTree&&this.bTreegrid&&this.fixedRow&&
this.leftHeaderDiv&&this.leftBodyDiv&&1==f.hasClass(this.gridcontDiv,"gPercent")&&(this.leftBodyDiv.style.width=this.leftHeaderDiv.offsetWidth+"px"),this.setHeadersWidth())},adjustLayoutWrapperWidth:function(){if(!(this.bResponsiveGrid&&this.isInFatList()||this.fixedCol||!this.fixedRow||""!=this.layoutWrapperDiv.style.width&&"true"!=this.layoutWrapperDiv.getAttribute("noWidth")||0!=f.hasClass(this.gridcontDiv,"gPercent"))){var a=0,b=0;this.layoutWrapperDiv.scrollHeight>this.layoutWrapperDiv.clientHeight&&
(0!=this.layoutWrapperDiv.clientHeight||pega.util.Event.isIE)&&(a=this.getScrollbarWidth());this.layoutWrapperDiv.getAttribute("noHeight")&&"Progressive Load"!=this.pageMode||(b=2);f.getFirstChild(this.layoutWrapperDiv)&&f.getFirstChild(this.layoutWrapperDiv).offsetWidth&&(this.layoutWrapperDiv.style.width=f.getFirstChild(this.layoutWrapperDiv).offsetWidth+a+b+"px")}},initScrollbars:function(){if(!this.bResponsiveGrid||!this.isInFatList())if(!this.fixedCol&&this.fixedRow){f.getElementsById("gridLayoutTable",
this.gridDiv)[0].style.borderWidth=0;this.adjustLayoutWrapperWidth();if(this.rightHeaderDiv)var a=f.getFirstChild(this.rightHeaderDiv);if(!this.scrollHeadAdded&&this.layoutWrapperDiv.scrollHeight>this.layoutWrapperDiv.clientHeight&&0!=this.layoutWrapperDiv.clientHeight&&a&&a.rows&&"none"!=a.rows[0].style.display){if(!("Progressive Load"==this.pageMode&&this.totalRecords<=this.rangeSize)){var b=document.createElement("th");b.style.width=this.getScrollbarWidth()+"px";f.addClass(b,"cellCont");f.addClass(b,
"scrollHead");b.innerHTML="\x26nbsp;";b.style.padding=0;0==f.hasClass(this.gridcontDiv,"gPercent")?(a=a.rows[0],a.appendChild(b),this.scrollHeadAdded=!0,this.rightHeaderTbl.style.width=parseInt(this.rightHeaderTbl.style.width)+b.offsetWidth+"px"):(this.bTree&&this.fixedRow?(a=this.leftHeaderTbl.rows[0],a.appendChild(b)):(this.bTreegrid&&this.rightHeaderTbl&&(this.layoutWrapperDiv.style.overflowY="scroll",this.rightHeaderDiv.style.height=this.rightHeaderTbl.offsetHeight+"px",this.rightHeaderDiv.style.overflow=
"hidden"),f.getFirstChild(this.rightHeaderDiv).rows[0].appendChild(b)),this.scrollHeadAdded=!0);1==parseInt(b.style.width)&&(b.style.border="0 none");if(0==f.hasClass(this.gridcontDiv,"gPercent")&&-1!=navigator.userAgent.indexOf("MSIE")&&"CSS1Compat"===document.compatMode&&!this.bPXFixed&&!this.fixedRow)try{0<this.layoutWrapperDiv.offsetWidth&&(this.rightHeaderDiv.style.width=this.layoutWrapperDiv.offsetWidth-2+"px")}catch(h){}}pega.env.ua.webkit&&!this.bTreegrid&&b&&0<b.length&&(b=b[0],b.style.width=
parseInt(b.style.width)+1+"px",b.style.minWidth=b.style.width)}this.bFixedHeight=""!=this.layoutWrapperDiv.style.height;""!=this.layoutWrapperDiv.style.width&&"true"!=this.layoutWrapperDiv.getAttribute("noWidth")&&k.addListener(this.layoutWrapperDiv,"scroll",this.synchScrollHeader,this,!0);(b=pega.util.Dom.getElementsById("gridHeaderDiv",this.gridcontDiv))&&""!=b[0].style.width&&k.addListener(b,"scroll",this.synchScrollHeader,this,!0);k.isIE&&""!=this.layoutWrapperDiv.style.width&&"true"!=this.layoutWrapperDiv.getAttribute("noWidth")&&
!this.layoutWrapperDiv.getAttribute("divheight")&&((b=this.layoutWrapperDiv.offsetHeight)||""!=this.layoutWrapperDiv.style.height&&(b=parseInt(this.layoutWrapperDiv.style.height.replace("px",""))),b&&(b+=this.getScrollbarWidth(),this.layoutWrapperDiv.style.height=b.toString()+"px",this.layoutWrapperDiv.setAttribute("divheight",b)))}else{this.fixedCol||this.fixedRow||f.hasClass(this.gridcontDiv,"gPercent")||(this.bFixedWidth=""!=this.gridcontDiv.style.width,this.bFixedHeight=""!=this.gridcontDiv.style.height,
this.bFixedWidth&&k.isIE&&!pega.u.d.inStandardsMode&&(b=this.gridcontDiv.offsetHeight,0!=b&&(this.gridcontDiv.style.height=b+this.getScrollbarWidth()+"px")),!this.bFixedHeight)||((b=this.gridcontDiv.offsetWidth,pega.u.d.inStandardsMode)?0!=b&&(this.gridcontDiv.style.width=pega.util.Event.isIE?b+"px":b+this.getScrollbarWidth()+"px"):0!=b&&(this.gridcontDiv.style.width=!pega.util.Event.isIE||pega.util.Event.isIE&&8>pega.env.ua.ie?b+this.getScrollbarWidth()+"px":b+"px"));if((this.fixedCol||this.fixedRow)&&
(""!=this.rightBodyDiv.style.width||""!=this.gridcontDiv.style.width))if(this.hScrollDiv)this.setHScrollDim();else{var b=document.createElement("DIV"),a=document.createElement("DIV"),c=document.createElement("DIV");c.style.height="20px";b.appendChild(a);this.fixedCol&&!this.fixedRow&&""!=this.gridcontDiv.style.height?(c.style.clear="left",pega.util.Dom.insertAfter(c,this.gridcontDiv)):this.gridcontDiv.appendChild(c);this.gridDiv.appendChild(b);b.id="hScrollDiv";b.style.height=this.getScrollbarWidth()+
"px";a.innerHTML="\x26nbsp;";this.hScrollDiv=b;this.hScrollCont=a;this.setHScrollDim();if("0px"==b.style.width){var d=this,e=function(){d.setHScrollDim();"0px"!=d.hScrollDiv.style.width&&setTimeout(function(){pega.u.d.unregisterResize(e)},10)};pega.u.d.registerResize(e)}k.addListener(this.hScrollDiv,"scroll",this.synchScrollH,this,!0);b=""!=this.rightBodyDiv.style.width?this.rightBodyDiv:this.gridcontDiv;k.addListener(b,"scroll",this.synchScrollH,this,!0);this.rightHeaderDiv&&k.addListener(this.rightHeaderDiv,
"scroll",this.synchScrollH,this,!0)}if((this.fixedCol||this.fixedRow)&&(""!=this.rightBodyDiv.style.height||""!=this.gridcontDiv.style.height))if(this.vScrollDiv)this.setVScrollDim();else{b=document.createElement("DIV");a=document.createElement("DIV");a.id="vScrollCont";b.appendChild(a);this.gridDiv.appendChild(b);b.id="vScrollDiv";b.style.width=this.getScrollbarWidth()+"px";a.innerHTML="\x26nbsp;";a.style.width=this.getScrollbarWidth()+"px";this.vScrollDiv=b;this.vScrollCont=a;this.setVScrollDim();
if("0px"==b.style.height){var d=this,g=function(){d.setVScrollDim();"0px"!=d.vScrollDiv.style.height&&setTimeout(function(){pega.u.d.unregisterResize(g)},10)};pega.u.d.registerResize(g)}k.addListener(this.vScrollDiv,"scroll",this.synchScrollV,this,!0);b=""!=this.rightBodyDiv.style.height?this.rightBodyDiv:this.gridcontDiv;k.addListener(b,"scroll",this.synchScrollV,this,!0);this.leftBodyDiv&&k.addListener(this.leftBodyDiv,"scroll",this.synchScrollV,this,!0)}this.leftBodyDiv&&k.addListener(this.leftBodyDiv,
"scroll",function(){this.leftBodyDiv.scrollLeft=0},this,!0)}},bringToView:function(a){var b=k.getTarget(a);if(a=this.findCell(a,this.rightBodyDiv,b))"LI"==a.tagName?this.hScrollDiv.scrollLeft=0:this.hScrollDiv&&(this.hScrollDiv.scrollLeft=this.leftBodyDiv.offsetWidth+a.offsetLeft+a.offsetWidth)},createFrame:function(){var a=this,b=document.body;if(b&&b.firstChild){var c=document.getElementById("yui_ddproxy");if(!c){c=document.createElement("div");c.id="yui_ddproxy";var d=c.style;d.position="absolute";
d.visibility="hidden";d.display="none";d.cursor="move";d.border="2px solid #aaa";d.zIndex=999;d.height="25px";d.width="25px";d=document.createElement("div");f.setStyle(d,"height","100%");f.setStyle(d,"width","100%");f.setStyle(d,"background-color","#ccc");f.setStyle(d,"opacity","0");c.appendChild(d);pega.env.ua.ie&&(d=document.createElement("iframe"),d.setAttribute("src","blank.html"),d.setAttribute("scrolling","no"),d.setAttribute("frameborder","0"),c.insertBefore(d,c.firstChild),f.setStyle(d,"height",
"100%"),f.setStyle(d,"width","100%"),f.setStyle(d,"position","absolute"),f.setStyle(d,"top","0"),f.setStyle(d,"left","0"),f.setStyle(d,"opacity","0"),f.setStyle(d,"zIndex","-1"),f.setStyle(d.nextSibling,"zIndex","2"));b.insertBefore(c,b.firstChild)}}else setTimeout(function(){a.createFrame()},50)},synchScrollsWithModal:function(){var a=this.getActiveRowIndex();if(this.bFilteredGrid){var b=pega.util.Dom.getElementsById(pega.ui.property.toHandle(this.propRef),this.rightBodyTbl,"TR");if(b)var c=b[0].rowIndex}b=
"NEXT"===this.getModalAction()||c&&1===a-c||"JUMP"===this.getModalAction()&&a==this.getLastRowIndex();c="PREV"===this.getModalAction()||c&&-1===a-c||"JUMP"===this.getModalAction()&&a==this.getFirstLoadedRowIndex();a&&this.rightBodyTbl&&((a=this.rightBodyTbl.rows[this.getIndex(a)])?this.vScrollDiv?b?this.vScrollDiv.scrollTop+=a.offsetHeight:c&&(this.vScrollDiv.scrollTop-=a.offsetHeight):this.bFixedHeight&&(this.fixedRow?b?this.layoutWrapperDiv.scrollTop+=a.offsetHeight:c&&(this.layoutWrapperDiv.scrollTop-=
a.offsetHeight):b?this.gridcontDiv.scrollTop+=a.offsetHeight:c&&(this.gridcontDiv.scrollTop-=a.offsetHeight)):this.bDiscardInvisibleRows&&(b?this.layoutWrapperDiv.scrollTop+=this.rowHeight:c&&(this.layoutWrapperDiv.scrollTop-=this.rowHeight)))},synchScrollH:function(a){if(pega.env.ua.webkit&&525.28>=pega.env.ua.webkit){if(window.scrollVEle||window.scrollHEle)return;var b=k.getTarget(a);window.scrollHEle=b;setTimeout(function(){window.scrollHEle=null},0)}b=k.getTarget(a);pega.env.ua.gecko&&1.9>pega.env.ua.gecko&&
!this.fixedCol&&(this.rightBodyDiv.style.width="auto");a=[""!=this.rightBodyDiv.style.width?this.rightBodyDiv:this.gridcontDiv,this.rightHeaderDiv,this.hScrollDiv];for(var c=0;c<a.length;c++)a[c]&&b!=a[c]&&(a[c].scrollLeft=b.scrollLeft)},synchScrollHeader:function(a){var b=k.getTarget(a);"gridHeaderDiv"==a.target.id?this.layoutWrapperDiv.scrollLeft=a.target.scrollLeft:pega.util.Dom.getElementsById("gridHeaderDiv",this.gridcontDiv)[0].scrollLeft=b.scrollLeft},synchScrollV:function(a){if(pega.env.ua.webkit&&
525.28>=pega.env.ua.webkit){if(window.scrollVEle||window.scrollHEle)return;var b=k.getTarget(a);window.scrollVEle=b;setTimeout(function(){window.scrollVEle=null},0)}b=k.getTarget(a);a=[""!=this.rightBodyDiv.style.height?this.rightBodyDiv:this.gridcontDiv,this.leftBodyDiv,this.vScrollDiv];for(var c=0;c<a.length;c++)a[c]&&b!=a[c]&&(a[c].scrollTop=b.scrollTop)},setHScrollDim:function(){this.gridTbl=pega.util.Dom.getElementsById("gridLayoutTable",this.gridcontDiv)[0];this.hScrollDiv.style.width=""!=this.gridcontDiv.style.width?
this.gridcontDiv.offsetWidth+"px":this.gridTbl.offsetWidth+"px";var a=this.rightBodyDiv.scrollWidth;if(this.leftBodyDiv)if(this.leftBodyDiv.offsetWidth)a+=this.leftBodyDiv.offsetWidth;else{var b=this.leftBodyDiv.style.width.split("px")[0];b&&parseInt(b)&&(a+=parseInt(b))}this.hScrollCont.style.width=a+"px";this.hScrollDiv.style.top=this.fixedCol&&!this.fixedRow&&""!=this.gridcontDiv.style.height?this.gridcontDiv.offsetTop+this.gridcontDiv.offsetHeight+"px":this.gridcontDiv.offsetTop+this.gridcontDiv.offsetHeight-
20+"px";this.hScrollDiv.style.left="0px";this.hScrollDiv.style.overflowX=this.hScrollDiv.scrollWidth>this.hScrollDiv.offsetWidth?"scroll":"auto"},setVScrollDim:function(){this.gridTbl=pega.util.Dom.getElementsById("gridLayoutTable",this.gridcontDiv)[0];this.vScrollDiv.style.height=""!=this.gridcontDiv.style.height?this.gridcontDiv.offsetHeight+"px":this.gridTbl.offsetHeight+"px";var a=this.bTreegrid?this.leftBodyUL.scrollHeight:this.rightBodyDiv.scrollHeight;this.rightHeaderDiv&&(a+=this.rightHeaderDiv.offsetHeight);
"harness"!=this.editConfig||this.pyTargetSection||(a+=this.gridDetailsDiv.offsetHeight);this.vScrollCont.style.height=a+"px";this.vScrollDiv.style.top=this.gridcontDiv.offsetTop+"px";this.vScrollDiv.style.left=""!=this.gridcontDiv.style.width?this.gridcontDiv.offsetWidth+"px":this.gridTbl.offsetWidth+"px";this.vScrollDiv.style.overflowY=this.vScrollDiv.scrollHeight>this.vScrollDiv.offsetHeight?"scroll":"auto"},gridResized:function(a){if(this.fixedCol)""==this.rightBodyDiv.style.width&&""==this.gridcontDiv.style.width||
this.setHScrollDim(),""==this.rightBodyDiv.style.height&&""==this.gridcontDiv.style.height||this.setVScrollDim();else{var b=f.getElementsById("gridLayoutTable",this.gridcontDiv);b&&0<b.length&&(this.gridTbl=b[0]);if(this.bFixedHeight&&""==this.gridcontDiv.style.width&&!f.hasClass(this.gridcontDiv,"gPercent")&&0<this.gridTbl.offsetWidth){b=this.gridTbl.offsetWidth+this.getScrollbarWidth();if(this.bPXFixed&&(this.bTree||this.bTreegrid)&&this.layoutWrapperDiv&&this.layoutWrapperDiv.style.width){var c=
parseInt(this.layoutWrapperDiv.style.width,10);b<c&&(b=c)}this.bResponsiveGrid&&this.isInFatList()||"Progressive Load"==this.pageMode||(this.gridcontDiv.style.width=b+"px")}else this.bFixedWidth&&!this.bFixedHeight&&(this.gridcontDiv.style.height=this.gridTbl.offsetHeight+this.getScrollbarWidth()+"px")}this.bTreegrid&&!pega.u.d.DISABLE_TREEGRID_HEIGHT_ADJUSTMENT&&this.updateTreeGridRowHeight();l.resizeHarness();a&&this.synchScrollsWithModal()},getScrollbarWidth:function(){if(!pega.ui.scrollBarWidth){var a=
document.createElement("div");a.style.visibility="hidden";a.style.width="100px";a.style.height="100px";a.style.overflow="scroll";document.body.appendChild(a);pega.ui.scrollBarWidth=a.offsetWidth-a.clientWidth+1;document.body.removeChild(a);if(1==pega.ui.scrollBarWidth){var a=document.body,b=a.style.overflow,c=a.clientWidth;a.style.overflow="scroll";(c-=a.clientWidth)||(c=a.offsetWidth-a.clientWidth);a.style.overflow=b;pega.ui.scrollBarWidth=c+1}}return pega.ui.scrollBarWidth},createResizables:function(){if(1==
this.bGrid){var a=!1,b=!1;this.leftHeaderTbl?(b="true"==this.rightBodyTbl.getAttribute("bColumnResize"),this.bTreegrid||(a="true"==this.rightBodyTbl.getAttribute("bRowResize"))):this.leftBodyUL?(a="true"==this.leftBodyUL.getAttribute("bRowResize"),b="true"==this.rightBodyTbl.getAttribute("bColumnResize")):this.rightHeaderTbl||(a="true"==this.rightBodyTbl.getAttribute("bRowResize"),b="true"==this.rightBodyTbl.getAttribute("bColumnResize"));this.bRowResize=a;(0==f.hasClass(this.gridcontDiv,"gPercent")&&
0==f.hasClass(this.gridcontDiv,"gPXAuto")||this.bTreegrid)&&a&&this.createRowResize();b&&this.createColumnResize()}},createRowResize:function(){this.repeatType==this.COL_REPEAT?this.leftHeaderTbl?(k.addListener(this.leftHeaderTbl,"mouseover",this.intRowResize,this.leftHeaderTbl,this),k.addListener(this.leftBodyUL,"mouseover",this.intRowResize,this.leftBodyUL,this)):(this.rightHeaderTbl&&k.addListener(this.rightHeaderTbl,"mouseover",this.intRowResize,this.rightHeaderTbl,this),k.addListener(this.rightBodyTbl,
"mouseover",this.intRowResize,this.rightBodyTbl,this)):this.fixedCol||this.bTreegrid?(this.leftHeaderTbl&&k.addListener(this.leftHeaderTbl,"mouseover",this.intRowResize,this.leftHeaderTbl,this),k.addListener(this.leftBodyUL,"mouseover",this.intRowResize,this.leftBodyUL,this)):(this.rightHeaderTbl&&k.addListener(this.rightHeaderTbl,"mouseover",this.intRowResize,this.rightHeaderTbl,this),k.addListener(this.rightBodyTbl,"mouseover",this.intRowResize,this.rightBodyTbl,this))},intRowResize:function(a,
b){if(a=this.findCell(a,b)){var c;if(this.bTreegrid&&f.isAncestor(this.leftBodyUL,a))c=a=a.parentNode;else{if(!f.hasClass(a,"rowResize"))return;c=f.getFirstChild(a);if(!c)return}0==this.getCellIndex(a)&&("true"!=c.getAttribute("resizable")||"true"==c.getAttribute("resizable")&&"col"==c.getAttribute("resizeType"))&&(c.setAttribute("resizable","true"),"col"==c.getAttribute("resizeType")?c.setAttribute("resizeType","both"):c.setAttribute("resizeType","row"),this.attachRowResize(c,b))}},attachRowResize:function(a,
b){pega.env.ua.ie&&"UL"!=a.tagName&&(a=a.parentNode);"LI"==a.parentNode.tagName&&"UL"!=a.tagName&&(a=a.parentNode);(new pega.util.Resize(a,{hover:!1,handles:["b"],minHeight:6,hiddenHandles:!0,setSize:!1})).on("resize",this.doRowResize,[a,this,b])},doRowResize:function(a,b){var c=b[1];b=b[0];var d=a.height;pega.env.ua.ie||"TD"!=b.tagName&&"TH"!=b.tagName||(b=f.getFirstChild(b));if(c.rightBodyTbl){var e=c.rightBodyTbl.rows[c.getRowIndex(f.getFirstChild(b))].cells[1];e&&(e=e.getElementsByTagName("nobr"));
e&&0<e.length&&a.height<e[0].offsetHeight+2&&(a.height=e[0].offsetHeight+2,d=a.height)}a.target&&(c.activeResize=a.target);a.type||(b.style.height=d+"px");if(!c.bTreegrid&&!c.fixedCol&&pega.env.ua.ie){if(f.getFirstChild(b)&&(e=c.getRowIndex(f.getFirstChild(b)),c.rightBodyTbl&&!c.fixedRow))for(var g=0;g<c.rightBodyTbl.rows[e].cells.length;g++)c.rightBodyTbl.rows[e].cells[g].style.height=a.height+"px"}else if(c.rightBodyTbl&&f.isAncestor(c.rightBodyTbl,b))for(b.parentNode.style.height=d+"px",g=0;g<
b.parentNode.parentNode.cells.length;g++)b.parentNode.parentNode.cells[g].style.height=d+"px",pega.env.ua.gecko&&(b.parentNode.parentNode.cells[g].style.lineHeight=d+"px"),pega.env.ua.webkit&&(f.getFirstChild(b.parentNode.parentNode.cells[g]).style.maxHeight=d+"px");else if(c.rightHeaderTbl&&f.isAncestor(c.rightHeaderTbl,b)){if(!pega.env.ua.ie)for(b.parentNode.style.height=d+"px",g=0;g<b.parentNode.parentNode.cells.length;g++)b.parentNode.parentNode.cells[g].style.height=d+"px",pega.env.ua.webkit&&
(f.getFirstChild(b.parentNode.parentNode.cells[g]).style.height=d+"px")}else if(c.leftHeaderTbl&&f.isAncestor(c.leftHeaderTbl,b)){if(pega.env.ua.ie)for(g=0;g<b.parentNode.cells.length;g++)b.parentNode.cells[g].style.height=d+"px";else for(b.parentNode.style.height=d+"px",g=0;g<b.parentNode.parentNode.cells.length;g++)b.parentNode.parentNode.cells[g].style.height=d+"px",pega.env.ua.webkit&&(f.getFirstChild(b.parentNode.parentNode.cells[g]).style.height=d+"px");if(c.rightHeaderTbl)for(g=0;g<c.rightHeaderTbl.rows[0].cells.length;g++)c.rightHeaderTbl.rows[0].cells[g].style.height=
d+"px",pega.env.ua.webkit&&(f.getFirstChild(c.rightHeaderTbl.rows[0].cells[g]).style.height=d+"px")}else if(c.leftBodyUL&&f.isAncestor(c.leftBodyUL,b)){if("LI"==b.tagName&&(b.parentNode.style.height=d+"px",pega.env.ua.ie||(f.getFirstChild(b).style.height=d+"px",f.hasClass(b,"headerCell")&&(f.getFirstChild(f.getFirstChild(b)).style.height=d+"px")),f.getNextSibling(b)&&"LI"==f.getNextSibling(b).tagName&&(f.getNextSibling(b).style.height=d+"px",pega.env.ua.ie||(f.getFirstChild(f.getNextSibling(b)).style.height=
d+"px",f.hasClass(b,"headerCell")&&(f.getFirstChild(f.getFirstChild(f.getNextSibling(b))).style.height=d+"px"))),c.rightBodyTbl)){e=c.getRowIndex(b);for(g=0;g<c.rightBodyTbl.rows[e].cells.length;g++)c.rightBodyTbl.rows[e].cells[g].style.height=a.height+"px",pega.env.ua.webkit&&(f.getFirstChild(c.rightBodyTbl.rows[e].cells[g]).style.maxHeight=d+"px");if(!pega.env.ua.ie&&c.rightBodyTbl.rows[e].cells[0]&&c.rightBodyTbl.rows[e].cells[0].offsetHeight>b.offsetHeight)for(g=0;g<c.rightBodyTbl.rows[e].cells.length;g++)c.rightBodyTbl.rows[e].cells[g].style.height=
a.height-(c.rightBodyTbl.rows[e].cells[0].offsetHeight-b.offsetHeight)+"px",pega.env.ua.webkit&&(f.getFirstChild(c.rightBodyTbl.rows[e].cells[g]).style.maxHeight=a.height-(c.rightBodyTbl.rows[e].cells[0].offsetHeight-b.offsetHeight)+"px");e=c.rightBodyTbl.rows[e].offsetHeight;g=b.parentNode.offsetHeight;if(e>g||c.bTreegrid&&!c.bTree)pega.env.ua.ie&&c.bTreegrid&&!c.bTree&&(b.style.height=e+"px"),b.parentNode.style.height=e+"px",f.getNextSibling(b)&&"LI"==f.getNextSibling(b).tagName&&(f.getNextSibling(b).style.height=
e+"px")}if("UL"==b.tagName&&(f.getFirstChild(b).style.height=d+"px",pega.env.ua.ie||(f.getFirstChild(f.getFirstChild(b)).style.height=d+"px",f.hasClass(b,"headerRowContent")&&(f.getFirstChild(f.getFirstChild(f.getFirstChild(b))).style.height=d+"px")),f.getNextSibling(f.getFirstChild(b)).style.height=d+"px",pega.env.ua.ie||(f.getFirstChild(f.getNextSibling(f.getFirstChild(b))).style.height=d+"px",f.hasClass(b,"headerRowContent")&&(f.getFirstChild(f.getFirstChild(f.getNextSibling(f.getFirstChild(b)))).style.height=
d+"px")),c.rightBodyTbl)){e=c.getRowIndex(f.getFirstChild(b));for(g=0;g<c.rightBodyTbl.rows[e].cells.length;g++)c.rightBodyTbl.rows[e].cells[g].style.height=a.height+"px",pega.env.ua.ie&&(c.rightBodyTbl.rows[e].cells[g].style.lineHeight=a.height+"px"),pega.env.ua.webkit&&(f.getFirstChild(c.rightBodyTbl.rows[e].cells[g]).style.maxHeight=a.height+"px");if(!pega.env.ua.ie&&c.rightBodyTbl.rows[e].cells[0].offsetHeight>b.offsetHeight)for(g=0;g<c.rightBodyTbl.rows[e].cells.length;g++)c.rightBodyTbl.rows[e].cells[g].style.height=
a.height-(c.rightBodyTbl.rows[e].cells[0].offsetHeight-b.offsetHeight)+"px",pega.env.ua.webkit&&(f.getFirstChild(c.rightBodyTbl.rows[e].cells[g]).style.maxHeight=a.height-(c.rightBodyTbl.rows[e].cells[0].offsetHeight-b.offsetHeight)+"px");e=c.rightBodyTbl.rows[e].offsetHeight;g=f.getFirstChild(b).offsetHeight;if(e>g||c.bTreegrid&&!c.bTree)pega.env.ua.ie&&c.bTreegrid&&!c.bTree&&(b.style.height=e+"px"),f.getFirstChild(b).style.height=e+"px",f.getNextSibling(f.getFirstChild(b)).style.height=e+"px"}}c.gridResized()},
createColumnResize:function(){this.repeatType==this.ROW_REPEAT?this.leftHeaderTbl?(k.addListener(this.leftHeaderTbl,"mouseover",this.intColResize,[this,this.leftHeaderTbl]),this.rightHeaderTbl&&k.addListener(this.rightHeaderTbl,"mouseover",this.intColResize,[this,this.rightHeaderTbl])):((this.bTreegrid||this.fixedCol)&&k.addListener(this.leftBodyUL,"mouseover",this.intColResize,[this,this.leftBodyUL]),k.addListener(this.rightBodyTbl,"mouseover",this.intColResize,[this,this.rightBodyTbl])):(this.leftHeaderTbl&&
k.addListener(this.leftHeaderTbl,"mouseover",this.intColResize,[this,this.leftHeaderTbl]),this.rightHeaderTbl&&k.addListener(this.rightHeaderTbl,"mouseover",this.intColResize,[this,this.rightHeaderTbl]))},intColResize:function(a,b){var c=b[0];b=b[1];if((a=c.findCell(a,b))&&f.hasClass(a,"colResize")){var d=f.getFirstChild(a);!d||(c.bDragDrop||c.bNumberedSkin)&&("number"==typeof a.cellIndex&&0==a.cellIndex&&c.leftHeaderTbl&&f.isAncestor(c.leftHeaderTbl,a)||0==c.getCellIndex(a)&&"TD"!=a.tagName&&"TH"!=
a.tagName)||(0==c.getRowIndex(a)&&("true"!=d.getAttribute("resizable")||"true"==d.getAttribute("resizable")&&"row"==d.getAttribute("resizeType"))&&(d.setAttribute("resizable","true"),"row"==d.getAttribute("resizeType")?d.setAttribute("resizeType","both"):d.setAttribute("resizeType","col"),c.attachColResize(d,b)),c.leftHeaderTbl&&b==c.leftHeaderTbl&&""==c.leftHeaderTbl.rows[0].cells[0].style.width&&(b=c.leftHeaderTbl.rows[0].cells[0].offsetWidth,c.leftHeaderTbl.rows[0].cells[0].style.width=c.leftHeaderTbl.rows[0].cells[0].offsetWidth+
"px",c.leftHeaderTbl.rows[0].cells[0].offsetWidth>b&&(c.leftHeaderTbl.rows[0].cells[0].style.width=c.leftHeaderTbl.rows[0].cells[0].offsetWidth-(c.leftHeaderTbl.rows[0].cells[0].offsetWidth-b)+"px"),0==parseInt(c.leftHeaderTbl.rows[0].cells[0].style.width)&&f.addClass(c.leftHeaderTbl.rows[0].cells[0],"hiddenCell")))}},attachColResize:function(a,b){pega.env.ua.ie&&"UL"!=a.tagName&&(a=a.parentNode);"LI"==a.parentNode.tagName&&"UL"!=a.tagName&&(a=a.parentNode);var c=new pega.util.Resize(a,{hover:!1,
hiddenHandles:!0,handles:["r"],minWidth:40,setSize:!1});c.on("resize",this.doColResize,[a,this,b]);c.on("endResize",this.saveColumnWidth,[a,this]);c.on("startResize",this.startColResize,[a,this,b])},saveColumnWidth:function(a,b){var c=b[1];b=b[0];var d=a.width;a=100*d/c.rightBodyTbl.offsetWidth;1==f.hasClass(c.gridcontDiv,"gPercent")&&(d=a,c.syncColwidthOnColResize());a=c.gridcontDiv.getAttribute("gPropIndex");if(c.leftBodyUL&&f.isAncestor(c.leftBodyUL,b)||c.leftHeaderTbl&&f.isAncestor(c.leftHeaderTbl,
b)){var e=pega.util.Dom.getElementsById(a+"colWidthGBL",c.gridcontDiv,"INPUT");e&&(e=e[0],1==f.hasClass(c.gridcontDiv,"gPercent")?e.value=parseInt(c.leftBodyDiv.offsetWidth):e.value=parseInt(c.leftBodyDiv.style.width));if(e=pega.util.Dom.getElementsById(a+"colWidthCache"+(c.bTreegrid&&c.fixedRow?2:1),c.gridcontDiv,"INPUT"))e=e[0],e.value=d}else{if(e=pega.util.Dom.getElementsById(a+"colWidthGBR",c.gridcontDiv,"INPUT"))e=e[0],1==f.hasClass(c.gridcontDiv,"gPercent")?e.value=parseInt(c.rightBodyTbl.offsetWidth):
e.value=parseInt(c.rightBodyTbl.style.width);if(e=pega.util.Dom.getElementsById(a+"colWidthCache"+(c.getCellIndex(pega.env.ua.ie?b:b.parentNode)+(c.bTreegrid?2:c.bDragDrop&&!c.fixedCol?0:1)),c.gridcontDiv,"INPUT"))e=e[0],e.value=d;if(c.rightBodyTbl){e=c.rightBodyTbl.width;""==e&&(e=c.rightBodyTbl.style.width);var g=!1;e&&-1!=e.indexOf("%")&&(g=!0);if(g){b=c.getCellIndex(pega.env.ua.ie?b:b.parentNode);for(var g=c.rightBodyTbl.rows[0].cells.length,d=(100-d)/(g-2),h=1;h<g;h++)b!=h&&(e=pega.util.Dom.getElementsById(a+
"colWidthCache"+((c.bTreegrid?2:c.bDragDrop&&!c.fixedCol?0:1)+h),c.gridcontDiv,"INPUT"))&&(e=e[0],e.value=d)}}}c.setHeadersWidth();if(!c.fixedRow&&c.fixedCol&&1==f.hasClass(c.gridcontDiv,"gPXFixed"))for(a=c.rightBodyTbl.rows,d=f.getChildren(c.leftBodyUL),b=1;b<d.length;b++)e=a[b].cells[1].offsetHeight+"px",d[b].style.height=e,f.getFirstChild(d[b]).style.height=e,f.getFirstChild(f.getFirstChild(d[b])).style.height=e;c.gridResized()},syncColwidthOnColResize:function(){if(1==f.hasClass(this.gridcontDiv,
"gPercent")&&this.rightBodyTbl&&this.rightHeaderTbl){var a=[],b=0;if(this.bTreegrid||this.bNumberedSkin||this.bShowExpandCollapseColumn)b=1;for((this.bNumberedSkin||this.bDragDrop)&&this.bShowExpandCollapseColumn&&(b=2);b<this.rightHeaderTbl.rows[0].cells.length-1;b++){this.rightBodyTbl.rows[0].cells[b].firstChild.style.width="";this.rightHeaderTbl.rows[0].cells[b].firstChild.style.width="";var c=this.rightBodyTbl.rows[0].cells[b].offsetWidth,d=this.rightHeaderTbl.rows[0].cells[b].firstChild.offsetWidth;
c<d&&(c=d);a[b]=c}for(b=0;b<this.rightHeaderTbl.rows[0].cells.length-1;b++)c=100*a[b]/this.rightHeaderTbl.offsetWidth+"%",this.rightBodyTbl.rows[0].cells[b].style.width=c,this.rightHeaderTbl.rows[0].cells[b].style.width=c;this.scrollHeadAdded&&(this.rightHeaderTbl.rows[0].cells[this.rightHeaderTbl.rows[0].cells.length-1].style.width=this.getScrollbarWidth()+"px")}},isInFatList:function(){return this.bResponsiveGrid&&pega.u.d.inStandardsMode?"block"==(this.rightBodyTbl.currentStyle?this.rightBodyTbl.currentStyle.display:
window.getComputedStyle?window.getComputedStyle(this.rightBodyTbl,"")?window.getComputedStyle(this.rightBodyTbl,"").display:this.rightBodyTbl.style.display:this.rightBodyTbl.style.display):!1},isColumnsDropped:function(){if(1<this.rightBodyTbl.rows.length){var a=this.rightBodyTbl.rows[this.rightBodyTbl.rows.length-1].cells;if("Progressive Load"==this.pageMode&&!this.bDiscardInvisibleRows)for(var b=0;b<this.rightBodyTbl.rows.length;b++)if(this.rightBodyTbl.rows[b].hasAttribute("oaargs")){a=this.rightBodyTbl.rows[b].cells;
break}for(b=0;b<a.length;b++){var c=a[b];if("other"==c.getAttribute("data-importance")&&"none"==(c.currentStyle?c.currentStyle.display:window.getComputedStyle?window.getComputedStyle(c,"").display:c.style.display))return!0}}},callAPIsToAdjustGrid:function(){this.getCurrentMode()!=this.previousMode&&("normallist"==this.getCurrentMode()||"otherlist"==this.getCurrentMode()?(this.setRowHandleCellWidth(),this.initScrollbars(),this.updateExpandedDtlsHeight(),this.setCalculationsForProgressiveLoad(!0),this.autoAdjustProgressiveGridHeight(),
this.performWriteOperations(),this.setHeadersWidth(),this.gridResized()):"fatlist"==this.getCurrentMode()&&(this.setCalculationsForProgressiveLoad(!0),this.autoAdjustProgressiveGridHeight()),this.previousMode=this.getCurrentMode());if(this.editConfig==this.EDIT_EXPANDPANE){var a=this.expDetailsHeight;this.updateExpandedDtlsHeight();a!=this.expDetailsHeight&&0!=this.expDetailsHeight&&(this.updateExpandedDtlsHeight(),this.autoAdjustProgressiveGridHeight(),this.setHeadersWidth())}},setHeadersWidth:function(){if(!this.bResponsiveGrid||
!this.isInFatList()){if(this.fixedRow&&!this.fixedCol&&f.hasClass(this.gridcontDiv,"gPXAuto")&&this.rightHeaderDiv){var a=f.getFirstChild(this.rightHeaderDiv);if(!a)return;var b=a.rows;if(!b)return;var c=b[0];if(!c)return;pega.env.ua.webkit&&(a.style.width="auto");b=c.cells;if(!b)return;var d=this.rightBodyTbl.rows;if((d=this.bCategorizedGrid?d[2]:d[1])&&"Grid_NoResults"==d.id){"Progressive Load"==this.pageMode&&c.offsetWidth&&(this.layoutWrapperDiv.style.width=c.offsetWidth+"px",this.rightBodyTbl.style.width=
c.offsetWidth-1+"px");return}var e=[];if(d&&d.cells&&0<d.cells.length){for(c=0;c<d.cells.length;c++){var g=d.cells[c].offsetWidth;e.push(g);if(pega.env.ua.webkit&&b[c].firstElementChild&&d.cells[c].firstElementChild&&(!pega.env.ua.webkit||!f.hasClass(b[c],"expandPaneHeader")&&!f.hasClass(b[c],"rowHandleHead"))){if(g=d.cells[c].firstElementChild.offsetWidth)b[c].firstElementChild.style.width=g+"px"}else pega.env.ua.webkit&&b[c].firstElementChild&&f.hasClass(b[c],"rowHandleHead")&&(b[c].firstElementChild.style.width=
g+"px")}for(c=0;c<d.cells.length;c++)e[c]&&(b[c].style.width=e[c]+"px")}if(this.bTreegrid&&this.leftHeaderDiv){var h=f.getFirstChild(this.leftHeaderDiv);if(!h)return;b=h.rows;if(!b)return;c=b[0];if(!c)return;b=c.cells;if(!b)return;if(d=f.getChildren(f.getFirstChild(this.leftBodyDiv)))for(var m=1;m<d.length&&this.isDummyRow(m);m++);d=f.getFirstChild(d[m]);if((m=f.getChildren(d))&&0<m.length){d=[];for(c=0;c<m.length;c++)d.push(m[c].offsetWidth);for(c=0;c<m.length;c++)b[c].style.width=d[c]+"px"}}if(this.layoutWrapperDiv.getAttribute("noWidth")||
this.layoutWrapperDiv.getAttribute("noHeight")){for(m=b=0;m<e.length;m++)b+=e[m];0==b&&(b=a.offsetWidth);(!k.isIE||pega.u.d.inStandardsMode)&&this.layoutWrapperDiv.scrollHeight>this.layoutWrapperDiv.clientHeight&&0!=this.layoutWrapperDiv.clientHeight&&(b+=this.getScrollbarWidth());a=h?h.offsetWidth+b:b;if(0!=a){e=0;if(!k.isIE||pega.u.d.inStandardsMode)this.layoutWrapperDiv.getAttribute("noHeight")&&"Progressive Load"!=this.pageMode?"Progressive Load"==this.pageMode&&this.totalRecords<=this.rangeSize&&
(e=1):e=2;this.layoutWrapperDiv.getAttribute("noWidth")&&(this.layoutWrapperDiv.style.width=a+e+"px",this.gridcontDiv.style.width=a+e+"px",pega.util.Dom.getElementsById("gridLayoutTable",this.gridcontDiv)[0].style.width=a+e+"px",this.rightHeaderDiv.style.width=a+e+"px","Progressive Load"==this.pageMode?(!this.gridAutoHeight&&f.hasClass(this.gridcontDiv,"gPXAuto")&&(this.layoutWrapperDiv.style.overflowX="hidden"),this.rightHeaderTbl.style.width=pega.util.Event.isIE?a+"px":a+e-1+"px"):this.rightHeaderTbl.style.width=
a+e+"px")}}""!=this.gridcontDiv.style.width&&this.rightHeaderDiv&&this.rightHeaderTbl&&this.rightBodyTbl&&(a=this.getScrollbarWidth(),"Progressive Load"==this.pageMode&&(a=this.layoutWrapperDiv.offsetWidth-this.rightBodyTbl.offsetWidth-1),a=this.rightBodyTbl.clientWidth+a+"px",this.rightHeaderDiv.style.width=a,this.rightHeaderTbl.style.width=a)}else this.rightBodyTbl&&this.rightBodyTbl.rows[0].cells[0]&&this.writeCases.push(Grids.SET_UL_HEIGHT);f.getElementsById("Grid_NoResults",this.gridDiv)||this.updateHeaderCellsWidth()}},
startColResize:function(a,b){var c=b[1],d=b[2];b=b[0];a.target&&(c.activeResize=a.target);c.currentColESource=b;c.currentColESourceP=c.currentColESource.parentNode;c.currentColESourceTables=[];"LI"==c.currentColESource.tagName&&(c.currentColESourcePCSSPaddingLeft=parseInt(c.currentColESourceP.style.paddingLeft));c.currentColESourcePCSSPaddingLeft=isNaN(c.currentColESourcePCSSPaddingLeft)?0:c.currentColESourcePCSSPaddingLeft;c.currentColCellIndex="LI"!=c.currentColESource.tagName&&"TD"!=c.currentColESource.tagName&&
"TH"!=c.currentColESource.tagName?c.getCellIndex(c.currentColESourceP):c.getCellIndex(c.currentColESource);if(!c.bPXFixed&&(a=b.parentNode.parentNode.parentNode,pega.util.Event.isIE||(a=a.parentNode),a&&!f.hasClass(a,"resizedTable")&&(a.className+=" resizedTable"),(b=c.rightBodyTbl)&&!f.hasClass(b,"resizedTable")&&(b.className+=" resizedTable"),d==c.leftHeaderTbl&&(f.removeClass(a,"resizedTable"),f.removeClass(b,"resizedTable")),pega.env.ua.webkit&&(d=a.rows)&&0<d.length))for(a=0;a<d.length;a++)(b=
d[a].children)&&0<b.length&&(f.getFirstChild(b[c.currentColCellIndex]).style.maxHeight="none")},doColResize:function(a,b){var c=b[1];b=b[2];var d=a.width,e=d,g=e+"px",h=0;c.fixedRow&&b==c.leftHeaderTbl&&1==f.hasClass(c.gridcontDiv,"gPercent")&&(d+=parseInt(b.rows[0].cells[0].offsetWidth));a=!1;(b==c.leftBodyUL||c.fixedRow&&b==c.leftHeaderTbl)&&-1!=c.rightBodyTbl.width.indexOf("%")&&(a=!0);(b==c.leftBodyUL||c.fixedRow&&b==c.leftHeaderTbl)&&b.offsetWidth>d&&-1!=c.rightBodyTbl.width.indexOf("%")&&(d=
Math.round((b.offsetWidth-d)/b.offsetWidth*100),100>=parseInt(c.rightBodyTbl.parentNode.parentNode.width)+d?c.rightBodyTbl.parentNode.parentNode.width=parseInt(c.rightBodyTbl.parentNode.parentNode.width)+d+"%":c.rightBodyTbl.parentNode.parentNode.width="100%",c.fixedRow&&(c.rightHeaderTbl.parentNode.parentNode.width=parseInt(c.rightHeaderTbl.parentNode.parentNode.width)+d+"%"));d=c.currentColESourceP;f.isAncestor(c.leftBodyUL,c.currentColESource)||c.fixedRow&&c.fixedCol&&c.leftHeaderDiv&&f.isAncestor(c.leftHeaderDiv,
c.currentColESource)?(d=0,c.fixedRow&&c.fixedCol&&!c.bTreeGrid&&(c.bNumberedSkin||c.bDragDrop)&&(d=27),e=e+c.currentColESourcePCSSPaddingLeft+d+"px",c.leftBodyDiv.style.width=e,c.gridBodyLeftParent&&(c.gridBodyLeftParent.style.width=e)):pega.env.ua.ie||(d.style.width=g);e=c.currentColCellIndex;b==c.leftHeaderTbl?(d=[c.leftHeaderTbl],c.leftHeaderTbl.rows[0].cells[e].style.width=g):b==c.rightHeaderTbl?(d=[c.rightHeaderTbl,c.rightBodyTbl],c.rightBodyTbl.rows[0].cells[e].style.width=g,pega.env.ua.webkit&&
c.bGrid&&(c.bDragDrop||c.bNumberedSkin)&&(c.rightHeaderTbl.rows[0].cells[0].style.minWidth=c.rightBodyTbl.rows[0].cells[0].offsetWidth+"px")):d=b==c.leftBodyUL?-1!=c.rightBodyTbl.width.indexOf("%")||c.bTreegrid&&c.editConfig==c.EDIT_READWRITE?[c.rightBodyTbl]:[]:[c.rightBodyTbl];if(c.bTreegrid&&k.isIE){var m=f.getChildren(c.leftBodyUL),h=0;if(m&&0<m.length)for(g=1;g<m.length;g++)if("true"==m[g].getAttribute("isWrapEnabled")){var n=f.getFirstChild(m[g]),h=f.getFirstChild(n).offsetHeight,l=f.getNextSibling(f.getFirstChild(n)),
q=f.getNextSibling(f.getFirstChild(l)).offsetHeight,h=q>h?q:h;if(n&&0!=h)for(n.style.height=h+"px",f.getFirstChild(n).style.height=h+"px",l.style.height=h+"px",l=c.rightBodyTbl.rows,q=g;q<l.length;q++)for(var p=l[q].cells,n=1;n<p.length;n++)p[n].style.height=h+"px"}}for(var l=d.length,t=q=0,g=0;g<l;g++)if(d[g]){p=d[g].rows[0];if(c.bTreegrid&&c.leftHeaderTbl&&b!=c.leftHeaderTbl)for(m=c.leftHeaderTbl.rows[0].cells,n=0;n<m.length;n++)q+=parseInt(m[n].offsetWidth);if(p){p=p.cells;m=p.length;n=d[g].width;
""==n&&(n=d[g].style.width);var v=!1;n&&-1!=n.indexOf("%")&&(v=!0);var u=d[g].offsetWidth;c.bPXFixed&&c.fixedRow&&b!=c.leftHeaderTbl&&--m;for(n=0;n<m;n++){var w=parseInt(p[n].style.width);e==n&&v&&!a&&(w=100*parseInt(w)/u,p[n].style.width=w+"%");if(b==c.leftHeaderTbl&&c.bPXFixed&&c.fixedRow&&c.fixedCol)t=""!=w?t+parseInt(w):t+p[n].offsetWidth;else if(c.bTreegrid||!c.fixedRow||d[g]!=c.rightHeaderTbl&&c.fixedRow&&c.layoutWrapperDiv&&"true"==c.layoutWrapperDiv.getAttribute("noWidth"))t=""!=w?t+parseInt(w):
t+p[n].offsetWidth}n=1;for((c.bNumberedSkin||c.bDragDrop)&&c.bShowExpandCollapseColumn&&(n=2);n<m;n++)u=(100-parseInt(p[e].style.width))/(m-2),e!=n&&v&&(p[n].style.width=u+"%");!v&&c.bTreegrid&&c.fixedRow&&b==c.rightHeaderTbl&&(d[g].style.width=t+"px",c.rightBodyTbl&&(c.rightBodyTbl.style.width=t+"px"));b!=c.leftHeaderTbl&&(t+=q);b==c.leftHeaderTbl&&c.bPXFixed&&c.fixedRow&&c.fixedCol&&(c.leftHeaderTbl.style.width=t+"px");v||("true"==f.getFirstChild(c.rightBodyDiv).getAttribute("fixedSize")&&(c.fixedRow||
"true"==c.gridcontDiv.getAttribute("hasWidth"))||b==c.leftHeaderTbl||c.bPXFixed||(d[g].style.width=t+"px"),!c.fixedRow&&c.layoutWrapperDiv&&"true"==c.layoutWrapperDiv.getAttribute("noHeight")&&"true"==c.layoutWrapperDiv.getAttribute("noWidth")&&(d[g].style.width=t+"px"),c.fixedRow&&c.layoutWrapperDiv&&"true"==c.layoutWrapperDiv.getAttribute("noWidth")&&b!=c.leftHeaderTbl&&(f.getElementsById("gridLayoutTable",c.gridDiv)[0].parentNode.style.width=t+"px"),c.bGrid&&!c.fixedCol&&c.fixedRow&&"true"==c.layoutWrapperDiv.getAttribute("noWidth")&&
(f.getElementsById("gridLayoutTable",c.gridDiv)[0].parentNode.style.width="auto"),!c.bTreegrid&&c.fixedRow&&"true"==c.layoutWrapperDiv.getAttribute("noWidth")&&(d[g].style.width=t+"px"),k.isIE&&c.fixedRow&&c.layoutWrapperDiv&&"true"==c.layoutWrapperDiv.getAttribute("noHeight")&&"true"!=c.layoutWrapperDiv.getAttribute("noWidth")&&(c.layoutWrapperDiv.style.height=f.getFirstChild(c.layoutWrapperDiv).offsetHeight+c.getScrollbarWidth()+"px"));d[g]!=c.leftHeaderTbl||c.bTree&&1==f.hasClass(c.gridcontDiv,
"gPercent")||(c.leftBodyDiv.style.width=t+"px",c.gridBodyLeftParent&&(c.gridBodyLeftParent.style.width=t+"px"),c.leftHeaderTbl&&(c.leftHeaderTbl.style.width=c.leftBodyDiv.offsetWidth+"px"),c.fixedRow&&"true"==c.layoutWrapperDiv.getAttribute("noWidth")&&1!=f.hasClass(c.gridcontDiv,"gPercent")&&(c.layoutWrapperDiv.style.width=f.getFirstChild(c.layoutWrapperDiv).offsetWidth+c.getScrollbarWidth()+"px"));if((c.bTreegrid||c.fixedCol)&&1!=f.hasClass(c.gridcontDiv,"gPercent")&&(n=d[g].rows[1],c.fixedRow&&
(n=c.rightBodyTbl.rows[1]),n&&(h=n.cells[e].offsetHeight),(m=f.getChildren(c.leftBodyUL))&&0<m.length))for(g=1;g<m.length;g++)if(n=f.getFirstChild(m[g]))n.style.height=h+"px"}}c.gridResized()},findCell:function(a,b,c){a=c?c:k.getTarget(a);c=null;if(!a.nodeName)return null;for("UL"==a.nodeName&&f.hasClass(a,"rowContent")&&(a=f.getFirstChild(a));a&&"BODY"!=a.nodeName&&b&&a.id!=b.id;){if("TH"==a.nodeName||"TD"==a.nodeName||"LI"==a.nodeName&&!f.hasClass(a,"gridRow"))c=a;a=a.parentNode}return a&&"BODY"!=
a.nodeName?c:null},getCellIndex:function(a){return null==a?0:"TD"==a.tagName||"TH"==a.tagName?a.cellIndex:f.getPreviousSibling(a)?1:0},getFilteredColumnIndex:function(a){if("TD"==a.tagName||"TH"==a.tagName){var b;if(this.leftHeaderTbl&&f.isAncestor(this.leftHeaderTbl,a))b=1;else{for(b=1;a.previousElementSibling;)b+=a.previousElementSibling.colSpan,a=a.previousElementSibling;(!this.fixedCol&&!this.bTreegrid&&this.bDragDrop||!this.fixedCol&&this.bNumberedSkin)&&--b;this.editConfig==this.EDIT_EXPANDPANE&&
this.bShowExpandCollapseColumn&&--b}return b}return 1},getRowIndex:function(a){if(a){if("TD"==a.tagName||"TH"==a.tagName)return a.parentNode.rowIndex;(a=pega.util.Dom.getElementsById(a.parentNode.parentNode.id,this.rightBodyTbl,"TR"))?(a=a[0],a=a.rowIndex):a=0;return a}},getLastRowIndex:function(){var a=1;if("Progressive Load"!=this.pageMode)if(!this.bTreegrid&&this.rightBodyTbl.rows&&0<this.rightBodyTbl.rows.length){if(a=this.rightBodyTbl.rows[this.rightBodyTbl.rows.length-1].rowIndex,this.editConfig==
this.EDIT_EXPANDPANE||this.bCategorizedGrid)a=this.getExpandPaneTableLength()}else{if(this.bTreegrid){var b=f.getChildren(this.leftBodyUL);b&&(a=this.getTopLevelIndexOnUI(b.length-1))}}else this.bDiscardInvisibleRows?this.bDiscardInvisibleRows&&(a=this.getNoOfRowsLoaded()):(0<this.noOfPagesLoaded&&0<this.rangeSize&&(a=this.noOfPagesLoaded*this.rangeSize),a=a>this.totalRecords?this.totalRecords:a),this.bCategorizedGrid||(a=this.getIndex(a));return a},getPageIndex:function(a,b){a=this.findCell(a,b);
if(this.repeatType==this.ROW_REPEAT){if(a&&a.parentNode)return this.getRowIndex(a)}else if(a&&(b=this.getCellIndex(a),-1!=b)){if(!a.getAttribute("colspan")||1==a.getAttribute("colspan"))return 0==b%2?[b-1,b,b/2]:[b,b+1,(b+1)/2];if(2==a.getAttribute("colspan"))return[2*b-1,2*b,b]}return-1},getTopLevelNodesLength:function(a){return f.getChildren(this.leftBodyUL).length-1},getTopLevelIndexOnUI:function(a){var b,c=f.getChildren(this.leftBodyUL);c&&(a=c[a])&&(a=f.getElementsById(a.id,this.rightBodyTbl,
"TR")[0])&&(b=a.rowIndex);return b},getActiveRowIndexFromRowIndex:function(a){var b=this.rightBodyTbl.rows,c=0,d=this.rightBodyTbl.rows[a];if(!d)return a;""==d.id&&1<a&&a--;for(var e=1;e<a;e++)d=b[e],""==d.id&&c++;return a-c},getExpandPaneTableLength:function(){var a;a=this.rightBodyTbl.rows.length-1;if(this.editConfig==this.EDIT_EXPANDPANE||this.bCategorizedGrid)a=this.getActiveRowIndexFromRowIndex(a);this.bGrid||a--;return a},getTableLength:function(a){a=this.bTreegrid?a.id!=this.leftBodyUL.id?
a.rows.length:f.getChildren(a).length:a.rows.length;return 1==this.bGrid?a-1:a-2},callSelectPage:function(a){this.selectPage(null,a[0],a[1]);this.resetInCall()},setActiveRow:function(a,b,c,d){if(a){c||this.getPageIndex(a,b);var e=pega.util.Event.getTarget(a);if(!this.isElementFromSameGridContDiv(e))return}try{var g=c?c:this.getPageIndex(a,b);if(!this.bCategorizedGrid||!this.rightBodyTbl.rows[g]||this.rightBodyTbl.rows[g].id){if(this.bRowHovering){var h=this.rightBodyTbl.rows[g];if(h&&"true"==h.getAttribute("expanded"))for(h=
h.previousSibling;1!=h.nodeType;)h=h.previousSibling;this.onCellHover(h,!1)}this.editConfig==this.EDIT_EXPANDPANE&&(h=this.rightBodyTbl.rows[g],h.id||--g);if(!(this.repeatType==this.ROW_REPEAT&&(0==g||-1==g||this.bGrid&&g>this.getTableLength(this.rightBodyTbl)||!this.bGrid&&g>this.getTableLength(this.rightBodyTbl))||this.repeatType==this.COL_REPEAT&&(0==g[0]||-1==g[0]||g[0]==b.rows[0].cells.length-1)))if(this.activeRow&&-1!=this.activeRow&&this.getIndex(this.activeRow)!=g&&(this.repeatType==this.ROW_REPEAT?
(d||this.selectRow(this.activeRow,!1),this.getLeftRow()&&f.getFirstChild(this.getLeftRow()).removeAttribute("tabIndex")):this.selectCol(this.activeRow,!1)),this.getIndex(this.activeRow)==g){if(a){var m=k.getTarget(a),l=m.nodeName;if("A"!=l&&"BUTTON"!=l&&"SELECT"!=l&&"OPTION"!=l&&"INPUT"!=l&&"TEXTAREA"!=l&&"IMG"!=l&&!this.isDatePicker(m)){var r=m.getAttribute("tabIndex");if(10<pega.env.ua.ie&&null==r){do m=m.parentNode,r=m.getAttribute("tabIndex");while(!r)}r=r&&!isNaN(r)?parseInt(r):-1;if(0>r){if(this.editConfig==
this.EDIT_EXPANDPANE&&"true"==this.getRightRow().getAttribute("rowExpanded")){var q=f.getElementsById("rowDetail"+this.getLeftRow().id,this.gridDiv)[0];if(q&&f.isAncestor(q,m))return}f.isAncestor(this.getLeftRow(),m)||f.getFirstChild(this.getLeftRow()).focus()}}}}else{if(this.editConfig==this.EDIT_EXPANDPANE||this.bCategorizedGrid)this.bPageGroup?g=this.getPGRowIndex(g):(h=this.rightBodyTbl.rows[g])&&h.id&&(g=this.bFilteredGrid?this.getFilteredRowIndex(g):h.getAttribute("PL_INDEX"),"Progressive Load"!=
this.pageMode&&this.currentPageIndex&&""!=this.currentPageIndex&&""==this.pyPaginateActivity&&!this.bReportDefinition&&parseInt(g)>parseInt(this.rangeSize)?g-=(this.currentPageIndex-1)*this.rangeSize:this.bDiscardInvisibleRows&&this.currentPageIndex&&""!=this.currentPageIndex&&(g=this.getActiveRowIndexFromRowIndex(h.rowIndex)));this.activeRow=g}}}catch(p){}},changeSetFocus:function(a,b){a=a?parseInt(a,10):0;var c;0==a&&(b=parseInt(b,10),(a=this.getLeftRow())?((c=0<b?this.getNextGridRow(a):this.getPreviousGridRow(a))&&
(this.bTreegrid||this.fixedCol)&&(c=f.getElementsById(c.id,this.rightBodyTbl)[0]),a=c?c.rowIndex:0):a=1);0<a&&(this.bTreegrid&&!b&&(a=this.getTopLevelIndexOnUI(a)),this.editConfig==this.EDIT_ROW?(c=this.rightBodyTbl.rows[a],f.getFirstChild(c)?k.fireEvent(f.getFirstChild(c),"mouseup"):k.fireEvent(document.body,"mouseup")):this.editConfig!=this.EDIT_EXPANDPANE&&!this.bCategorizedGrid||c||(a=this.getIndex(a)),"Progressive Load"==this.pageMode&&(this.bDiscardInvisibleRows?(c=this.getNoOfRowsLoaded(),
0<this.rangeSize&&a>this.getIndex(c)&&(a=this.getIndex(c))):(c=this.noOfPagesLoaded*this.rangeSize,0<this.noOfPagesLoaded&&0<this.rangeSize&&a>c&&(a=this.getIndex(c)))),this.selectPage(null,null,a),a={rowEle:this.getLeftRow(),refObj:this},1==b||-1==b?this.gridDetailsDiv&&""!=this.gridDetailsDiv.innerHTML&&this.setTopPriorityAction(this.triggerEditInHarness,a):this.setTopPriorityAction(this.triggerEditInHarness,a))},triggerEditInHarness:function(a){a=a.rowEle;if(this.editConfig==this.EDIT_HARNESS&&
this.bEditableGrid){var b={};b.target=f.getChildren(a)[0];if(!b.target&&this.bTopPriorityActionSet)return this.bTopPriorityActionSet=!1,pega.c.actionSequencer.resume(),!0;b.type=Grids.EVENT_CLICK;this.editInHarness(b,this.bTreegrid||this.fixedCol?this.leftBodyUL:this.rightBodyTbl)}else this.bTopPriorityActionSet&&(this.bTopPriorityActionSet=!1,pega.c.actionSequencer.resume())},getScrollParent:function(a){return null===a?null:a.scrollWidth>a.clientWidth?a:this.getScrollParent(a.parentNode)},selectPage:function(a,
b,c){try{this.setActiveRow(a,b,c);this.repeatType==this.ROW_REPEAT?this.selectRow(this.activeRow,!0):this.selectCol(this.activeRow,!0);b=!1;this.getScrollParent(this.gridDiv);var d=document.body.scrollWidth>document.body.clientWidth&&!!navigator.userAgent.match(/Trident.*rv[ :]*11\./);pega.c.AutoCompleteAG&&pega.c.AutoCompleteAG.isElementInsideAutoComPO(a,this.gridDiv)&&(b=!0);if(a&&this.repeatType==this.ROW_REPEAT){var e=k.getTarget(a),g=e.nodeName;if(("A"==g||"SPAN"==g&&"pageIndex"==e.className||
"BUTTON"==g||"SELECT"==g||"OPTION"==g||"INPUT"==g||"TEXTAREA"==g)&&"hidden"!=e.type&&(e.currentStyle&&"hidden"!=e.currentStyle.visibility&&"none"!=e.currentStyle.display||window.getComputedStyle&&"hidden"!=window.getComputedStyle(e,"").visibility&&"none"!=window.getComputedStyle(e,"").display)){c=null;f.isAncestor(this.leftBodyUL,e)?c=this.leftBodyUL:f.isAncestor(this.rightBodyTbl,e)&&(c=this.rightBodyTbl);var h=this.findCell(a,c,e);h&&(c==this.leftBodyUL?this.focusElem={index:this.getCellIndex(h),
tag:"LI"}:c==this.rightBodyTbl&&(this.focusElem={index:h.cellIndex,tag:h.nodeName}));"A"==g&&pega.env.ua.webkit&&a.type==Grids.EVENT_RIGHT_CLICK&&(this.focusElem=null,f.getFirstChild(this.getLeftRow()).tabIndex="0",f.getFirstChild(this.getLeftRow()).focus())}else if("A"!=g&&"BUTTON"!=g&&"SELECT"!=g&&"INPUT"!=g&&"TEXTAREA"!=g&&"IMG"!=g&&!this.isDatePicker(e)){var m=e.getAttribute("tabIndex"),m=m&&!isNaN(m)?parseInt(m):-1;if(0>m){if(this.editConfig==this.EDIT_EXPANDPANE&&"true"==this.getRightRow().getAttribute("rowExpanded")){var l=
f.getElementsById("rowDetail"+this.getLeftRow().id,this.gridDiv)[0];if(l&&f.isAncestor(l,e))return}this.focusElem=null;b||null!=e.getAttribute("data-click")||d||a.type==Grids.EVENT_RIGHT_CLICK||this.focusFirstElement(this.getLeftRow())}}}else b||this.repeatType!=this.ROW_REPEAT||"true"==this.rightBodyTbl.rows[c].getAttribute("expanded")||f.isAncestor(this.getLeftRow(),document.activeElement)||this.focusFirstElement(this.getLeftRow())}catch(r){}},isDatePicker:function(a){if("SPAN"==a.tagName){var b=
a.parentNode;if(a.getAttribute("data-calendar")||b.getAttribute("data-calendar"))return!0}return!1},selectCol:function(a,b){b=b?f.addClass:f.removeClass;if(this.rightHeaderTbl)for(var c=this.rightHeaderTbl.rows,d=0;d<c.length;d++){var e=c[d];b(e.cells[a[0]],this.SELECTED_CLASS);b(e.cells[a[1]],this.SELECTED_CLASS)}c=this.rightBodyTbl.rows;for(d=0;d<c.length;d++)e=c[d],0==e.rowIndex?(b(e.cells[a[0]],this.SELECTED_CLASS),b(e.cells[a[1]],this.SELECTED_CLASS)):b(e.cells[a[2]],this.SELECTED_CLASS)},selectRow:function(a,
b){if(this.bFocusibleGrid){var c;c=b?f.addClass:f.removeClass;if(a=this.rightBodyTbl.rows[this.getIndex(a)]){var d=a.id;if(d){var e=a.cells,g=e.length,h=0;if(this.bDragDrop||this.bTreegrid||this.bNumberedSkin)h=1;for(this.editConfig==this.EDIT_EXPANDPANE&&!this.fixedCol&&this.bShowExpandCollapseColumn&&h++;h<g;h++)c(e[h],this.SELECTED_CLASS);b||f.removeClass(a,"notFocused");if(this.bTreegrid||this.fixedCol){a=pega.util.Dom.getElementsById(d,this.leftBodyUL,"LI")[0];d=a.getElementsByTagName("UL")[0];
this.bTreegrid&&c(d,this.SELECTED_CLASS);e=f.getChildren(d);g=e.length;h=0;if(this.bDragDrop||this.bTreegrid||this.bNumberedSkin)h=1;for(this.editConfig==this.EDIT_EXPANDPANE&&this.fixedCol&&this.bShowExpandCollapseColumn&&h++;h<g;h++)c(e[h],this.SELECTED_CLASS);b||f.removeClass(a,"notFocused")}this.bTreegrid&&f.getElementsById(a.id,this.leftBodyUL);this.setHeadersWidth()}}}},disableInnerTags:function(a){var b=a.getElementsByTagName("DIV"),c=a.getElementsByTagName("SPAN");a=a.getElementsByTagName("LABEL");
for(var d=b.length,e=c.length,g=a.length,h=0;h<d;h++)f.addClass(b[h],"greyedOut");for(h=0;h<e;h++)f.addClass(c[h],"greyedOut");for(h=0;h<g;h++)a[h].style.color="grey",f.addClass(a[h],"greyedOut")},disableRow:function(a,b){"undefined"==typeof a&&(a=this.getActiveRowIndex());b=this.rightBodyTbl.rows[this.getIndex(a)];b.setAttribute("busyRow","true");pega.u.d.disableAllOtherButtons(null,b);a=b.id;b=b.cells;for(var c=b.length,d=0;d<c;d++)b[d].disabled=!0,pega.env.ua.ie||(f.addClass(b[d],"greyedOut"),
this.disableInnerTags(b[d]));if(this.bTreegrid||this.fixedCol){b=pega.util.Dom.getElementsById(a,this.leftBodyUL,"LI")[0];b.setAttribute("disabled","true");if(a=b.getElementsByTagName("UL")[0])a.disabled=!0,pega.env.ua.ie||(f.addClass(a,"greyedOut"),this.disableInnerTags(a));b=f.getChildren(a);c=b.length;for(d=1;d<c;d++)b[d].disabled=!0,pega.env.ua.ie||(f.addClass(b[d],"greyedOut"),this.disableInnerTags(b[d]))}},getResizedElement:function(a){var b=this.leftBodyUL;this.bTreegrid||this.fixedCol?a=f.getFirstChild(f.getFirstChild(pega.util.Dom.getElementsById(a.id,
this.leftBodyUL,"LI")[0])):(a=f.getFirstChild(a),b=this.rightBodyTbl);return[a,b]},loadGridForEdit:function(a){if(a.argument[6].beforeDomActionContext&&!a.argument[6].beforeDomActionContext.activeRow)return!1;var b=a.argument[0],c=a.responseText;a=a.argument[6];a.bTreegrid=this.bTreegrid;a.leftRowBefore&&(this.leftrowbefore=a.leftRowBefore);a.rightRowBefore&&(this.rightrowbefore=a.rightRowBefore);this.loadRow(c,a,b,[this.activeRow,[this.leftBodyUL,this.rightBodyTbl],this.bPageGroup?"group":"list"],
!0);return!1},getLevel:function(a){return a.id.split("$p").length-1},loadProgressiveRows:function(a){var b=a.argument[0],c=a.responseText;a=a.argument[6];a.bTreegrid=this.bTreegrid;var d=document.createDocumentFragment(),e=document.createElement("div");d.appendChild(e);e.style.display="none";e.innerHTML=c;c=e.querySelector("#bodyTbl_right \x3e #tempTBody").parentElement;this.bTreegrid&&f.getElementsById("gridNode",e,"UL");var g=this,h=c.rows.length;if(!g.bDiscardInvisibleRows)for(var m=(this.bCustomLoad||
this.customLoadStartIndex&&""!=this.customLoadStartIndex?this.currentPageIndex-1:this.noOfPagesLoaded)*this.rangeSize+1,k=[],d=e=0;d<h;d++)this.editConfig==this.EDIT_EXPANDPANE?(k[e]=g.rightBodyTbl.rows[g.getIndex(m)+e],e++):k[d]=g.getRightRow(m+d);e=function(a){a&&"PegaOnlyOnce"!=a.id&&pega.u.d.processOnloads(a);if(!g.bDiscardInvisibleRows){var b=f.getElementsById("tempTBody",g.rightBodyTbl)[0],c=f.getChildren(b),d=0;for(a=0;a<h;a++){var e=c[a],l=k[d],n=!1;if(g.editConfig==g.EDIT_EXPANDPANE&&""==
e.id&&"true"==e.getAttribute("expanded"))l&&"true"==l.getAttribute("expanded")?d++:(g.expDetailsHeight+=e.offsetHeight,l?f.insertBefore(e,l):a==h-1&&f.getFirstChild(g.rightBodyTbl).appendChild(e));else{if(null==l.getAttribute("OAArgs")||g.customLoadStartIndex&&""!=g.customLoadStartIndex)g.customLoadStartIndex&&!n&&e.id==l.id&&(n=!0),l.parentNode.replaceChild(e,l);d++}}b.parentNode.removeChild(b)}"true"==g.gridcontDiv.getAttribute("reloadSomePages")&&(b=g.rightBodyTbl.rows,a=b.length,a-2!=g.totalRecords||
n||(a=b[a-1],parseInt(g.totalRecords)>parseInt(g.rangeSize)&&a.parentNode.removeChild(a)));g.bDiscardInvisibleRows||m+h-1!=g.getTableLength(g.rightBodyTbl)||(g.currentPageIndex=g.noOfPagesLoaded);if(g.bDiscardInvisibleRows){if(g.insertPosition&&""!=g.insertPosition){b=f.getElementsById("tempTBody",g.rightBodyTbl)[0];c=f.getChildren(b);for(a=0;a<h;a++)f.getFirstChild(g.rightBodyTbl).insertBefore(c[a],b);b.parentNode.removeChild(b);b=g.rightBodyTbl.rows;a=b.length;if("down"==g.insertPosition){if(a=
pega.util.Dom.getElementsById(g.deleteRowsBeforeID,g.rightBodyTbl,"TR")[0])for(n=a.rowIndex,g.bCategorizedGrid&&b[n-1]&&!b[n-1].id&&pega.util.Dom.hasClass(b[n-1],"grid-categorize-header")&&n--,a=0;a<n-1;a++)f.getFirstChild(g.rightBodyTbl).removeChild(b[1])}else if("up"==g.insertPosition&&(n=pega.util.Dom.getElementsById(g.deleteRowsAfterID,g.rightBodyTbl,"TR")[0]))for(n=n.rowIndex,g.editConfig==g.EDIT_EXPANDPANE&&(n="true"==f.getNextSibling(b[n]).getAttribute("expanded")?n+1:n),n=a-n-1,a=0;a<n;a++)f.getFirstChild(g.rightBodyTbl).removeChild(b[b.length-
1]);g.insertPosition=null}g.updateTopBottomBufferHeights();n=1==g.currentPageIndex?0:(g.currentPageIndex-2)*g.rangeSize;a=n+g.getNoOfRowsLoaded();g.avoidFocusOnProgressiveLoad?(g.AC_Index_To_Highlight?(g.AC_BCK_First_Index!=g.getFirstLoadedRowIndex()&&(g.AC_Index_To_Highlight-=g.getFirstLoadedRowIndex()-g.AC_BCK_First_Index,34===g.eventKeyKode&&g.selectRow(g.AC_Index_To_Highlight-g.numRows,!1),33===g.eventKeyKode&&g.selectRow(g.AC_Index_To_Highlight+g.numRows,!1)),g.setActiveRow(null,null,g.getIndex(g.AC_Index_To_Highlight)),
g.selectRow(g.AC_Index_To_Highlight,!0)):g.prevActivePLIndex&&n<g.prevActivePLIndex&&g.prevActivePLIndex<=a&&(g.setActiveRow(null,null,g.getIndex(g.prevActivePLIndex-n)),g.selectRow(g.prevActivePLIndex-n,!0)),g.AC_Index_To_Highlight=null,g.avoidFocusOnProgressiveLoad=!1):g.prevActivePLIndex&&n<g.prevActivePLIndex&&g.prevActivePLIndex<=a?g.selectPage(null,null,g.getIndex(g.prevActivePLIndex-n)):(g.activeRow=null,g.prevActivePLIndex=null);a=g.prevVisibleStartIndex*g.rowHeight;g.layoutWrapperDiv.offsetHeight>
g.rowHeight*g.rangeSize&&0<g.scrollDirection&&(a-=g.layoutWrapperDiv.offsetHeight-g.rowHeight*g.rangeSize);if(g.editConfig==g.EDIT_EXPANDPANE&&0<g.scrollDirection){n=g.prevVisibleStartIndex-n;b=g.rightBodyTbl.rows;d=c=0;for(e=1;e<=n;){l=b[d];if(!l)break;"true"==l.getAttribute("expanded")?c+=l.offsetHeight:l.getAttribute("PL_INDEX")&&""!=l.getAttribute("PL_INDEX")&&e++;d++}a+=c}g.layoutWrapperDiv.scrollTop=1===g.prevVisibleStartIndex?0:a}pega.u.d.gIsScriptsLoading=!1;g.gridcontDiv.setAttribute("reloadSomePages",
"");g.bProgressiveLoading=!1;g.bCustomLoad=!1;g.customLoadStartIndex="";g.setHeadersWidth();g.scrollHeadAdded||g.autoAdjustProgressiveGridHeight();g.setRowHandleCellWidth();g.gridResized()};this.noOfPagesLoaded=this.bCustomLoad||this.customLoadStartIndex&&""!=this.customLoadStartIndex?this.currentPageIndex:this.currentPageIndex+1;if(c&&"bodyTbl_right"==c.id){if(this.bDiscardInvisibleRows)this.insertPosition&&""!=this.insertPosition?(r=document.createElement("tbody"),"down"==this.insertPosition?f.getFirstChild(this.rightBodyTbl).appendChild(r):
"up"==this.insertPosition&&f.getFirstChild(this.rightBodyTbl).insertBefore(r,this.rightBodyTbl.rows[1]),a.domElement=r):(this.rightBodyTbl.rows&&this.rightBodyTbl.rows[0]&&c.rows&&c.rows[0]&&f.getFirstChild(c).insertBefore(this.rightBodyTbl.rows[0],c.rows[0]),f.getFirstChild(c).removeAttribute("id"),a.domElement=f.getFirstChild(this.rightBodyTbl));else{d=this.getRightRow(m);this.getLeftRow(m);var r=document.createElement("tbody");d.parentNode.insertBefore(r,d);a.domElement=r}l.loadDOMObject(b,c.innerHTML,
e,a)}return!1},updateTopBottomBufferHeights:function(){(this.editConfig==this.EDIT_EXPANDPANE||this.bCategorizedGrid)&&this.updateExpandedDtlsHeight();this.rowHeight=this.getAvgRowHeight();var a=this.getFirstLoadedRowIndex();this.topBuffer.style.height=0!=(a-1)*this.rowHeight?(a-1)*this.rowHeight+"px":"auto";var b=this.getNoOfRowsLoaded(),c=0<(this.totalRecords-(a+b-1))*this.rowHeight?(this.totalRecords-(a+b-1))*this.rowHeight+"px":"auto";this.bottomBuffer.style.height=c;c=Math.floor(this.layoutWrapperDiv.scrollHeight/
this.rowHeight);this.originalTotalRecords>c&&(this.totalRecords=c,c=0<(this.totalRecords-(a+b-1))*this.rowHeight?(this.totalRecords-(a+b-1))*this.rowHeight+"px":"auto",this.bottomBuffer.style.height=c)},getFirstLoadedRowIndex:function(){return 1==this.currentPageIndex?1:(this.currentPageIndex-2)*this.rangeSize+1},getAvgRowHeight:function(){var a=this.rightBodyTbl.offsetHeight;0===a&&(a=this.rightBodyTbl.offsetHeight);this.editConfig==this.EDIT_EXPANDPANE&&(a-=this.expDetailsHeight);this.bCategorizedGrid&&
(a-=this.categorizedHeadersHeight);var b=this.getNoOfRowsLoaded();return Math.floor(a/b)},getNoOfRowsLoaded:function(){return this.getExpandPaneTableLength()},getActiveRowIndex:function(){return this.activeRow},getPropertyValue:function(a){a=a?a:this.getActiveCell();for(var b,c=["input","textarea","select"],d=0;d<c.length;d++){var e=a.getElementsByTagName(c[d]);if(b&&"select"==c[d])return;for(var g=0;g<e.length;g++){var f=e[g];if(f&&"hidden"!=f.type){"input"==c[d]&&(b=!0);if("checkbox"==f.type)return f.checked.toString();
if(f.value)return f.value}}}return null},getRowData:function(a){for(var b=this.columnsList,c=b.length,d=this.rightBodyTbl.rows[a],e=f.hasClass(d,"editMode"),g={},h=0;h<c;h++){var m=b[h];0==h&&(this.bTreegrid||this.fixedCol)?(d=this.rightBodyTbl.rows[a].id,d=f.getElementsById(d,this.leftBodyUL)[0],d=f.getFirstChild(d).childNodes[1]):d=this.rightBodyTbl.rows[a].cells[h];g[m]=e?this.getPropertyValue(d):document.all?d.innerText:d.textContent}return g},getPropertyText:function(a){var b=this.columnsList,
c=b.length,d=this.activeRow;if(d)for(var e=this.getIndex(d),g=this.rightBodyTbl.rows[e],d=this.editConfig==this.EDIT_ROW&&f.hasClass(g,"editMode"),g=0;g<c;g++)if(b[g]==a)return 0==g&&(this.bTreegrid||this.fixedCol)?(g=this.rightBodyTbl.rows[e].id,a=f.getElementsById(g,this.leftBodyUL)[0],a=f.getChildren(f.getFirstChild(a))[1]):a=this.bTreegrid||this.fixedCol?this.rightBodyTbl.rows[e].cells[g]:this.rightBodyTbl.rows[e].cells[g+1],d||this.editConfig==this.EDIT_READWRITE?this.getPropertyValue(a):pega.util.Event.isIE?
(d=/<script>[^\0]+?<\/script>/gi,a=a.outerHTML,a=a.replace(d,""),d=/<\/?[^>]+>/gi,a=a.replace(d,"")):a.innerText},getFirstCellVal:function(){var a=this.getPropertyText(this.columnsList[0]);return a?a:""},getLeftRow:function(a){a=a?a:this.getActiveRowIndex();if(this.fixedCol||this.bTreegrid){if(this.leftBodyUL&&-1!=a&&this.rightBodyTbl){if(this.rightBodyTbl.rows[this.getIndex(a)])var b=this.rightBodyTbl.rows[this.getIndex(a)].id;return b?pega.util.Dom.getElementsById(b,this.leftBodyUL,"LI")[0]:null}return null}return this.rightBodyTbl.rows[this.getIndex(a)]},
getRightRow:function(a){a=a?a:this.getActiveRowIndex();return-1!=a?this.rightBodyTbl.rows[this.getIndex(a)]:null},getRow:function(a){return[this.getLeftRow(a),this.getRightRow(a)]},getEntryHandle:function(a){a=a?a:this.getActiveRowIndex();a=this.rightBodyTbl.rows[this.getIndex(a)];if(this.rightBodyTbl&&a)return pega.ui.property.toReference(a.id)},doCustomAction:function(a,b,c,d){var e=new SafeURL;e.put("pyActivity","pzdoGridAction");e.put("gridActivity",b);""!=a&&e.put("pzPrimaryPageName",pega.ui.property.toReference(this.rightBodyTbl.rows[this.getIndex(a)].id));
a=SafeURL_createFromURL(c).toEncodedPostBody();pega.u.d.asyncRequest("POST",e,{success:function(a){a=a.responseText;d&&"function"==typeof d&&d.call(window,a)}},a)},getObjClass:function(a){""!=a&&this.bTreegrid?(a=this.rightBodyTbl.rows[this.getIndex(a)],a=f.getElementsById(a.id,this.leftBodyUL,"LI")[0],a=f.getFirstChild(a).getAttribute("objclass")):a=this.propertyClass;return a},append:function(a,b,c,d){var e=""!=b?this.rightBodyTbl.rows[this.getIndex(b)]:f.getFirstChild(this.rightBodyTbl),g=this.getPLPGProperty();
if(""!=a)var g=this.PLPGName,h=a+this.PLPGName;else h=this.dataSourceRef;var m=this.getObjClass(b);m||(m=this.propertyClass);var k=this.appendAct;if(!this.bGrid&&k&&""!=k)var r=!0;this.bValueList&&""==this.appendAct&&(k="AppendToValueList");a={method:"append",grid:this,listBaseRef:this.baseRef,listPrimaryPage:this.primPage,repeatProperty:g,className:m,indexElt:b,pageName:a,customActivity:k,eventOrTarget:e,partialRefresh:this.isPartialRefresh?this.refreshLayout?"false":"true":"false",repeatType:"list",
refreshLayout:this.refreshLayout,pyPropRef:h,appendChild:c};if(b=this.getLastRowToRetrieve())a.lastRowToRetrieve=b;r&&(a.partialRefresh="false",a.refreshLayout=!0);this.bTreegrid&&(a.gridAction=this.action);this.gridPreActivity&&(a.gridPreActivity=this.gridPreActivity);this.gridPostActivity&&(a.gridPostActivity=this.gridPostActivity);this.bGetSafeUrlObj=!1;if(d)return this.bGetSafeUrlObj=!0,l.append(a);l.append(a)},insertBefore:function(a){""==this.action&&(this.action="INSERTBEFORE");this.bPageGroup?
(pega.ctx.gridobj=this,pega.u.d.ShowSubscriptPrompt(this.getPLPGProperty(),this.propertyClass,this.primPage,this.appendAct,this.gridDiv,this.refreshLayout?"false":"true")):(""==a&&!f.getElementsById("Grid_NoResults",this.gridDiv)&&0<this.getTableLength(this.rightBodyTbl)&&(a=1),this.insert(a,!1))},insert:function(a,b){"Progressive Load"==this.pageMode&&(a=this.ensurePositiveIndex(a,"INSERTAFTER"));if(this.bPageGroup)pega.ctx.gridObj=this,pega.u.d.ShowSubscriptPrompt(this.getPLPGProperty(),this.propertyClass,
this.primPage,this.appendAct,this.gridDiv,this.refreshLayout?"false":"true");else{if(""==a)var c="";else c=this.rightBodyTbl.rows[this.getIndex(a)],b?c=pega.ui.property.toReference(c.id):this.bTreegrid?(c=f.getElementsById(c.id,this.leftBodyTbl,"LI")[0].parentNode.parentNode,c=f.hasClass(c,"gridRow")?pega.ui.property.toReference(c.id):""):c="";this.append(c,a,b)}},addChild:function(a){var b=this.getExpandCollNode(a);if(b){var c=pega.ctx.dom.closest(b,"LI");(c=f.getNextSibling(c.parentNode))&&"gridNode"==
c.id?("expandNode"==b.className&&this.doExpandCollapse(null,null,null,this,b),f.hasClass(b,"noEC")&&(f.removeClass(b,"noEC"),b.removeAttribute("tabIndex"),f.addClass(b,"collapseNode")),this.callAppendChild(a)):(pega.u.d.inCall=!0,this.doExpandCollapse(null,null,null,this,b,a))}else alert("You cannot add a child for this row"),this.resetInCall()},callAppendChild:function(a){var b=this.rightBodyTbl.rows[this.getIndex(a)].id,b=f.getElementsById(b,this.leftBodyUL,"LI")[0],c=f.getElementsById("gridNode",
b,"UL");c?c=c[0]:(c=document.createElement("UL"),c.id="gridNode",c.className="gridNode",b.appendChild(c));b=f.getChildren(c);0<b.length?(b=f.getElementsById(b[b.length-1].id,this.rightBodyTbl,"TR")[0].rowIndex,this.editConfig==this.EDIT_MODAL||this.editConfig==this.EDIT_HARNESS?(this.selectRow(a,!1),this.activeRow=b,this.insertAfter()):this.insert(b,!1)):this.editConfig==this.EDIT_MODAL||this.editConfig==this.EDIT_HARNESS?(this.activeRow=a,this.setModalAction("ADDFIRSTCHILD"),this.performInsertAction()):
this.insert(a,!0)},appendToGrid:function(a,b,c,d){this.markAsDirty();if("keypress"==a&&13!=c||this.submitErrors)this.resetInCall();else{if(d==this.leftBodyUL||d==this.rightBodyTbl)var e=this.findCell(null,d,b);e?a=this.getRowIndex(e):this.activeRow&&-1!=this.activeRow&&""!=this.activeRow?(e=this.gridDiv,a=this.activeRow):(e=this.gridDiv,a="");this.bGrid||a==this.rightBodyTbl.rows.length-1&&(a="");this.action="INSERTAFTER";this.bPageGroup?(pega.ctx.gridObj=this,pega.u.d.ShowSubscriptPrompt(this.getPLPGProperty(),
this.propertyClass,this.primPage,this.appendAct,e,"true")):this.insert(a)}},getExpandCollNode:function(a){a=this.rightBodyTbl.rows[this.getIndex(a)].id;a=f.getElementsById(a,this.leftBodyUL,"LI")[0];a=f.getFirstChild(a);(a=f.getElementsById("iconExpandCollapse",a,"DIV"))&&(a=a[0]);return f.getFirstChild(a)},isNodeExpanded:function(a){return"collapseNode"==this.getExpandCollNode(a).className?!0:!1},triggerSubmitOnEmbedPaneRow:function(){var a;if(this.editConfig==this.EDIT_HARNESS&&this.propRef&&(a=
f.getElementsById("ModalButtonSubmit",this.gridDetailsDiv,"BUTTON"))&&a[0]&&!a[0].disabled){var b=pega.ui.property.toHandle(this.propRef);if((b=f.getElementsById(b,this.rightBodyTbl,"TR"))&&b[0]&&(b=b[0],b=b.rowIndex,this.activeRow!=b))return this.selectRow(this.activeRow,!1),this.deleteGridRow="true",this.deleteGridRowIndex=this.activeRow,this.activeRow=b,k.fireEvent(a[0],Grids.EVENT_CLICK),!0}return!1},resetCustomDeleteRowProps:function(){this.editConfig==this.EDIT_HARNESS&&"true"==this.deleteGridRow&&
(this.deleteGridRowIndex=this.deleteGridRow="",this.notSubmitDetails=!1)},removeFromGrid:function(a,b,c,d){this.markAsDirty();if("keypress"==a&&13!=c||this.editConfig==this.EDIT_READONLY||this.gridDiv.getAttribute("editConfig")==this.EDIT_READONLY)this.resetInCall();else{a=this.getActiveRowIndex();if(!a||""==a)return this.resetInCall(),!1;this.action="DELETE";if(this.notSubmitDetails||!this.triggerSubmitOnEmbedPaneRow())this.resetCustomDeleteRowProps(),this.bPageGroup?(pega.ctx.gridObj=this,a=this.rightBodyTbl.rows[this.getIndex(a)],
b=a.getAttribute("PG_SUBSCRIPT"),pega.u.d.RemoveFromGroup(this.getPLPGProperty(),b,this.primPage,this.deleteAct,a,this.refreshLayout?"false":"true")):this.remove(a),this.submitErrors&&(this.submitErrors=!1)}},remove:function(a){if(this.notSubmitDetails||!this.triggerSubmitOnEmbedPaneRow()){this.resetCustomDeleteRowProps();this.submitErrors&&(this.submitErrors=!1);var b=a?this.rightBodyTbl.rows[this.getIndex(a)]:f.getFirstChild(this.rightBodyTbl);this.expandedElem&&this.expandedElem==b&&(this.expandedElem=
null,this.bExpandMultipleRows||(this.comingFromAdd=!1));if(this.bPageGroup){pega.ctx.gridObj=this;a=b.getAttribute("PG_SUBSCRIPT");pega.u.d.RemoveFromGroup(this.getPLPGProperty(),a,this.primPage,this.deleteAct,b,this.refreshLayout?"false":"true");var c=this.editConfig==this.EDIT_EXPANDPANE?this.getExpandPaneTableLength():this.getTableLength(this.rightBodyTbl);1==c&&(this.refreshLayout=!0)}else{var d=this.rightBodyTbl.rows[this.getIndex(a)],e;this.bTreegrid||this.fixedCol?(d=pega.util.Dom.getElementsById(d.id,
this.leftBodyUL)[0],d.id&&(e=d.parentNode.parentNode,e=pega.ui.property.toReference(e.id))):(e=d.parentNode.parentNode,e=pega.ui.property.toReference(e.id));d=this.getPLPGProperty();""!=e&&(d=this.PLPGName);c=this.bTreegrid?this.getTopLevelNodesLength(this.rightBodyTbl):this.editConfig==this.EDIT_EXPANDPANE?this.getExpandPaneTableLength():this.getTableLength(this.rightBodyTbl);1==c&&""==e&&(this.refreshLayout=!0,Math.ceil(this.totalRecords/this.rangeSize)==this.currentPageIndex&&this.currentPageIndex--);
c=this.getObjClass(a);c||(c=this.propertyClass);b={method:"delete",grid:this,listBaseRef:this.baseRef,listPrimaryPage:this.primPage,repeatProperty:d,className:c,indexElt:""!=a?b:"",pageName:e,customActivity:this.deleteAct,eventOrTarget:b,partialRefresh:this.isPartialRefresh?this.refreshLayout?"false":"true":"false",repeatType:"list"};"list"==b.repeatType&&b.eventOrTarget&&(a=pega.util.Dom.getElementsById(b.eventOrTarget.id,this.rightBodyTbl)[0],a.id==b.eventOrTarget.id&&(b.eventOrTarget=a));l.remove(b)}}},
updateChildHandles:function(a,b,c,d,e,g){b=f.getChildren(a);for(var h=b.length,m=0;m<h;m++){var k=b[m],l=k.id,q=this.getPLPGProperty();0<=q.indexOf(".")&&(q=q.substring(q.lastIndexOf(".")+1));var p,t;p=e&&k.id==e?t=(p=f.getPreviousSibling(k))?parseInt(p.getAttribute("PL_INDEX"))+1:1:t=m+1;var v=q=a.parentNode.id+"$p"+q+"$l"+t,u=pega.util.Dom.getElementsById(k.id,this.rightBodyTbl);if(c&&d&&1<u.length)for(var w=0;w<u.length;w++){var x=u[w];if(k.getAttribute("rowUniqueID")==x.getAttribute("rowUniqueID"))break}else x=
u[0];pega.u.d.updateHandles(k,l,q,p,t,v,g);pega.u.d.updateHandles(x,l,q,p,t,v,g);"gridNode"==f.getLastChild(b[m]).id&&(k=q,this.updateChildHandles(f.getLastChild(b[m]),k,c,d,e,g))}},updateTreeHandlesAfterInsert:function(a,b){if(b&&b.length)var c=b[0],d=b[2],e=b[3],g=!0;else b=this.getActiveRowIndex(),null==b&&(b=a),c=f.getElementsById(this.rightBodyTbl.rows[b].id,this.leftBodyUL)[0];var h=c.parentNode;if(h&&h.id&&h.parentNode){a=this.dataSourceRef;b=f.getChildren(h);for(var m=b.length,k,l=0;l<b.length;l++)if(c.id==
b[l].id){k=l;break}"INSERTBEFORE"==this.action&&k--;if(g)if(l="",1<m)l=h==this.leftBodyUL?b[1]:b[0],c=l==c?f.getNextSibling(c).id:l.id,v=c.search(/[0-9]*$/),l=h==this.leftBodyUL?m-2:m-1;else{var q=this.getPLPGProperty();0<=q.indexOf(".")&&(q=q.substring(q.lastIndexOf(".")+1));var c=h.parentNode.id+"$p"+q+"$l0",q=h.parentNode.id+"$p"+q+"$l1",p=1,t=q}else var c=b[m-1].id,v=c.search(/[0-9]*$/),l=c.substring(v);l&&!isNaN(l)&&(l=parseInt(l)+1,q=c.substring(0,v)+l,p=l,t=q);g&&--k;for(l=m-1;l>k;l--){var v=
c=b[l].id,h=b[l].id,u=m=b[l].getAttribute("PL_INDEX");if(g&&v==q)break;var w=pega.util.Dom.getElementsById(b[l].id,this.rightBodyTbl);if(d&&e&&1<w.length)for(var x=0;x<w.length;x++){var y=w[x];if(b[l].getAttribute("rowUniqueID")==y.getAttribute("rowUniqueID"))break}else y=w[0];pega.u.d.updateHandles(b[l],c,q,m,p,t,a);pega.u.d.updateHandles(y,c,q,m,p,t,a);"gridNode"==f.getLastChild(b[l]).id&&this.updateChildHandles(f.getLastChild(b[l]),q,d,e,a);q=v;t=h;p=u}}},updateTreeHandlesAfterDelete:function(a){var b,
c,d;if(a&&a.length&&6==a.length){var e=a[0],g=a[1];d=a[2];c=a[3];var h=a[3],k=a[4],l=a[5];b=!0}else a=this.rightBodyTbl.rows[this.getActiveRowIndex()],e=f.getElementsById(a.id,this.leftBodyUL)[0];a=this.dataSourceRef;for(var r=f.getChildren(e.parentNode),q=r.length,p,t=0;t<r.length;t++)if(e.id==r[t].id){p=t;break}b||(g=r[p].id,d=r[p].getAttribute("PL_INDEX"),c=r[p].id);t=b?p:p+1;for(t;t<q;t++){p=g;var e=c,v=d,g=b=r[t].id;c=r[t].id;var u;d=u=r[t].getAttribute("PL_INDEX");var w=pega.util.Dom.getElementsById(r[t].id,
this.rightBodyTbl);if(k&&l&&1<w.length)for(var x=0;x<w.length;x++){var y=w[x];if(r[t].getAttribute("rowUniqueID")==y.getAttribute("rowUniqueID"))break}else y=w[0];pega.u.d.updateHandles(r[t],b,p,u,v,e,a);pega.u.d.updateHandles(y,b,p,u,v,e,a);"gridNode"==f.getLastChild(r[t]).id&&this.updateChildHandles(f.getLastChild(r[t]),p,k,l,h,a)}},expandCollapsedNodes:function(){var a=this.getLeftRow();if(a)for(a=a.parentNode;a&&a!=this.leftBodyUL;){if(a&&"gridNode"==a.id&&"none"==a.style.display){a=f.getPreviousSibling(a);
a=f.getElementsById("iconExpandCollapse",a)[0];a=f.getFirstChild(a);this.doExpandCollapse(null,null,null,this,a);break}a=a.parentNode.parentNode}},loadRow:function(a,b,c,d,e){if(!(-1<b.partialTrigger.indexOf("delete")&&-1<a.indexOf("ERRORTABLE")&&-1==a.indexOf("PEGA_GRID_DELETE||DELETE_SUCCESS||"))){var g=this,h=function(c){if("delete"==b.partialTrigger&&b.domElement&&"TR"==b.domElement.nodeName&&b.execAfterLoadRow||c&&"TR"==c.nodeName&&e)g.afterLoadRow(b.partialTrigger,d[2],d[0],b.domAction,b,a),
window.LayoutGroupModule&&LayoutGroupModule.checkForErrors();c&&"PegaOnlyOnce"!=c.id&&pega.u.d.processOnloads(c);pega.u.d.gIsScriptsLoading=!1};l.activeStream=[];var k=document.createElement("div"),n=a.indexOf("||PEGA||GRID||"),r=a.indexOf("||END||"),n=[a.substring(0,n-1),a.substring(n+14,r-1)];if((!pega.env.ua.ie||pega.u.d.inStandardsMode)&&0>b.partialTrigger.indexOf("delete")&&n&&n[1]&&0!=pega.lang.trim(n[1]).indexOf("\x3ctable")&&0!=pega.lang.trim(n[1]).indexOf("\x3cTABLE"))return b.domElement[0]&&
(c={refObj:this,rowsArray:[]},c.rowsArray[0]=pega.ui.property.toReference(b.domElement[0].id),this.setTopPriorityAction(this.refreshRows,c)),!1;var r=b.domElement,q=!1;(b.bTreegrid=this.bTreegrid)&&!b.bNotExpandRow&&this.expandCollapsedNodes();if(-1<b.partialTrigger.indexOf("delete")){for(var p=0;p<r.length;p++){var t;b.domElement=r[p];if(this.bTreegrid)if(0==p){for(var k=f.getElementsById(b.domElement.id,this.leftBodyUL,"LI")[0],v=f.getElementsById(k.id,this.rightBodyTbl)[0].rowIndex,u=k;"gridBody_left"!=
u.id;)if(t=f.getNextSibling(u),null==t)u=u.parentNode.parentNode;else{u=t;break}t="gridBody_left"!=u.id?(u.id==k.id?f.getElementsById(u.id,this.rightBodyTbl)[1]:f.getElementsById(u.id,this.rightBodyTbl)[0]).rowIndex:this.rightBodyTbl.rows.length}else{k=0;t!=v&&(k=t-v);for(u=1;u<k;u++)b.domElement=this.rightBodyTbl.rows[v+1],l.loadDOMObject(c,"",h,b);b.domElement=r[p]}if(0!=p||this.bTreegrid||this.fixedCol){if(1==p&&this.editConfig==this.EDIT_EXPANDPANE&&(k=f.getNextSibling(r[p]))){var w=f.getElementsById("rowDetail"+
r[p].id,k,"DIV");w&&w[0]&&(w=w[0])}1==p&&(b.execAfterLoadRow=!0);l.loadDOMObject(c,n[p],h,b);if(1==p&&this.editConfig==this.EDIT_EXPANDPANE&&w){var x=w.parentNode.parentNode;b.domElement=x;"Progressive Load"==this.pageMode&&(this.expDetailsHeight-=x.offsetHeight);l.loadDOMObject(c,"",h,b)}}}0<pega.ui.ChangeTrackerMap.getTracker().changedPropertiesList.length&&(pega.u.d.preReloadEle=null,pega.u.d.evaluateClientConditions("OGRD",null,!0,!0))}else{v=0;r[0]&&-1!=b.partialTrigger.indexOf("edit")&&"yui_modalrownew"!=
r[0].id&&(p=this.getResizedElement(r[0]))&&p[0]&&(v=parseInt(p[0].style.height));for(p=0;p<r.length;p++){var u={},y;for(y in b)u[y]=b[y];if(0!=p||this.bTreegrid||this.fixedCol){if(0==p&&(this.bTreegrid||this.fixedCol)){var z=function(){pega.u.d.lazyLoadManager.detachBeforeLoad(z);return!1};pega.u.d.lazyLoadManager.attachBeforeLoad(z)}u.domElement=r[p];t=null;0==p&&this.bTreegrid&&this.leftrowbefore&&(t=this.leftrowbefore.cloneNode(!0));q&&"append"==u.domAction&&(u.domAction="insert");"insert"!=u.domAction||
"UL"!=r[p].tagName&&"TBODY"!=r[p].tagName||(u.domAction="append",q=!0);l.loadDOMObject(c,n[p],h,u);1==p?(k.innerHTML=n[p],l.activeStream.push(jQuery(k).children("table").get(0).rows[0])):(k.innerHTML=n[p],this.bTreegrid?(w=f.getFirstChild(pega.util.Dom.getFirstChild(k)),l.activeStream.push(w.cloneNode(!0))):l.activeStream.push(pega.util.Dom.getFirstChild(k).cloneNode(!0)));1==p&&this.editConfig==this.EDIT_EXPANDPANE&&0<=u.partialTrigger.indexOf("appendTo")&&(x=f.getFirstChild(k).rows[1])&&(w=f.getOuterHTML(x),
l.loadDOMObject(c,w,h,u));t&&(this.leftrowbefore=t)}}r[0]&&-1!=u.partialTrigger.indexOf("edit")&&"yui_modalrownew"!=r[0].id&&this.bRowResize&&(p=this.getResizedElement(r[0]),this.refreshLayout||isNaN(v)||0==v||this.rightBodyTbl.rows[this.getIndex(this.activeRow)].offsetHeight==v||this.doRowResize({height:v},[p[0],this,p[1]]))}try{"undefined"!=typeof window.parent.frames.actionIFrame&&pega.u.d.resizeActionIFrame(!1)}catch(A){}this.editConfig==this.EDIT_MODAL&&pega.u.d.bModalDialogOpen&&pega.u.d.resizeModalDialog();
this.removeGridNoResultsMsg()}},callInitGridsAndFocusRow:function(){pega.ui.initGrids(this);this.selectPage(null,null,this.activeRow)},loadGridRows:function(a,b){if(a&&a.length&&!(3>a.length)){var c=a[0],d=a[1],e=b.responseText,g=b.argument[6],f=g.domAction,k=g.partialTrigger;"list"===a[2]&&("insert"===f&&""!==c&&0>k.indexOf("editRow")?this.bTreegrid?this.bTreegrid&&"ADDCHILD"!=g.gridAddAction?this.updateTreeHandlesAfterInsert(c):"ADDCHILD"==g.gridAddAction&&this.bFilteredGrid&&(this.refreshLayout=
!0):"INSERTBEFORE"==this.action?pega.u.d.updateHandlesAfterInsert([c-1,d,this]):pega.u.d.updateHandlesAfterInsert([c,d,this]):"remove"===f&&(0>e.indexOf("ERRORTABLE")||-1<e.indexOf("PEGA_GRID_DELETE||DELETE_SUCCESS||"))&&(this.bTreegrid?this.updateTreeHandlesAfterDelete():this.currentPageIndex&&""!=this.currentPageIndex&&""==this.pyPaginateActivity&&"Progressive Load"!=this.pageMode&&!this.bReportDefinition?this.editConfig==this.EDIT_EXPANDPANE?pega.u.d.updateHandlesAfterDelete([c-(this.currentPageIndex-
1)*this.rangeSize,d,this]):pega.u.d.updateHandlesAfterDelete([c-(this.currentPageIndex-1)*this.rangeSize-1,d,this]):this.editConfig==this.EDIT_EXPANDPANE?pega.u.d.updateHandlesAfterDelete([c,d,this]):"Progressive Load"==this.pageMode&&!this.bCBOptimize&&this.bDiscardInvisibleRows?pega.u.d.updateHandlesAfterDelete([this.getActiveRowIndex()-1,d,this]):pega.u.d.updateHandlesAfterDelete([c,d,this]),this.triggerBrowserReflow()));this.loadRow(e,g,b.argument[0],a,!0);return!1}},afterLoadRow:function(a,b,
c,d,e,g){if(0<=a.indexOf("appendTo")){this.activeRow&&("INSERTBEFORE"!=this.action||this.bPageGroup?this.selectRow(this.activeRow,!1):this.selectRow(parseInt(this.activeRow,10)+1,!1));if(1==this.bGrid)if("list"==b)if(""!=c)b=this.action&&"INSERTBEFORE"==this.action?c:parseInt(c)+1;else if(this.editConfig==this.EDIT_EXPANDPANE&&!this.threadProcessing&&this.bExpandMultipleRows){if(this.rightBodyTbl.rows[this.rightBodyTbl.rows.length-1].id)return;b=this.rightBodyTbl.rows.length-2;b=this.getActiveRowIndexFromRowIndex(b)}else(b=
f.getElementsById("Grid_NoResults",this.gridDiv))&&b[0]&&this.removeGridNoResultsMsg(),b=this.rightBodyTbl.rows.length-1;else if(this.editConfig==this.EDIT_EXPANDPANE&&!this.threadProcessing&&this.bExpandMultipleRows){if(this.rightBodyTbl.rows[this.rightBodyTbl.rows.length-1].id)return;b=this.rightBodyTbl.rows.length-2;b=this.getPGRowIndex(b)}else b=this.rightBodyTbl.rows.length-1;else b=e.domElement[1].previousSibling.rowIndex;this.activeRow=b;if(this.editConfig==this.EDIT_EXPANDPANE){b=this.getRightRow();
if(this.threadProcessing||!this.bExpandMultipleRows)this.expandedElem=b;b.setAttribute("rowExpanded","true")}"Progressive Load"==this.pageMode&&this.editConfig==this.EDIT_EXPANDPANE&&(b=this.rightBodyTbl.rows[this.getIndex(this.activeRow)+1])&&""==b.id&&"true"==b.getAttribute("expanded")&&(this.expDetailsHeight+=b.offsetHeight,this.layoutWrapperDiv.scrollTop+=this.getRightRow().offsetHeight);this.editConfig==this.EDIT_MODAL||this.editConfig==this.EDIT_HARNESS?this.editRowCallback([this,this.activeRow,
!0]):(this.focusElem=null,this.editConfig==this.EDIT_EXPANDPANE&&2<e.afterParams.length&&null!=e.afterParams[2]&&e.afterParams[2].responseText?this.editRowCallback([this,this.activeRow,void 0,e.afterParams[2]]):this.editRowCallback([this,this.activeRow]))}else{pega.ctx.Grid.focusedGrid&&pega.ctx.Grid.focusedGrid==this||this.focusGrid(!1);if(-1<e.partialTrigger.indexOf("delete")&&-1<g.indexOf("ERRORTABLE")&&-1==g.indexOf("PEGA_GRID_DELETE||DELETE_SUCCESS||")){this.action="";return}e=this.editConfig==
this.EDIT_EXPANDPANE?this.getExpandPaneTableLength():this.getTableLength(this.rightBodyTbl);0<e?(this.editConfig==this.EDIT_EXPANDPANE&&(this.activeRow=this.getIndex(this.activeRow)?this.activeRow:this.activeRow-1),this.activeRow>e&&--this.activeRow,this.selectRow(this.activeRow,!0),this.editConfig==this.EDIT_HARNESS&&("delete"!=a?(this.DONOT_SUBMIT=!0,this.jumpToIndex(void 0,this.activeRow)):"delete"==a&&f.getElementsById("pyFlowActionHTML",this.gridDetailsDiv)&&(e=this.getLeftRow())&&((b=f.getElementsById("pyFlowActionHTML",
this.gridDetailsDiv)[0])&&b.parentNode&&(l.cleanUpHarnessElements(null,[b]),b.parentNode.removeChild(b)),null==f.getFirstChild(e)&&(e=e.nextSibling),this.setTopPriorityAction(this.triggerEditInHarness,{rowEle:e,refObj:this}))),this.bDiscardInvisibleRows&&"delete"==a&&this.totalRecords--,"Progressive Load"==this.pageMode&&(this.editConfig!=this.EDIT_ROW||-1==a.indexOf("editRow"))&&this.totalRecords>this.rangeSize&&(this.bCustomLoad=!0,this.progressiveLoadGrid())):this.activeRow=null}this.callback&&
"function"==typeof this.callback&&(this.callback.call(window,g),this.callback=null);b=this.rightBodyTbl.rows[this.getIndex(this.activeRow)+1];this.editConfig==this.EDIT_EXPANDPANE?b&&!b.id&&(this.action=""):this.action="";this.bDragDrop&&"remove"==d&&this.unregRelatedDDTargets();if("delete"==a&&!this.fixedCol&&this.fixedRow){if(this.rightHeaderDiv)var h=f.getFirstChild(this.rightHeaderDiv);this.layoutWrapperDiv.scrollHeight>this.layoutWrapperDiv.clientHeight&&0!=this.layoutWrapperDiv.clientHeight&&
h&&h.rows&&"none"!=h.rows[0].style.display||(a=0==f.hasClass(this.gridcontDiv,"gPercent")?f.getElementsByClassName("scrollHead","th",h):f.getElementsByClassName("scrollHead","div",this.rightHeaderDiv))&&0<a.length&&(a[0].parentNode.removeChild(a[0]),f.hasClass(this.gridcontDiv,"gPercent")&&(f.getFirstChild(this.rightHeaderDiv).style.width="100%"))}this.setHeadersWidth();this.gridResized();this.autoAdjustProgressiveGridHeight({afterLoadRow:"true"})},enableSaveDiscardButtons:function(a){if(this.getRightRow()){var b=
f.getElementsById("rowDetail"+this.getRightRow().id,this.rightBodyTbl);if(b){var b=b[0],c=f.getElementsById("RowDetailsButtonCancel",b),d=f.getElementsById("RowDetailsButtonSubmit",b);(null==a||null!=a&&f.isAncestor(b,k.getTarget(a)))&&c&&c[0]&&d&&d[0]&&(c[0].disabled=!1,d[0].disabled=!1)}}},submitAndAppendRow:function(a,b,c,d){this.markAsDirty();if(13==c)if(b&&b.tagName&&("A"==b.tagName||"BUTTON"==b.tagName||"TD"==b.tagName))this.resetInCall();else{this.isEnterKeyAppend=!0;!this.activeRow&&l.activeStream&&
2<l.activeStream.length&&(this.activeRow=l.activeStream[2]);var e;if(!1===this.submitRow(a,b,c)){a=this.rightBodyTbl.rows[this.getIndex(this.activeRow)];if(this.bTreegrid||this.fixedCol)e=pega.util.Dom.getElementsById(a.id,this.leftBodyUL,"LI")[0];this.isEnterKeyAppend=!1;this.leftrowbefore&&(this.bTreegrid&&e.setAttribute("rowUniqueID",this.leftrowbefore.getAttribute("rowUniqueID")),this.bTreegrid?e.replaceChild(this.leftrowbefore.firstChild,f.getFirstChild(e)):this.leftBodyUL.replaceChild(this.leftrowbefore,
e));e=f.getFirstChild(this.rightBodyTbl);this.rightrowbefore&&e.replaceChild(this.rightrowbefore,a);this.action="INSERTAFTER";this.leftrowbefore=this.rightrowbefore=null;this.bFilteredGrid&&(this.refreshLayout=!0);this.insert(this.activeRow)}}else this.resetInCall()},focusOnNewEditableRow:function(){var a=this.activeRow;if(null!=a)if(a=this.getIndex(a),this.editConfig==this.EDIT_ROW){if(this.bTree||this.bTreegrid)this.bTreegrid||this.fixedCol?(b=f.getChildren(f.getFirstChild(pega.util.Dom.getElementsById(this.rightBodyTbl.rows[a].id,
this.leftBodyUL,"LI")[0]))[1],this.focusElem&&"TD"==this.focusElem.tag&&(b=this.rightBodyTbl.rows[a].cells[this.focusElem.index]),this.focusFirstElement(b)||this.focusFirstElement(this.rightBodyTbl.rows[a])):(b=this.rightBodyTbl.rows[a],1!=this.focusFirstElement(b)&&this.focusFirstElement(this.rightBodyTbl.rows[a]));else if(1!=this.focusFirstElement(this.focusElem?this.rightBodyTbl.rows[a].cells[this.focusElem.index]:this.rightBodyTbl.rows[a],!0))if(this.bTreegrid||this.fixedCol){var b=pega.util.Dom.getElementsById(this.rightBodyTbl.rows[a].id,
this.leftBodyUL,"LI")[0];this.focusFirstElement(b)||(b=this.rightBodyTbl.rows[a],this.focusFirstElement(b))}else b=this.rightBodyTbl.rows[a],this.focusFirstElement(b);this.focusElem=null}else if(a=this.rightBodyTbl.rows[a]){b=null;if(this.bTreegrid||this.fixedCol)b=pega.util.Dom.getElementsById(a.id,this.leftBodyUL,"LI")[0];var c=jQuery(b).find("ul\x3eli:nth-child(2)");c[0]||(c[0]=b);this.focusFirstElement(c[0],!0)||this.focusFirstElement(a,!0)||this.focusFirstElement(b,!0)}},focusFirstElement:function(a,
b){if(a){f.getFirstChild(a)&&"TD"===f.getFirstChild(a).nodeName&&"true"!==a.getAttribute("expanded")&&"TR"===a.nodeName&&!this.hasFocusableContent(f.getFirstChild(a))&&(f.getFirstChild(a).tabIndex="0");a=a.getElementsByTagName("*");for(var c=0;c<a.length;c++){var d=a[c],e=d.getBoundingClientRect(),g=!0;e&&(g=0<e.width&&0<e.height);if(!d.disabled&&g&&(e=d.nodeName,("A"===e||"BUTTON"===e||"SELECT"===e||"INPUT"===e||"TEXTAREA"===e||("TD"===e||"TH"===e||"SPAN"===e||"DIV"===e||"IMG"===e||"I"===e)&&-1!==
d.outerHTML.split("\x3e")[0].toUpperCase().indexOf("TABINDEX"))&&"hidden"!==d.type&&(d.currentStyle&&"hidden"!==d.currentStyle.visibility&&"none"!=d.currentStyle.display||window.getComputedStyle&&"hidden"!==window.getComputedStyle(d,"").visibility&&"none"!==window.getComputedStyle(d,"").display)&&0<d.offsetWidth&&(!b||"TD"!=e&&"A"!=e&&("SPAN"!=e||"pageIndex"!=d.className)))){try{d.focus()}catch(h){return!1}return!0}}}},focusLastElement:function(a,b){if(a){f.getFirstChild(a)&&"TD"===f.getFirstChild(a).nodeName&&
"true"!==a.getAttribute("expanded")&&"TR"===a.nodeName&&!this.hasFocusableContent(f.getFirstChild(a))&&(f.getFirstChild(a).tabIndex="0");"LI"==a.nodeName&&f.hasClass(a,"gridRow")&&(a=f.getFirstChild(a));a=a.getElementsByTagName("*");for(var c=a.length-1;0<=c;c--){var d=a[c];if(!d.disabled){var e=d.nodeName;if(!("A"!=e&&"BUTTON"!=e&&"SELECT"!=e&&"INPUT"!=e&&"TEXTAREA"!=e&&("TD"!=e&&"TH"!=e&&"SPAN"!=e&&"DIV"!=e&&"IMG"!=e&&"I"!=e||-1==d.outerHTML.split("\x3e")[0].toUpperCase().indexOf("TABINDEX"))||
"hidden"==d.type||!(d.currentStyle&&"hidden"!=d.currentStyle.visibility&&"none"!=d.currentStyle.display||window.getComputedStyle&&"hidden"!=window.getComputedStyle(d,"").visibility&&"none"!=window.getComputedStyle(d,"").display)||b&&("A"==e||"SPAN"==e&&"pageIndex"==d.className))){try{d.focus(),d.focus(),d.select&&d.select()}catch(g){return!1}return!0}}}}},focusFirstErrorField:function(a){if(this.bTreegrid||this.fixedCol){var b=f.getElementsByClassName("iconErrorDiv","DIV",pega.util.Dom.getElementsById(this.rightBodyTbl.rows[this.getIndex(a)].id,
this.leftBodyUL,"LI")[0]);if(b&&0<b.length)for(var c=0;c<b.length;c++)if("BLOCK"==b[c].style.display.toUpperCase()){this.focusFirstElement(b[c].parentNode);return}}if((b=f.getElementsByClassName("iconErrorDiv","DIV",this.rightBodyTbl.rows[this.getIndex(a)]))&&0<b.length)for(c=0;c<b.length;c++)if("BLOCK"==b[c].style.display.toUpperCase()){this.focusFirstElement(b[c].parentNode);break}},editInModal:function(a,b){b=k.getTarget(a);("keydown"!=a.type||"9"!=a.keyCode)&&"A"==b.tagName&&"iconExpandCollapse"==
b.parentNode.id||0>=this.getActiveRowIndex()||(this.refreshLayout=this.bRefreshOnUpdate,this.callProcessAction(a,b,this.templateName))},editInHarness:function(a,b){var c=k.getTarget(a);if("keydown"==a.type&&"9"==a.keyCode||"A"!=c.tagName||"iconExpandCollapse"!=c.parentNode.id){var d=this.findCell(a,b,c);if("undefined"!=typeof b){if(!d){this.bTopPriorityActionSet&&(this.bTopPriorityActionSet=!1,pega.c.actionSequencer.pause(),pega.c.actionSequencer.resume());return}b=this.getRowIndex(d)}else b=this.getActiveRowIndex();
if(b&&""!=b&&0!=b){d=!1;if(this.propRef){var e=pega.util.Dom.getElementsById(pega.ui.property.toHandle(this.propRef),this.rightBodyTbl,"TR");e&&(e=e[0].rowIndex,this.setActiveRow(null,null,e,!0),b==e&&(d=!0))}if("RLDel"==c.id)this.selectPage(null,null,b);else{var e=this.gridDetailsDiv&&"true"==this.gridDetailsDiv.getAttribute("StaleDetails"),g=this.propRef&&this.dataSourceRef&&-1==this.propRef.indexOf(this.dataSourceRef);0>=b||!f.getElementsById("pyFlowActionHTML",this.gridDetailsDiv)||e||!this.modalThreadContext||
""==this.modalThreadContext||!l.basePrimaryPageName||""==l.basePrimaryPageName||g?(e&&(this.gridDetailsDiv.removeAttribute("StaleDetails"),this.gridDetailsDiv.innerHTML=""),this.selectPage(null,null,b),this.bTopPriorityActionSet=this.refreshLayout=!1,this.callProcessAction(a,c,this.templateName),this.refreshLayout=this.bFilteredGrid?!0:this.refreshLayout):d?this.bTopPriorityActionSet&&(this.bTopPriorityActionSet=!1,pega.util.Event.isIE?window.setTimeout(function(){pega.c.actionSequencer.resume()},
0):pega.c.actionSequencer.resume()):(this.bTopPriorityActionSet=this.refreshLayout=!1,this.jumpToIndex(a,b),this.refreshLayout=this.bFilteredGrid?!0:this.refreshLayout)}}}},expandRowDetails:function(a,b,c){if((!this.threadProcessing||this.bReadOnlyShowDetails||this.bRODetails)&&this.bExpandMultipleRows||!(this.expandedElem&&f.isAncestor(this.rightBodyTbl,this.expandedElem)||!this.bFilteredGrid&&"true"==this.comingFromAdd)){a&&a.target&&a.target.rowIndex?this.selectPage(null,null,a.target.rowIndex):
this.selectPage(a,b);this.bShowExpandCollapseColumn&&(this.expandCollapseAnchor=c,f.removeClass(c,"expandRowDetails"),f.addClass(c,"collapseRowDetails"),c.setAttribute("alt",pega.u.d.fieldValuesList.get("enterToCollapse")),c.setAttribute("title",pega.u.d.fieldValuesList.get("enterToCollapse")));b=this.getRightRow();var d=b.id,e=null,g=f.getNextSibling(b);g&&(e=f.getElementsById("rowDetail"+d,g));e&&(e=e[0]);b.setAttribute("rowExpanded","true");e&&f.getElementsById("pyFlowActionHTML",e)?(g.style.display=
pega.util.Event.isIE&&10>pega.env.ua.ie?"block":"table-row",e.style.display="block",this.expDetailsHeight+=e.offsetHeight):(this.callProcessAction(a,c,this.templateName||"pyGridRowDetails"),l.inCall=!0);!this.threadProcessing&&this.bExpandMultipleRows?e?this.updateExpandStatus(null,"true",b):this.pushToQueue({type:"ExpandCollapse",handler:this.updateExpandStatusQueued,context:this,args:[null,"true",b]}):this.expandedElem=b}else b=f.isAncestor(this.leftBodyUL,target)?this.leftBodyUL:f.isAncestor(this.rightBodyTbl,
target)?this.rightBodyTbl:null,c=this.findCell(null,b,c),this.toBeExpanded=this.getRightRow(this.getRowIndex(c)),k.stopEvent(a),this.expandedElem&&f.isAncestor(this.rightBodyTbl,this.expandedElem)?this.handleEditItem({type:Grids.EVENT_CLICK,target:this.expandedElem},null,this.getIndex(this.expandedElem.rowIndex)):this.propRef&&""!=this.propRef&&(a=pega.ui.property.toHandle(this.propRef),(a=f.getElementsById(a,this.rightBodyTbl))&&0<a.length&&((a=f.getElementsByClassName("collapseRowDetails","A",a[0]))&&
0<a.length&&k.fireEvent(a[0],Grids.EVENT_CLICK),this.comingFromAdd=!1));this.setHeadersWidth();this.gridResized();this.autoAdjustProgressiveGridHeight({expandPane:"true"})},collapseRowDetails:function(a,b,c){a&&a.target&&a.target.rowIndex?this.threadProcessing||!this.bExpandMultipleRows?this.setActiveRow(null,null,a.target.rowIndex,!0):this.selectPage(null,null,a.target.rowIndex):this.selectPage(a,b);b=this.getRightRow();var d=b.id,e=f.getNextSibling(b);if(d=f.getElementsById("rowDetail"+d,e)){d=
d[0];if(!this.threadProcessing&&this.bExpandMultipleRows)b.removeAttribute("rowExpanded"),this.bShowExpandCollapseColumn&&(f.removeClass(c,"collapseRowDetails"),f.addClass(c,"expandRowDetails"),c.setAttribute("alt",pega.u.d.fieldValuesList.get("enterToExpand")),c.setAttribute("title",pega.u.d.fieldValuesList.get("enterToExpand"))),this.expDetailsHeight-=d.offsetHeight,e.style.display="none",d.style.display="none",this.focusElem=null,this.focusFirstElement(this.getLeftRow()),this.updateExpandStatus(null,
"false",b);else{if(!this.isLocked&&!this.bRODetails)var g=f.getElementsById("RowDetailsButtonSubmit",d,"BUTTON");if(!this.isLocked&&g&&0<g.length)g=g[g.length-1],k.stopEvent(a),g.disabled&&this.enableSaveDiscardButtons(null),this.toBeCollapsed=c,k.fireEvent(g,Grids.EVENT_CLICK);else{this.bShowExpandCollapseColumn&&(f.removeClass(c,"collapseRowDetails"),f.addClass(c,"expandRowDetails"),c.setAttribute("alt",pega.u.d.fieldValuesList.get("enterToExpand")),c.setAttribute("title",pega.u.d.fieldValuesList.get("enterToExpand")));
this.focusFirstElement(this.getLeftRow());this.rightBodyTbl.deleteRow(e.rowIndex);b.removeAttribute("rowExpanded");this.expandedElem=this.toBeCollapsed=null;this.comingFromAdd=this.DONOT_SUBMIT=!1;if("object"==typeof this.toBeExpanded&&this.toBeExpanded){a=this.toBeExpanded;c={type:Grids.EVENT_CLICK,target:a};this.handleEditItem(c,null,this.getIndex(a.rowIndex));return}if(this.toBeAdded&&""!=this.insertAction){this.resetExecutionThread();this.setModalAction(this.insertAction);this.performInsertAction();
return}}}this.setHeadersWidth();this.gridResized();this.triggerBrowserReflow();this.autoAdjustProgressiveGridHeight({expandPane:"true"})}else this.expandedElem=this.toBeCollapsed=null,this.comingFromAdd=this.DONOT_SUBMIT=!1,"object"==typeof this.toBeExpanded&&this.toBeExpanded&&(a=this.toBeExpanded,c={type:Grids.EVENT_CLICK,target:a},this.handleEditItem(c,null,this.getIndex(a.rowIndex)))},getAllExpanded:function(a){"undefined"==typeof a&&(a=0);for(var b,c=this.rightBodyTbl.rows,d=c.length,e,g=[];a<
d;a++)e=c[a],b=e.id,b="rowDetail"+b,(e=f.getElementsById(b,e,"DIV"))&&0<e.length&&(!0===e[0].getAttribute("expanded")||"true"===e[0].getAttribute("expanded"))&&g.push(e[0]);return g},adjustAllExpanded:function(a,b,c){if(pega.env.ua.gecko&&"undefined"!=typeof a&&a){"undefined"==typeof c&&(c=0);"undefined"==typeof b&&(b="expand");b="expand"===b;c=this.getAllExpanded(c);var d=c.length,e=a.parentNode.offsetHeight;"DELETE"==this.action&&(e+=pega.u.d.getRepeatRow(a,!0).offsetHeight);for(a=0;a<d;a++){var g=
c[a].parentNode;g.style.top=b?g.offsetTop+e+"px":g.offsetTop-e+"px"}}},callProcessAction:function(a,b,c){var d=pega.ui.HarnessContextMgr,e=pega.u.d.getSectionDiv(b);this.sectionName=e.getAttribute("NODE_NAME");"undefined"==typeof this.usingPage&&(this.usingPage=l.getBaseRef(e));!this.threadProcessing||this.editConfig!=this.EDIT_HARNESS&&this.editConfig!=this.EDIT_EXPANDPANE||this.resetExecutionThread();this.modalAction=this.gridDiv.getAttribute("editAction");var e=new SafeURL,g=this.getLeftRow(),
h=this.activeRow+this.getFirstLoadedRowIndex()-1;f.getPreviousSibling(g)&&""!=f.getPreviousSibling(g).id||e.put("PrevDisabled","true");this.bDiscardInvisibleRows&&1<h&&e.put("PrevDisabled","false");f.getNextSibling(g)||e.put("NextHide","true");this.bDiscardInvisibleRows&&h<this.totalRecords&&e.put("NextHide","false");this.editConfig==this.EDIT_EXPANDPANE&&this.bFilteredGrid&&"true"==this.comingFromAdd&&e.put("showOkCancel","true");a.skipPreProcessingActivity&&e.put("skipPreProcessingActivity","true");
this.propRef=pega.ui.property.toReference(g.id);e.put("rowPage",this.propRef);!this.editConfig||this.editConfig!=this.EDIT_HARNESS&&this.editConfig!=this.EDIT_EXPANDPANE||e.put("modelessDialog",!0);e.put("pyPropRef",this.propRef);e.put("pzHarnessID",pega.ctx.pzHarnessID);this.editConfig==this.EDIT_EXPANDPANE&&e.put("showSaveDiscard","true");this.editConfig==this.EDIT_HARNESS||this.editConfig==this.EDIT_EXPANDPANE||"pyGridRowDetails"==c?this.gridDiv.getAttribute("editConfig")==this.EDIT_READONLY&&
this.bShowExpandDetails&&e.put("ReadOnly","-1"):pega.ctx.activeGrid=this;this.setModalAction("");e.put("activeGridObj",this);this.bRODetails&&e.put("bRODetails","true");e.put("KeepMessages",l.KeepMessages);1==pega.u.d.topLevelPageErrors?e.put("TopLevelPageErrors","true"):e.put("TopLevelPageErrors","false");g=d.get("bWarnBeforeChangingWindow");e.put("UITemplatingStatus","N");d.set("bWarnBeforeChangingWindow",!1);"string"==typeof a.type?this.editConfig==this.EDIT_HARNESS?processAction(this.modalAction,
"","","","",!0,a,c,e,b,!0):processAction(this.modalAction,"","","","",!0,a,c,e,"",!0):processAction(this.modalAction,"","","","",!0,null,c,e,f.getFirstChild(this.gridDetailsDiv),!0);d.set("bWarnBeforeChangingWindow",g)},setModalAction:function(a){this.MODAL_ACTION=a},getModalAction:function(a){return this.MODAL_ACTION},submitModal:function(a,b){(pega.u.d.bModalDialogOpen&&pega.u.d.isAjaxInProgress()||pega.u.d.bModalDialogOpen&&pega.c&&pega.c.actionSequencer&&!pega.c.actionSequencer.isQueueEmpty())&&
"ModalButtonSubmit"==a.target.id||(this.isOpenLocalAction||this.__fromLocalAction||(b=this.templateName),pega.ctx.activeGrid=this,pega.u.d.closeChildOverLay(a)||(this.propRef&&this.propRef.length!=this.propRef.lastIndexOf(")")+1?pega.u.d.doModalAction(pega.u.d.submitModalDlgParam,a):(!b&&pega.u.d.submitModalDlgParam&&pega.u.d.submitModalDlgParam.gridTemplateName&&(b=pega.u.d.submitModalDlgParam.gridTemplateName),this.setModalAction("SUBMIT"),this.performModalAction(a,b))))},removeDummyRow:function(){var a=
pega.util.Dom.getElementsById("yui_modalrownew",this.gridDiv);if(a)for(var b=a.length,c=0;c<b;c++)a[c].parentNode.removeChild(a[c])},cancelModal:function(a,b){if(!(pega.u.d.bModalDialogOpen&&pega.u.d.isAjaxInProgress()||pega.u.d.bModalDialogOpen&&pega.c&&pega.c.actionSequencer&&!pega.c.actionSequencer.isQueueEmpty())||"ModalButtonCancel"!=a.target.id)if(this.isOpenLocalAction||this.__fromLocalAction||(b=this.templateName),this.isOpenLocalAction&&(this.DONOT_SUBMIT=!1),!pega.u.d.closeChildOverLay(a))if("true"==
this.comingFromAdd)this.setModalAction("REMOVELAST"),this.performModalAction(a,b);else{this.getFATemplateName(b);var c=this.editConfig==this.EDIT_HARNESS&&!this.isOpenLocalAction&&!this.__fromLocalAction,d=this.editConfig==this.EDIT_EXPANDPANE&&!this.isOpenLocalAction&&!this.__fromLocalAction;this.comingFromEditCancel=this.bFilteredGrid?!0:!1;this.gridDetailsDiv&&c&&(f.isAncestor(this.gridDetailsDiv,k.getTarget(a))||"JUMP"==this.getModalAction())||d?(this.DONOT_SUBMIT=!0,d&&this.selectPage(a,this.rightBodyTbl),
this.jumpToIndex(a,this.getActiveRowIndex(),b)):(pega.ctx.activeGrid=this,b="",this.modalAction&&(b=this.modalAction),this.setModalAction("CANCEL"),l.performFlowAction("",a,"",b,"",!0),this.refreshLayout&&(this.refreshLayout=!1))}},jumpToIndex:function(a,b,c){0<b&&(this.jumpIndex=b,this.setModalAction("JUMP"),this.performModalAction(a,c))},goToNext:function(a,b){this.isOpenLocalAction||this.__fromLocalAction||(b=this.templateName);pega.ctx.activeGrid=this;if(!pega.u.d.closeChildOverLay(a)){this.refreshLayout=
this.bRefreshOnUpdate;if(this.isLocked||this.bFilteredGrid){var c=this.getLeftRow();c.getAttribute("PL_INDEX");if(this.bTree||this.bTreegrid||this.isOpenLocalAction||this.editConfig==this.EDIT_HARNESS||this.editConfig==this.EDIT_MODAL||this.editConfig==this.EDIT_EXPANDPANE){if(c=pega.util.Dom.getElementsById(this.getNextGridRow(c).id,this.rightBodyTbl,"TR")[0].rowIndex,this.editConfig==this.EDIT_EXPANDPANE||this.bCategorizedGrid)c=this.getActiveRowIndexFromRowIndex(c)}else c=this.getNextGridRow(c).getAttribute("PL_INDEX");
this.jumpToIndex(a,c,b)}else this.setModalAction("NEXT"),this.performModalAction(a,b);this.refreshLayout=this.bFilteredGrid?!0:this.refreshLayout}},goToPrevious:function(a,b){this.isOpenLocalAction||this.__fromLocalAction||(b=this.templateName);pega.ctx.activeGrid=this;if(!pega.u.d.closeChildOverLay(a)){this.refreshLayout=this.bRefreshOnUpdate;if(this.isLocked||this.bFilteredGrid){var c=this.getLeftRow();c.getAttribute("PL_INDEX");if(this.bTree||this.bTreegrid||this.isOpenLocalAction||this.editConfig==
this.EDIT_HARNESS||this.editConfig==this.EDIT_MODAL||this.editConfig==this.EDIT_EXPANDPANE){if(c=pega.util.Dom.getElementsById(this.getPreviousGridRow(c).id,this.rightBodyTbl,"TR")[0].rowIndex,this.editConfig==this.EDIT_EXPANDPANE||this.bCategorizedGrid)c=this.getActiveRowIndexFromRowIndex(c)}else c=this.getPreviousGridRow(c).getAttribute("PL_INDEX");this.jumpToIndex(a,c,b)}else this.setModalAction("PREV"),this.performModalAction(a,b);this.refreshLayout=this.bFilteredGrid?!0:this.refreshLayout}},
addRow:function(a,b){pega.u.d.closeChildOverLay(a)||(this.setModalAction("ADD"),this.performModalAction(a,b))},insertBeforeModal:function(a){this.setModalAction("INSERTBEFORE");this.performInsertAction(a)},insertAfter:function(a){this.setModalAction("INSERTAFTER");this.performInsertAction(a)},appendLast:function(a){this.setModalAction("APPENDLAST");this.performInsertAction(a)},performInsertAction:function(a){if(this.editConfig==this.EDIT_MODAL&&pega.u.d.bModalDialogOpen)alert(NoModalInModal);else if(this.editConfig!=
this.EDIT_HARNESS||!this.gridDetailsDiv||l.shouldSubmitProceed(a,this.gridDetailsDiv)){if(this.editConfig==this.EDIT_EXPANDPANE&&!this.bExpandMultipleRows){var b=this.getRightRow();if(b&&(b=f.getNextSibling(b))&&!l.shouldSubmitProceed(a,b))return}b=this.gridDetailsDiv&&"true"==this.gridDetailsDiv.getAttribute("StaleDetails");if((this.editConfig==this.EDIT_HARNESS&&this.gridDetailsDiv&&!b||this.editConfig==this.EDIT_EXPANDPANE&&(this.threadProcessing||!this.bExpandMultipleRows))&&!this.notSubmitDetails&&
!this.bRODetails&&(b=this.editConfig==this.EDIT_HARNESS?f.getElementsById("ModalButtonSubmit",this.gridDetailsDiv,"BUTTON"):f.getElementsById("RowDetailsButtonSubmit",this.gridDiv,"BUTTON"))&&b[0]&&!b[0].disabled){this.addNewRow="true";this.addNewAction=this.getModalAction();this.addNewActiveRow=this.activeRow;var c=pega.ui.property.toHandle(this.propRef);(c=f.getElementsById(c,this.rightBodyTbl,"TR"))&&c[0]&&(c=c[0],c=c.rowIndex,this.activeRow!=c&&(this.activeRow=c));k.fireEvent(b[0],Grids.EVENT_CLICK)}this.editConfig!=
this.EDIT_HARNESS&&(this.editConfig!=this.EDIT_EXPANDPANE||!this.threadProcessing&&this.bExpandMultipleRows)||"true"!=this.addNewRow||(this.addNewRow="",this.notSubmitDetails=!1,this.selectRow(this.activeRow,!1),this.setModalAction(this.addNewAction),this.action=this.addNewAction,this.activeRow=this.addNewActiveRow,"ADDFIRSTCHILD"==this.addNewAction&&(b=this.getLeftRow(),c=document.createElement("UL"),c.id="gridNode",c.className="gridNode",b.appendChild(c)),this.addNewActiveRow=this.addNewAction=
"");this.resetInCall();if(this.editConfig==this.EDIT_EXPANDPANE&&(this.threadProcessing||!this.bExpandMultipleRows)&&this.expandedElem&&f.isAncestor(this.rightBodyTbl,this.expandedElem))this.toBeAdded=!0,this.insertAction=this.getModalAction(),k.stopEvent(a),this.handleEditItem({type:Grids.EVENT_CLICK,target:this.expandedElem},null,this.getIndex(this.expandedElem.rowIndex));else{this.toBeAdded=!1;this.insertAction=null;a=SafeURL_createFromURL(l.url);this.modalAction=this.gridDiv.getAttribute("editAction");
b=this.rightBodyTbl;this.baseThreadContext=l.getThreadName();"undefined"==typeof this.usingPage&&(this.usingPage=l.getBaseRef(b));a.put("BaseReference",this.usingPage);"APPENDLAST"==this.getModalAction()?(a.put("PageListProperty",this.getPLPGProperty()),this.bPageGroup?a.put("ClassName",b.getAttribute("PG_PROP_CLASS")):a.put("ClassName",b.getAttribute("PL_PROP_CLASS")),a.put("IndexInList",""),(0==this.getTableLength(this.rightBodyTbl)||1==this.getTableLength(this.rightBodyTbl)&&f.getElementsById("Grid_NoResults",
this.gridDiv))&&a.put("PrevDisabled","true"),a.put("NextHide","true")):(b=this.getLeftRow(),"ADDFIRSTCHILD"==this.getModalAction()?(a.put("PrevDisabled","true"),a.put("NextHide","true")):(c=this.activeRow+this.getFirstLoadedRowIndex()-1,"INSERTBEFORE"!=this.getModalAction()||f.getPreviousSibling(b)&&""!=f.getPreviousSibling(b).id||a.put("PrevDisabled","true"),this.bDiscardInvisibleRows&&"INSERTBEFORE"==this.getModalAction()&&1<c&&a.put("PrevDisabled","false"),f.getNextSibling(b)||"INSERTBEFORE"!=
this.getModalAction()&&a.put("NextHide","true"),this.bDiscardInvisibleRows&&"INSERTAFTER"==this.getModalAction()&&c<this.totalRecords&&a.put("NextHide","false")),b=this.getRightRow().id,this.propRef=pega.ui.property.toReference(b),a.put("pyPropRef",this.propRef),a.put("rowPage",this.propRef));this.bFilteredGrid&&a.put("ShowOnlyOKCancel","true");a.put("pyActivity","ShowStream");a.put("pyTargetStream","pzGridModalHTML");a.put("pyBasePage",a.get("pzPrimaryPageName"));a.put("Navigation",this.getModalAction());
a.put("NewTaskStatus",this.modalAction);a.put("FormError",pega.u.d.formErrorType);a.put("FieldError",pega.u.d.fieldErrorType);a.put("pyCustomError",pega.u.d.pyCustomError);this.baseThreadContext&&a.put("BaseThreadContext",this.baseThreadContext);a.put("isModalFlowAction","true");this.editConfig==this.EDIT_HARNESS?(a.put("ActionSection",this.templateName),a.put("modalSection",this.templateName)):this.editConfig==this.EDIT_EXPANDPANE?(a.put("ActionSection",this.templateName),a.put("modalSection",this.templateName),
a.put("showOkCancel","true")):(a.put("ActionSection",this.templateName),a.put("modalSection",this.templateName));if(this.bReportDefinition||this.pyPaginateActivity)b=this.bCBOptimize?this.getFirstLoadedRowIndex():(this.currentPageIndex-1)*this.rangeSize+1,a.put("startIndex",b);var d;if(this.bFilteredGrid&&(this.refreshLayout=!0,a.put("showFADetails","true"),a.put("pyGridFilterCriteriaPage",this.gridFilterPage),a.put("refreshLayout",this.refreshLayout),this.refreshLayoutFromConfig&&a.put("refreshLayoutFromConfig",
this.refreshLayoutFromConfig),a.put("partialRefresh","false"),d=l.getRefreshCallbackArgs(this.gridDiv),a.put("RenderSingle",d.paramName),this.currentPageIndex&&this.rangeSize)){if("Progressive Load"==this.pageMode)if(b=1,this.bDiscardInvisibleRows){a.put("bDiscardInvisibleRows","true");b=this.getFirstLoadedRowIndex();a.put("startIndex",b);var c=3*this.rangeSize,e=Math.ceil(this.totalRecords/this.rangeSize);"INSERTAFTER"==this.getModalAction()&&this.activeRow==this.getNoOfRowsLoaded()&&this.currentPageIndex<
e?(b+=this.rangeSize,this.currentPageIndex=Math.ceil(b/this.rangeSize)+1):"INSERTBEFORE"==this.getModalAction()&&this.activeRow==b&&2<this.currentPageIndex&&(b-=this.rangeSize,this.currentPageIndex=Math.ceil(b/this.rangeSize)+1);1==this.currentPageIndex&&(c=2*this.rangeSize);a.put("recordsInCurrentPage",c)}else a.put("recordsInCurrentPage",(this.currentPageIndex+1)*this.rangeSize);else b=(this.currentPageIndex-1)*this.rangeSize+1;a.put("startIndex",b);a.put("pyPageSize",this.rangeSize);this.returnResultCount&&
strActionSF.put("pyReturnResultCount",this.returnResultCount);this.pageMode&&a.put("pyPageMode",this.pageMode);a.put("currentPageIndex",this.currentPageIndex)}this.appendAct&&a.put("customAppendActivity",this.appendAct);this.bTreegrid&&a.put("bTreegrid",this.bTreegrid);this.bRODetails&&a.put("bRODetails","true");a.put("bIsModal","true");a.put("isPageGroup",this.bPageGroup);a.put("PrimaryPage",l.basePrimaryPageName);b=pega.u.d.getLayoutIndex(this.gridDiv);a.put("partialTrigger","editRow"+this.getConfiguredPLPGProperty()+
b);a.put("StreamName",this.sectionName);a.put("StreamClass","Rule-HTML-Section");"ACTION"!=pega.ctx.strHarnessMode&&a.put("HarnessType","NEW");(b=this.getLastRowToRetrieve())&&a.put("lastRowToRetrieve",b);l.setBusyIndicator(null,!1,!0);b={success:this.performInsertCallback,failure:function(a){pega.u.d.gBusyInd.hide()},scope:this};this.editConfig===this.EDIT_MODAL&&(b.preRenderer=pega.u.d.processActionModal_Pre_Success);b.argument=this.bFilteredGrid?[d.expandInnerDiv,d.expandElement,d.paramName,d.innerDivExists]:
[this];pega.u.d.modalDialog.innerElement.style.display="block";pega.ctx.activeGrid=this;l.asyncRequest("POST",a,b,"",void 0)}}},removeGridNoResultsMsg:function(){var a=f.getElementsById("Grid_NoResults",this.gridDiv);if(a){for(var b,c=0;c<a.length;c++)b=a[c],(this.bTreegrid||this.fixedCol)&&"UL"==b.parentNode.tagName&&(b.parentNode.style.height=""),(this.isElementFromSameGridContDiv(b)||"true"===this.bHideGridHdrWhenNoRows&&this.isElementFromSameGridDiv(b))&&b.parentNode.removeChild(b);"true"===this.bHideGridHdrWhenNoRows&&
this.toggleGridStylesForNoResultsCase()}},computeRightRow:function(){var a=f.getChildren(this.leftrowbefore);if(2==a.length){for(var a=a[1],b;;){var c=f.getLastChild(a);if(!c)break;if(c){b=f.getElementsById(c.id,this.rightBodyTbl,"TR")[0].rowIndex;if(1==f.getChildren(c).length)break;a=f.getChildren(c)[1]}}this.rightrowbefore=b?this.getRightRow(b):this.getRightRow()}else this.rightrowbefore=this.getRightRow()},createDummyRow:function(a){a=document.createElement("LI");a.id="yui_modalrownew";a.style.display=
"none";var b=document.createElement("TR");b.id="yui_modalrownew";b.style.display="none";this.oldActiveRow=this.getActiveRowIndex();if("INSERTAFTER"==this.getModalAction())this.leftrowbefore=this.getLeftRow(),this.bTreegrid||this.fixedCol?(this.computeRightRow(),f.insertAfter(a,this.leftrowbefore)):this.rightrowbefore=this.getRightRow(),f.insertAfter(b,this.rightrowbefore),this.selectRow(this.activeRow,!1),this.activeRow=b.rowIndex,this.action="INSERTAFTER";else if("INSERTBEFORE"==this.getModalAction())this.action=
"INSERTBEFORE",this.selectRow(this.activeRow,!1);else if("ADDFIRSTCHILD"==this.getModalAction()){this.action="ADDFIRSTCHILD";this.leftrowbefore=this.getLeftRow();var c=f.getChildren(this.leftrowbefore);this.rightrowbefore=this.getRightRow();c[1].appendChild(a);f.insertAfter(b,this.rightrowbefore);this.selectRow(this.activeRow,!1);this.activeRow=b.rowIndex}else(this.bTreegrid||this.fixedCol)&&this.leftBodyUL.appendChild(a),f.getFirstChild(this.rightBodyTbl).appendChild(b),this.bPageGroup&&this.activeRow&&
this.selectRow(this.activeRow,!1),this.activeRow=b.rowIndex,this.action="APPENDLAST";this.oldActiveRow||(this.oldActiveRow=b.rowIndex-1)},removeAppendedRow:function(){var a=this.activeRow,b=[this.leftBodyUL,this.rightBodyTbl];this.bTreegrid?this.updateTreeHandlesAfterDelete():this.editConfig==this.EDIT_EXPANDPANE?(this.bExpandMultipleRows||--a,pega.u.d.updateHandlesAfterDelete([a,b,this])):pega.u.d.updateHandlesAfterDelete([a-1,b,this]);var c=a;this.bPageGroup&&(c=pega.u.d.getNextRowSubscript(this.getRightRow()));
if(c)var d=this.callInitGridsAndFocusRow;b=[a,b,this.bPageGroup?"group":"list"];a={partialTrigger:"delete",index:a,domElement:[this.getLeftRow(),this.getRightRow()],domAction:"remove",beforeDomAction:this.loadGridRows,beforeDomActionContext:this,beforeParams:b,afterDomAction:d};this.loadRow("",a,this.gridDiv.parentNode,b,!0)},loadAppendedRow:function(a){this.activeRow=parseInt(this.activeRow);var b;b=this.editConfig==this.EDIT_EXPANDPANE&&1<arguments.length&&arguments[1].responseText?[this,this.activeRow,
arguments[1]]:[this,this.activeRow];var c=pega.u.d.getLayoutIndex(this.gridDiv);b={partialTrigger:"appendTo"+this.getConfiguredPLPGProperty()+c,beforeDomAction:this.loadGridForEdit,beforeDomActionContext:this,beforeParams:null,afterDomAction:this.submitRowCallback,afterParams:b,bTreegrid:this.bTreeGrid};if(this.activeRow)if(this.bTreegrid)if("INSERTBEFORE"==this.getModalAction())var d=this.getLeftRow(this.activeRow),e=this.getRightRow(this.activeRow);else if("INSERTAFTER"==this.getModalAction()||
"ADD"==this.getModalAction()){d=this.getLeftRow(this.activeRow);d=f.getNextSibling(d);if(!d){var g=d=this.getLeftRow(this.activeRow);if(d.parentNode!=this.leftBodyUL)for(d=d.parentNode;g&&!(c=g.parentNode.parentNode,g=f.getNextSibling(c));){if(g=c,g.parentNode==this.leftBodyUL){g=null;break}}else d=null}d&&d.id&&(e="gridNode"==d.id?g?f.getElementsById(g.id,this.rightBodyTbl)[0]:f.getFirstChild(this.rightBodyTbl):f.getElementsById(d.id,this.rightBodyTbl)[0])}else"ADDFIRSTCHILD"==this.getModalAction()&&
(d=this.getLeftRow(this.activeRow),d=f.getElementsById("gridNode",d,"UL")[0],(e=this.getRightRow(parseInt(this.activeRow,10)+1))||(e=f.getFirstChild(this.rightBodyTbl)));else"INSERTBEFORE"==this.getModalAction()?(d=this.getLeftRow(this.activeRow),e=this.getRightRow(this.activeRow)):(d=this.getLeftRow(this.activeRow+1),e=this.getRightRow(this.activeRow+1));"APPENDLAST"==this.getModalAction()||!d&&!e?(b.domElement=[this.leftBodyUL,f.getFirstChild(this.rightBodyTbl)],b.domAction="append"):(b.domElement=
[d,e],b.domAction="insert");d="";this.activeRow&&(d=this.activeRow);this.leftrowbefore=this.getLeftRow();this.postUpdate(d);this.bTreegrid&&"INSERTBEFORE"!=this.getModalAction()&&(d=e&&e.parentNode!=this.rightBodyTbl?e.rowIndex-1:"");e=[d,[this.leftBodyUL,this.rightBodyTbl],this.bPageGroup?"group":"list"];this.editConfig==this.EDIT_EXPANDPANE&&(a[1]=a[1].replace("expandRowDetails","collapseRowDetails"));this.loadRow(a[1],b,this.gridDiv.parentNode,e,!0)},performInsertCallback:function(a){var b=a.responseText.split("||ROWREFRESH||PEGA||PROCESSACTION||");
if(this.refreshLayout&&this.bFilteredGrid)this.comingFromAdd="true",l.handleLoadSuccess(a),l.gBusyInd.hide();else{a.responseText=b[0];if(this.editConfig==this.EDIT_HARNESS)l.processActionGridDetail_Success(a);else if(this.editConfig==this.EDIT_EXPANDPANE){var c=function(){pega.u.d.lazyLoadManager.detachBeforeLoad(c);return!1};pega.u.d.lazyLoadManager.attachBeforeLoad(c);this.loadAppendedRow(b,a)}else pega.ctx.activeGrid.bCalledFromGrid=!0,l.processActionModal_Success(a);this.editConfig==this.EDIT_HARNESS||
this.editConfig==this.EDIT_MODAL?this.loadAppendedRow(b):this.editConfig!=this.EDIT_EXPANDPANE&&window.setTimeout(function(){l.processActionGridDetail_Success(a)},200);this.comingFromAdd="true";"Progressive Load"==this.pageMode&&(this.gridPrevScrollTop=this.layoutWrapperDiv.scrollTop);this.bDoNotFocusFADetails&&this.focusOnNewEditableRow()}},getFATemplateName:function(a,b){if(a)return a;if(this.templateName)return this.templateName;var c;switch(this.editConfig){case this.EDIT_HARNESS:c="pyGridDetails";
break;case this.EDIT_EXPANDPANE:c="pyGridRowDetails";break;case this.EDIT_MODAL:c="pyGridModalTemplate"}b||c||(c="pyGridModalTemplate");return c},getNextGridRow:function(a){if(!a)return null;a=f.getNextSibling(a);if(!a)return null;a.id||this.editConfig!=this.EDIT_EXPANDPANE||"true"!=a.getAttribute("expanded")||(a=f.getNextSibling(a));this.bCategorizedGrid&&pega.util.Dom.hasClass(a,"grid-categorize-header")&&(a=f.getNextSibling(a));return a},getPreviousGridRow:function(a){if(!a)return null;a=f.getPreviousSibling(a);
if(!a)return null;!a.id&&(this.editConfig==this.EDIT_EXPANDPANE&&"true"==a.getAttribute("expanded")||this.bCategorizedGrid&&pega.util.Dom.hasClass(a,"grid-categorize-header"))&&(a=f.getPreviousSibling(a),"true"==a.getAttribute("expanded")&&(a=f.getPreviousSibling(a)));return a.id?a:null},getRowClass:function(a){return pega.util.Dom.hasClass(a,"oddRow")?"oddRow":"evenRow"},performModalAction:function(a,b){var c=this.getFATemplateName(b);b=this.getModalAction();var d=this.editConfig==this.EDIT_HARNESS&&
!this.isOpenLocalAction&&!this.__fromLocalAction,e=(this.editConfig==this.EDIT_EXPANDPANE||"pyGridRowDetails"==c)&&!this.isOpenLocalAction&&!this.__fromLocalAction;if(this.comingFromEditCancel||"NEXT"==b||"PREV"==b||"ADD"==b||"REMOVELAST"==b||"SUBMIT"==b&&d&&"Progressive Load"!=this.pageMode&&(!this.comingFromAdd||"false"==this.comingFromAdd))this.refreshLayout=!1;"REMOVELAST"!=b||!this.bFilteredGrid&&1!=this.getExpandPaneTableLength()||(this.refreshLayout=!0);"SUBMIT"==b&&this.bFilteredGrid&&"true"!==
this.refreshLayoutFromConfig&&(this.refreshLayout=!1);var g=d||e?this.gridDetailsThreadContext:this.modalThreadContext;this.threadProcessing&&"ERROR"!=b&&(l.switchThread(g),l.switchPrimaryPage("pyWorkPage"));d&&(this.modalAction=this.gridDiv.getAttribute("editAction"),""==this.propRef&&this.activeRow&&(this.propRef=this.getEntryHandle(this.activeRow)),this.propRef&&"true"!=this.comingFromAdd&&(g=pega.util.Dom.getElementsById(pega.ui.property.toHandle(this.propRef),this.rightBodyTbl,"TR")))&&(g=g[0].rowIndex,
this.setActiveRow(null,null,g));this.NO_UI||!e||this.threadProcessing||!(this.bExpandMultipleRows||!this.bExpandMultipleRows&&this.bDragDrop)||"SUBMIT"!=b&&"CANCEL"!=b&&"JUMP"!=b||(this.selectPage(a,this.rightBodyTbl),this.modalAction=this.gridDiv.getAttribute("editAction"),g=pega.util.Dom.getElementsById("rowDetail"+this.getRightRow().id,this.rightBodyTbl,"DIV")[0],g=pega.util.Dom.getElementsById("pyFlowActionHTML",g,"DIV")[0],this.propRef=this.getEntryHandle(this.activeRow),this.primaryPage=g.getAttribute("PRIM_PAGE"),
this.tempInterestPage=g.getAttribute("TEMP_BASE_REF"),this.modalThreadContext=g.getAttribute("THREAD_NAME"),this.usingPage=l.getBaseRef(this.rightBodyTbl));if(this.refreshLayout&&(g=pega.u.d.getSectionDiv(this.gridDiv)))var h=l.getQueryString(g);if(!this.NO_UI){var k=d?this.gridDetailsDiv:e?this.comingFromAdd?this.threadProcessing?this.rightBodyTbl.contains(this.gridDetailsDiv)?this.gridDetailsDiv:f.getElementsById("rowDetail"+this.getRightRow().id,this.rightBodyTbl)[0]:f.getElementsById("rowDetail"+
this.getRightRow().id,this.rightBodyTbl)[0]:f.getElementsById("rowDetail"+this.getRightRow().id,this.rightBodyTbl)[0]:pega.u.d.modalDialog.body;if(this.modalAction&&"REMOVELAST"!=this.getModalAction()&&!this.DONOT_SUBMIT&&!l.shouldSubmitProceed(a,k)){(d&&this.jumpIndex||e&&this.toBeExpanded&&!this.bExpandMultipleRows)&&this.propRef&&(g=pega.util.Dom.getElementsById(pega.ui.property.toHandle(this.propRef),this.rightBodyTbl,"TR"))&&(g=g[0].rowIndex)&&(h=this.jumpIndex?this.jumpIndex:this.getActiveRowIndexFromRowIndex(parseInt(this.toBeExpanded.rowIndex,
10)),this.selectRow(h,!1),this.selectPage(null,null,g));d&&""!=this.deleteGridRow&&(this.selectPage(null,null,this.activeRow),this.resetCustomDeleteRowProps(),pega.u.d.inCall&&this.resetInCall());return}(g=pega.util.Dom.getElementsById("RULE_KEY",k))?(g=g[0],g=l.getQueryString(g)):g=l.getQueryString(pega.u.d.modalDialog.body);h?h.copy(g):h=g}(a=void 0==a?window.event:a)&&"number"==typeof a.keyCode&&13==a.keyCode&&(pega.util.Event.stopPropagation(a),pega.util.Event.preventDefault(a));a=SafeURL_createFromURL(l.url);
this.bDataObject&&a.put("pyDeclarePage","true");a.put("pyActivity","ShowStream");a.put("pyTargetStream","pzGridModalHTML");a.put("pyBasePage",a.get("pzPrimaryPageName"));pega.ctx.bIsDCSPA||pega.ctx.isMDC?a.put("PrimaryPage",pega.ctx.basePrimaryPageName||pega.ctx.primaryPageName):a.put("PrimaryPage",l.basePrimaryPageName);this.editConfig&&a.put("editMode",this.editConfig);a.put("KeepMessages",l.KeepMessages);"undefined"!=typeof pega.ctx.KeepPageMessages&&a.put("pzKeepPageMessages",pega.ctx.KeepPageMessages);
1==pega.u.d.topLevelPageErrors?a.put("TopLevelPageErrors","true"):a.put("TopLevelPageErrors","false");this.editConfig==this.EDIT_EXPANDPANE&&a.put("showSaveDiscard","true");if("REMOVELAST"==b&&this.bFilteredGrid){var n=g=this.editConfig==this.EDIT_EXPANDPANE?f.getNextSibling(f.getNextSibling(this.getLeftRow())):f.getNextSibling(this.getLeftRow());g||(g=f.getPreviousSibling(this.getLeftRow()));g=g?this.bPageGroup?g.getAttribute("PG_SUBSCRIPT"):g.getAttribute("PL_INDEX"):"";n&&!this.bPageGroup&&""!=
g&&g--;g&&a.put("nextRowToSelect",g);this.bFilteredGrid&&this.editConfig==this.EDIT_HARNESS&&a.put("showNextFADetails","true")}"harness"!==this.editConfig||"SUBMIT"!==this.getModalAction()||!this.threadProcessing||this.isOpenLocalAction&&this.bNoThreadProcess||a.put("retainLock","true");"true"==this.bModalPageCancel&&a.put("bModalPageCancel",this.bModalPageCancel);this.isGridAction&&0==this.propertyClass.indexOf("Assign-")&&(a.put("ShowOnlyOKCancel",!0),a.put("GridAction","true"));this.modalThreadContext&&
a.put("pyBasePage",this.primaryPage);this.baseThreadContext&&(a.put("BaseThreadContext",this.baseThreadContext),pega.ui.ChangeTrackerMap.getTrackerByThread(this.baseThreadContext)&&a.put("BaseThreadAJAXTrackID",pega.ui.ChangeTrackerMap.getTrackerByThread(this.baseThreadContext).id));a.put("actionName",this.modalAction);a.put("ModalActionName",this.modalAction);this.tempInterestPage&&a.put("pyTempInterestPage",this.tempInterestPage);a.put("Navigation",this.getModalAction());this.editConfig!=this.EDIT_EXPANDPANE&&
this.editConfig!=this.EDIT_HARNESS||a.put("TaskStatus",this.gridDiv.getAttribute("editAction"));a.put("NewTaskStatus",this.modalAction);a.put("FormError",pega.u.d.formErrorType);a.put("FieldError",pega.u.d.fieldErrorType);a.put("pyCustomError",pega.u.d.pyCustomError);"JUMP"==b&&a.put("JumpToPage",this.getEntryHandle(this.jumpIndex));this.currentPageIndex&&""!=this.currentPageIndex&&(""==this.pyPaginateActivity&&(a.put("currentPageIndex",this.currentPageIndex),a.put("pyPageSize",this.rangeSize),this.bTreegrid?
a.put("currentPageSize",this.getTopLevelNodesLength()):a.put("currentPageSize",this.getDataRowSize())),this.returnResultCount&&strActionSF.put("pyReturnResultCount",this.returnResultCount),this.pageMode&&a.put("pageMode",this.pageMode),"Progressive Load"==this.pageMode&&(this.refreshLayout||this.bCBOptimize)?a.put("startIndex",this.getFirstLoadedRowIndex()):a.put("startIndex",(parseInt(this.currentPageIndex,10)-1)*parseInt(this.rangeSize,10)+1),a.put("totalRecords",this.totalRecords));"Progressive Load"==
this.pageMode&&this.bDiscardInvisibleRows&&a.put("bDiscardInvisibleRows","true");a.put("isModalFlowAction","true");d?(a.put("ActionSection",c),a.put("modalSection",c),"true"!=this.addNewRow&&"true"!=this.deleteGridRow||"SUBMIT"!=b||a.put("AvoidDetailsReload","true")):(a.put("ActionSection",c),a.put("modalSection",c));this.templateName&&a.put("MasterDetailTemplate",this.templateName);a.put("bIsModal","true");a.put("isPageGroup",this.bPageGroup);a.put("BaseReference",this.usingPage);a.put("PageListProperty",
this.getPLPGProperty());this.isOpenLocalAction||this.__fromLocalAction||a.put("bRODetails",this.bRODetails);c=this.rightBodyTbl;this.bPageGroup&&c&&(c=c.rows,g=this.activeRow,0<=g-1&&void 0!=c[g-1]&&void 0!=c[g-1].PG_SUBSCRIPT&&a.put("previous",c[g-1].PG_SUBSCRIPT),0<=g-2&&void 0!=c[g-2]&&void 0!=c[g-2].PG_SUBSCRIPT&&a.put("setPrevDisabled",c[g-2].PG_SUBSCRIPT),void 0!=c[g+1]&&void 0!=c[g+1].PG_SUBSCRIPT&&a.put("next",c[g+1].PG_SUBSCRIPT),void 0!=c[g+2]&&void 0!=c[g+2].PG_SUBSCRIPT&&a.put("setNextHide",
c[g+2].PG_SUBSCRIPT));c=this.getLeftRow();(g=pega.util.Dom.getElementsById("ModalNext",k,"BUTTON"))||a.put("NextHide","true");g&&g[0].disabled&&a.put("NextDisabled","true");this.isOpenLocalAction&&"NEXT"==b&&(a.put("NextDisabled","false"),n=this.activeRow+this.getFirstLoadedRowIndex()-1,this.bDiscardInvisibleRows&&n<this.totalRecords&&!this.bReadOnlyShowDetails&&a.put("NextDisabled","false"));this.bCategorizedGrid&&a.put("gridRowClass",this.getRowClass());this.isOpenLocalAction&&this.bNoThreadProcess&&
("NEXT"==b||"PREV"==b||"SUBMIT"==b)&&a.put("noThreadProcess","true");(n=pega.util.Dom.getElementsById("ModalPrevious",k,"BUTTON"))&&n[0].disabled&&a.put("PrevDisabled","true");if(this.bFilteredGrid){if("SUBMIT"!==b){if("JUMP"==b)if(n=this.getLeftRow(this.jumpIndex),parseInt(this.jumpIndex)>this.activeRow)var r=this.getNextGridRow(n);else var q=this.getPreviousGridRow(n);"NEXT"==b?r=this.getNextGridRow(this.getNextGridRow(c)):"PREV"==b&&(q=this.getPreviousGridRow(this.getPreviousGridRow(c)));!r&&("NEXT"==
b||"JUMP"==b&&parseInt(this.jumpIndex)>this.activeRow)?this.isOpenLocalAction?a.put("NextDisabled","true"):a.put("NextHide","true"):a.put("NextHide","false");!q&&("PREV"==b||"JUMP"==b&&parseInt(this.jumpIndex)<this.activeRow)?a.put("PrevDisabled","true"):a.put("PrevDisabled","false");this.isOpenLocalAction&&("PREV"==b||"JUMP"==b&&parseInt(this.jumpIndex)<this.activeRow)&&g&&g[0].disabled&&a.put("NextDisabled","false");1==this.jumpIndex&&a.put("PrevDisabled","true");this.jumpIndex==this.getExpandPaneTableLength()&&
(this.isOpenLocalAction?a.put("NextDisabled","true"):a.put("NextHide","true"))}a.put("curRowNum",this.getCurrentRowNum());a.put("bFilteredGrid",this.bFilteredGrid)}"JUMP"==b&&(f.getNextSibling(f.getNextSibling(c))||(a.put("NextDisabled","true"),a.put("NextHide","false")),parseInt(this.jumpIndex)<this.activeRow&&f.getPreviousSibling(c)&&a.put("NextDisabled","false"),a.put("JumpToIndex",this.jumpIndex),a.put("DNSUBMIT",this.DONOT_SUBMIT));a.put("InterestPage",this.primaryPage);"ACTION"!=pega.ctx.strHarnessMode&&
a.put("HarnessType","NEW");r=pega.u.d.getLayoutIndex(this.gridDiv);this.sectionName&&a.put("StreamName",this.sectionName);a.put("pyPropRef",this.propRef);a.put("rowPage",this.propRef);a.put("StreamClass","Rule-HTML-Section");a.put("gridAction","SUBMITROW");this.gridPreActivity&&a.put("gridPreActivity",this.gridPreActivity);this.gridPostActivity&&a.put("gridPostActivity",this.gridPostActivity);a.put("partialTrigger","editRow"+this.getConfiguredPLPGProperty()+r);a.put("EditRow","false");this.bFilteredGrid&&
a.put("pyGridFilterCriteriaPage",this.gridFilterPage);this.NO_UI?a.put("NO_UI","true"):pega.u.d.disableAllOtherButtons(null,d?this.gridDetailsDiv:e?k:pega.u.d.modalDialog.innerElement);l.setBusyIndicator(this.gridDiv,!1,!0);k=l.getRefreshCallbackArgs(this.gridDiv);this.refreshLayout&&(a.put("RenderSingle",k.paramName),a.put("editRowIndex",pega.ui.property.toHandle(this.propRef)),"Progressive Load"==this.pageMode&&a.put("recordsInCurrentPage",(this.currentPageIndex+1)*this.rangeSize));a.put("refreshLayout",
this.refreshLayout);(r=this.getLastRowToRetrieve())&&a.put("lastRowToRetrieve",r);d={success:this.performModalCallback,failure:function(a){pega.u.d.gBusyInd.hide()},argument:[k.expandInnerDiv,k.expandElement,k.paramName,k.innerDivExists,null,"reloadRepeat",d||e,this],scope:this};this.bFilteredGrid&&"JUMP"==b&&"Progressive Load"==this.pageMode&&parseInt(this.jumpIndex)<parseInt(this.originalTotalRecords)&&(a.put("NextDisabled","false"),b=this.noOfPagesLoaded*this.rangeSize,this.originalTotalRecords==
b&&this.jumpIndex==3*this.rangeSize&&a.put("NextDisabled","true"),this.bReportDefinition&&this.totalRecords==b-1&&this.jumpIndex==3*this.rangeSize-1&&a.put("NextDisabled","true"));"JUMP"==this.getModalAction()&&null==this.gridDiv.getAttribute("bFilteredGrid")&&(this.bFilteredGrid=!1,a.put("bFilteredGrid","false"));l.asyncRequest("POST",a,d,this.NO_UI&&!this.refreshLayout||"REMOVELAST"==this.getModalAction()||1==this.DONOT_SUBMIT?"":h,void 0)},getCurrentRowNum:function(){var a=this.getActiveRowIndex();
!this.currentPageIndex||""==this.currentPageIndex||""!=this.pyPaginateActivity||this.bReportDefinition||"Progressive Load"==this.pageMode&&!this.bDiscardInvisibleRows||(a=(this.currentPageIndex-1)*this.rangeSize+a);return a},replaceRowDetailDiv:function(a){var b=this.getRightRow(),c=f.getElementsById("rowDetail"+b.id,b)[0];f.getElementsById("rowDetailWrapper"+b.id,b)[0].replaceChild(a,c);a.style.display="block"},performModalCallback:function(a){var b=a.argument[6];if("JUMP"===this.getModalAction()){var c=
a.argument[7];pega.ui.EventsEmitter.publishSync("onUnloadOverlayClose",{inactiveTab:this.getRightRow(c.activeRow),layoutBody:c.gridDetailsDiv})}c=this.getModalAction();"true"==this.comingFromAdd&&(this.invokeAddDeleteRefresh=!0);this.comingFromEditCancel&&(this.comingFromEditCancel=!1);pega.u.d&&pega.u.d.nullifyComplexElementsInModal&&pega.u.d.nullifyComplexElementsInModal(["RTE"]);if("SUBMIT"==this.getModalAction()||"ADD"==this.getModalAction()){var d=f.getElementsById("Grid_NoResults",this.gridDiv);
if(d&&d[0]&&!e){var e=!this.isElementFromSameGridContDiv(d[0]);e||this.editConfig==this.EDIT_HARNESS&&(this.editConfig!=this.EDIT_HARNESS||!this.gridDetailsDiv||f.isAncestor(this.gridDetailsDiv,d[0]))||(this.removeGridNoResultsMsg(),this.activeRow--)}}e=a.responseText;if(-1<e.indexOf("||ROWREFRESH||PEGA||AVOIDDETAILSRELOAD||"))var g=!0,e=e.split("||ROWREFRESH||PEGA||AVOIDDETAILSRELOAD||");else e=e.split("||ROWREFRESH||PEGA||PROCESSACTION||");if(1==e.length&&"REMOVELAST"!=this.getModalAction())l.performFlowACallback(a),
"JUMP"==this.getModalAction()&&this.activeRow!=this.jumpIndex?(a=this.activeRow,this.activeRow=this.jumpIndex,this.selectPage(null,null,a)):""!=this.deleteGridRow&&(-1==e[0].indexOf("ERRORTABLE")&&this.selectPage(null,null,this.activeRow),this.resetCustomDeleteRowProps(),pega.u.d.inCall&&this.resetInCall()),this.addNewRow="";else{d="";if(-1<e[0].indexOf("||COMM||")){var h=e[0].split("||COMM||"),d=h[0].split("||");h[0]=d[0];var d=d[1],m=h[0];m&&(m=m.replace(/^\s+|\s+$/g,""));e[0]=h[1];h=SafeURL_createFromURL(pega.ctx.url);
h.put("pzTransactionId",m);if("undefined"!=typeof bRecordEvent){var n=bRecordEvent;bRecordEvent=!1}pega.ctx.url=h.toURL();pega.ctx.dom.getElementsByTagName("form")[0]&&(h=pega.ctx.dom.getElementsByTagName("form")[0].action,h=SafeURL_createFromURL(h),h.put("pzTransactionId",m),pega.ctx.dom.getElementsByTagName("form")[0].action=h.toURL());"undefined"!=typeof bRecordEvent&&(bRecordEvent=n)}if("SUBMIT"!=this.getModalAction()&&"REMOVELAST"!=this.getModalAction()||!this.refreshLayout){this.rightrowbefore=
this.getRightRow();this.leftrowbefore=this.getLeftRow();n=pega.u.d.getLayoutIndex(this.gridDiv);h={partialTrigger:"editRow"+this.getConfiguredPLPGProperty()+n,domElement:[this.leftrowbefore,this.rightrowbefore],domAction:"replace",beforeDomAction:this.loadGridForEdit,beforeDomActionContext:this,beforeParams:null,afterDomAction:this.submitRowCallback,afterParams:[this,this.activeRow],bTreegrid:this.bTreeGrid,sendSectionData:"true",bNotExpandRow:"JUMP"==this.getModalAction()?!0:!1};n=this.bNoThreadProcess;
m=this.isOpenLocalAction;"ADD"!=this.getModalAction()&&"PREV"!=this.getModalAction()&&"NEXT"!=this.getModalAction()&&"JUMP"!=this.getModalAction()&&(b?l.enableAllButtons(this.gridDetailsDiv):(pega.u.d.submitModalDlgParam&&"pyAttachContent"==pega.u.d.submitModalDlgParam.taskStatus&&pega.c.activeAttachElement&&pega.c.activeAttachEventObj&&"undefined"!=typeof pega.c.activeAttachElement.attr("data-upload")&&(pega.c.activeAttachElement.attr("data-click",pega.c.activeAttachElement.attr("data-upload")),
pega.c.eventController.handler(pega.c.activeAttachEventObj)),l.hideModalWindow(),l.processModalCallbak("CLOSE"),r=document.getElementById("modalContent"),p=document.getElementById("modaldialog_bd"),this.editConfig==this.EDIT_MODAL&&(r||p)&&"REMOVELAST"==this.getModalAction()&&(r&&(r.innerHTML=""),p&&(p.innerHTML=""))),l.gBusyInd.hide());if("REMOVELAST"!=this.getModalAction()&&!this.DONOT_SUBMIT){if(this.editConfig==this.EDIT_EXPANDPANE&&"SUBMIT"==this.getModalAction()){var r=this.getRightRow(),q=
f.getElementsById("rowDetail"+r.id,this.rightBodyTbl);q&&(q=q[0]);q&&this.threadProcessing&&(pega.env.ua.ie?(k.removeListener(q,"focusin",this.setExecutionThread),k.removeListener(q,"focusout",this.resetExecutionThread)):(q.removeEventListener("focus",this.wrapperSetET,!0),q.removeEventListener(Grids.EVENT_CLICK,this.wrapperSetET,!0),q.removeEventListener("blur",this.wrapperReSetET,!0)))}e[0]&&this.loadRow(e[0],h,this.gridDiv.parentNode);this.bDiscardInvisibleRows&&"SUBMIT"==this.getModalAction()&&
"true"==this.comingFromAdd&&this.totalRecords++;if(this.threadProcessing||!this.bExpandMultipleRows)if(q&&(this.expandedElem=null,h=q.parentNode.parentNode,h.parentNode.removeChild(h)),this.toBeCollapsed&&"object"==typeof this.toBeCollapsed){f.removeClass(this.toBeCollapsed,"collapseRowDetails");f.addClass(this.toBeCollapsed,"expandRowDetails");this.editConfig!=this.EDIT_HARNESS&&"undefined"!=typeof this.modalThreadContext&&""!=this.modalThreadContext&&this.modalThreadContext!=this.baseThreadContext&&
this.threadProcessing&&(l.switchThread(this.baseThreadContext),l.switchPrimaryPage(l.basePrimaryPageName),d=SafeURL_createFromURL(l.url),d.put("pyActivity","removeThead"),d.put("threadName",this.modalThreadContext),l.asyncRequest("POST",d));this.expandedElem=this.toBeCollapsed=null;this.toBeAdded&&this.insertAction||(this.comingFromAdd=!1);if("object"==typeof this.toBeExpanded&&this.toBeExpanded){a=this.toBeExpanded;this.handleEditItem({type:Grids.EVENT_CLICK,target:a},null,this.getIndex(a.rowIndex));
return}if(this.toBeAdded&&""!=this.insertAction){this.resetExecutionThread();this.setModalAction(this.insertAction);this.performInsertAction();return}"SUBMIT"==this.getModalAction()&&this.selectPage(null,null,this.activeRow);this.autoAdjustProgressiveGridHeight();return}if("SUBMIT"==this.getModalAction()||"ERROR"==this.getModalAction())this.selectPage(null,null,this.getIndex(this.activeRow)),this.isGridAction&&0==this.propertyClass.indexOf("Assign-")&&"FlowAction"==d&&this.disableRow()}"ADD"!=this.getModalAction()&&
"true"==this.comingFromAdd&&(this.comingFromAdd="false");if("JUMP"==this.getModalAction())this.selectPage(null,null,this.getIndex(this.jumpIndex)),this.synchScrollsWithModal();else if("NEXT"==this.getModalAction())q=this.getNextGridRow(this.getLeftRow()),!q&&this.bDiscardInvisibleRows?(q=this.activeRow+this.getFirstLoadedRowIndex()-1,q<this.totalRecords&&this.activeRow++):(q=pega.util.Dom.getElementsById(q.id,this.rightBodyTbl,"TR")[0],this.selectPage(null,null,q.rowIndex)),this.synchScrollsWithModal();
else if("PREV"==this.getModalAction())q=this.getPreviousGridRow(this.getLeftRow()),!q&&this.bDiscardInvisibleRows?(q=this.activeRow+this.getFirstLoadedRowIndex()-1,1<q&&this.activeRow--):(q=pega.util.Dom.getElementsById(q.id,this.rightBodyTbl,"TR")[0],this.selectPage(null,null,q.rowIndex)),this.synchScrollsWithModal();else if("ADD"==this.getModalAction())q=a.responseText.indexOf("||ROWREFRESH||PEGA||PROCESSACTION||")+35,a.responseText=a.responseText.substring(q),a.argument[0]=a.argument[a.argument.length-
1],this.performInsertCallback(a),this.comingFromAdd="true";else if("REMOVELAST"==this.getModalAction())this.editConfig!=this.EDIT_HARNESS&&"undefined"!=typeof this.modalThreadContext&&""!=this.modalThreadContext&&this.modalThreadContext!=this.baseThreadContext&&this.threadProcessing&&(l.switchThread(this.baseThreadContext),l.switchPrimaryPage(l.basePrimaryPageName),d=SafeURL_createFromURL(l.url),d.put("pyActivity","removeThead"),d.put("threadName",this.modalThreadContext),l.asyncRequest("POST",d)),
this.editConfig==this.EDIT_EXPANDPANE&&(q=f.getElementsById("rowDetail"+this.getRightRow().id,this.rightBodyTbl)[0],this.threadProcessing||!this.bExpandMultipleRows)&&(h=q.parentNode.parentNode,h.parentNode.removeChild(h)),this.removeAppendedRow(),this.selectPage(null,null,this.activeRow),this.comingFromAdd="false";else if("SUBMIT"==this.getModalAction()&&!n){if((this.editConfig!=this.EDIT_HARNESS||m)&&"undefined"!=typeof this.modalThreadContext&&""!=this.modalThreadContext&&this.modalThreadContext!=
this.baseThreadContext&&this.threadProcessing){if(m||this.editConfig==this.EDIT_MODAL)d=pega.u.d.bModalDialogOpen,pega.u.d.bModalDialogOpen=!0,pega.c.actionSequencer.clearQueue(),pega.u.d.bModalDialogOpen=d;l.switchThread(this.baseThreadContext);l.switchPrimaryPage(l.basePrimaryPageName);d=SafeURL_createFromURL(l.url);d.put("pyActivity","removeThead");d.put("threadName",this.modalThreadContext);l.asyncRequest("POST",d)}"true"==this.comingFromAdd&&(this.editConfig==this.EDIT_EXPANDPANE&&(q=f.getElementsById("rowDetailyui_modalrownew",
this.rightBodyTbl)[0],this.threadProcessing||!this.bExpandMultipleRows)&&(h=q.parentNode.parentNode,h.parentNode.removeChild(h)),this.removeAppendedRow(),q&&!this.threadProcessing&&this.bExpandMultipleRows&&(r=this.getRightRow(),d=this.getLeftRow(),(d=this.fixedCol?f.getElementsByClassName("expandRowDetails","LI",d):f.getElementsByClassName("expandRowDetails","TD",r))&&d[0]&&(f.removeClass(d[0],"expandRowDetails"),f.addClass(d[0],"collapseRowDetails")),q.id="rowDetail"+r.id,q.parentNode.id="rowDetailWrapper"+
r.id,this.replaceRowDetailDiv(q)),this.selectRow(pega.ctx.indexInList,!0),this.focusOnNewEditableRow());this.action="";this.comingFromAdd="false";this.synchScrollsWithModal()}this.rightrowbefore=this.leftrowbefore=this.action="";this.DONOT_SUBMIT=!1;q=e[0];d=document.createDocumentFragment();n=document.createElement("DIV");n.style.display="none";d.appendChild(n);n.innerHTML=q;l.handleFormErrors(n);a.responseText=e[1];if("ADD"==this.getModalAction()||"PREV"==this.getModalAction()||"NEXT"==this.getModalAction()||
"JUMP"==this.getModalAction()||this.editConfig==this.EDIT_EXPANDPANE&&("SUBMIT"==this.getModalAction()||this.NO_UI)||b&&!g)this.editConfig!=this.EDIT_EXPANDPANE||!this.threadProcessing&&this.bExpandMultipleRows||this.getModalAction(),g=""==e[1],b||this.editConfig==this.EDIT_EXPANDPANE&&"SUBMIT"==this.getModalAction()?!g&&a.responseText&&(a.argument[0]=this,l.processActionGridDetail_Success(a)):"true"!=this.comingFromAdd&&(pega.ctx.activeGrid.bCalledFromGrid=!0,l.processActionModal_Success(a));"REMOVELAST"==
c&&b&&this.editConfig==this.EDIT_HARNESS&&(this.DONOT_SUBMIT=!0,this.jumpToIndex(null,this.getActiveRowIndex()));pega.u.d.inCall&&this.resetInCall();!this.invokeAddDeleteRefresh||"SUBMIT"!=this.getModalAction()&&"REMOVELAST"!=this.getModalAction()||(this.invokeAddDeleteRefresh=!1,a={},a.listName=this.getPLPGProperty(),a.listBaseRef=this.baseRef,a.listprimaryPage=this.primPage,pega.u.d.triggerAddDeleteRefreshSections(a));this.editConfig!=this.EDIT_HARNESS&&(this.editConfig!=this.EDIT_EXPANDPANE||!this.threadProcessing&&
this.bExpandMultipleRows)||"true"!=this.addNewRow||(this.notSubmitDetails=!0,this.performInsertAction());this.editConfig==this.EDIT_HARNESS&&"true"==this.deleteGridRow&&(this.notSubmitDetails=!0,this.selectPage(null,null,this.deleteGridRowIndex),this.remove(this.getActiveRowIndex()));"SUBMIT"!=c&&"ERROR"!=c||this.focusFirstElement(this.rightBodyTbl.rows[this.getIndex(this.activeRow)]);this.autoAdjustProgressiveGridHeight()}else{"undefined"!=typeof this.modalThreadContext&&""!=this.modalThreadContext&&
this.modalThreadContext!=this.baseThreadContext&&this.threadProcessing&&(l.switchThread(this.baseThreadContext),l.switchPrimaryPage(l.basePrimaryPageName));l.handleLoadSuccess(a);if(this.editConfig===this.EDIT_MODAL||this.action===this.FLOW_ACTION)l.hideModalWindow(),l.processModalCallbak("CLOSE");var r=document.getElementById("modalContent"),p=document.getElementById("modaldialog_bd");this.editConfig==this.EDIT_MODAL&&(r||p)&&"REMOVELAST"==this.getModalAction()&&(r&&(r.innerHTML=""),p&&(p.innerHTML=
""));this.editConfig!=this.EDIT_HARNESS&&"undefined"!=typeof this.modalThreadContext&&""!=this.modalThreadContext&&this.modalThreadContext!=this.baseThreadContext&&this.threadProcessing&&(l.switchThread(this.baseThreadContext),l.switchPrimaryPage(l.basePrimaryPageName),d=SafeURL_createFromURL(l.url),d.put("pyActivity","removeThead"),d.put("threadName",this.modalThreadContext),l.asyncRequest("POST",d));l.gBusyInd.hide()}}},setExecutionThread:function(a){if(a=pega.util.Dom.getElementsById("pyFlowActionHTML",
this.gridDetailsDiv,"DIV"))a=a[0],a=a.getAttribute("THREAD_NAME"),l.switchThread(a),l.switchPrimaryPage("pyWorkPage")},resetExecutionThread:function(a){if(a){var b=k.getTarget(a);if(a.type==Grids.EVENT_CLICK&&(f.isAncestor(this.gridDetailsDiv,b)||this.isTargetComplexProperty(b)))return;if("blur"==a.type||"focusout"==a.type||"mouseout"==a.type){var c=document.activeElement,d=window.navigator.userAgent;if(d.match(/safari/i)&&!d.match(/chrome/i)&&c&&"BODY"==c.tagName||"mouseout"!=a.type&&f.isAncestor(this.gridDetailsDiv,
c)||(b="mouseout"==a.type?c:b)&&'["AutoComplete"]'==b.getAttribute("data-ctl")&&(b=b.AutoComplete.div,f.hasClass(b,"autocomplete_main")&&"visible"==b.style.visibility||"mouseout"!=a.type&&this.isTargetComplexProperty(c)))return}}c=null;this.gridDetailsDiv&&(c=pega.util.Dom.getElementsById("pyFlowActionHTML",this.gridDetailsDiv,"DIV"));null!=c&&(c=c[0].getAttribute("THREAD_NAME"),b=!1,pega.env.ua.ie&&a&&"focusout"==a.type&&document.activeElement&&this.gridDetailsDiv&&!f.isAncestor(this.gridDetailsDiv,
document.activeElement)&&(b=!0),c!=l.getThreadName()||a&&f.isAncestor(this.gridDetailsDiv,a.target)&&c==l.getThreadName()&&!b||l.insertButton&&a&&f.isAncestor(this.gridDetailsDiv,l.insertButton)&&document.getElementById("modalOverlay")&&f.isAncestor(document.getElementById("modalOverlay"),a.target)||l.fromFilterPopover&&f.isAncestor(this.gridDetailsDiv,l.fromFilterPopover)||((a=l.baseThreadName)||(a=pega.ctx.isMDC&&pega.ctx.dom.isInContext(this.gridDiv)&&this.baseThreadContext?this.baseThreadContext:
l.getThreadName()),l.switchThread(a),(a=l.basePrimaryPageName)||(a=SafeURL_createFromURL(l.url).get("pzPrimaryPageName")),l.switchPrimaryPage(a)))},postUpdate:function(a){if(""!=a&&("INSERTBEFORE"==this.action||f.getNextSibling(this.leftrowbefore)&&"INSERTAFTER"==this.action)){var b=[this.leftBodyUL,this.rightBodyTbl];this.bTreegrid?this.bTreegrid&&"APPENDLAST"!=this.action&&this.updateTreeHandlesAfterInsert(a):"INSERTBEFORE"==this.action?pega.u.d.updateHandlesAfterInsert([a-1,b,this]):pega.u.d.updateHandlesAfterInsert([a,
b,this])}},editRow:function(a,b,c){var d=k.getTarget(a);if("A"!=d.tagName||"iconExpandCollapse"!=d.parentNode.id){var e=this.getPageIndex(a,b);e&&-1!=e||(e=c);if(!(0>=e)){if(c=this.findCell(a,b,d))this.focusElem=b==this.leftBodyUL?{index:this.getCellIndex(c),tag:"LI"}:{index:c.cellIndex,tag:c.nodeName};b=this.rightBodyTbl.rows[this.getIndex(this.activeRow)];if(!pega.util.Dom.hasClass(b,"editMode")){if(this.editableIndex&&0<this.editableIndex){var d=!1,g=this.rightBodyTbl.rows[this.getIndex(this.editableIndex)];
g&&pega.util.Dom.hasClass(g,"editMode")?d=!0:(this.bTreegrid||this.fixedCol)&&(g=pega.util.Dom.getElementsById(g.id,this.leftBodyUL,"LI")[0])&&pega.util.Dom.hasClass(g,"editMode")&&(d=!0);if(d){this.selectRow(this.activeRow,!1);this.activeRow=this.editableIndex;this.selectRow(this.activeRow,!0);this.focusOnNewEditableRow();return}}this.rightrowbefore=b;if(this.bTreegrid||this.fixedCol)this.leftrowbefore=pega.util.Dom.getElementsById(this.rightrowbefore.id,this.leftBodyUL,"LI")[0];b=new SafeURL;b.put("PageListProperty",
this.getPLPGProperty());this.bPageGroup?(d=this.rightrowbefore.getAttribute("PG_SUBSCRIPT"),b.put("Subscript",d)):(d=this.rightrowbefore.getAttribute("PL_INDEX"),b.put("IndexInList",d),b.put("strIndexInList",d));b.put("gridAction",this.EDIT_ACTION);this.gridPreActivity&&b.put("gridPreActivity",this.gridPreActivity);this.gridPostActivity&&b.put("gridPostActivity",this.gridPostActivity);b.put("pyPropRef",pega.ui.property.toReference(this.rightrowbefore.id));b.put("EditRow","true");this.bFilteredGrid&&
b.put("curRowNum",this.getCurrentRowNum());(this.bReportDefinition||this.pyPaginateActivity)&&b.put("startIndex",(this.currentPageIndex-1)*this.rangeSize+1);d=pega.u.d.getLayoutIndex(this.gridDiv);d={partialTrigger:"editRow"+this.getConfiguredPLPGProperty()+d,domElement:[this.leftrowbefore,this.rightrowbefore],domAction:"replace",beforeDomAction:this.loadGridForEdit,beforeDomActionContext:this,beforeParams:null,afterDomAction:this.editRowCallback,afterParams:[this,this.activeRow],leftRowBefore:this.leftrowbefore,
rightRowBefore:this.rightrowbefore,sendSectionData:"true"};this.editConfig==this.EDIT_ROW&&delete d.sendSectionData;b.put("KeepGridMessages",!0===pega.u.d.KEEP_GRID_MESSAGES?"true":"false");e=[this.getPLPGProperty(),e];b=b.toQueryString();l.reloadRepeatLayout("pzdoGridAction",b,a,e,c,d,!0);this.editableIndex=this.activeRow}}}},editRowCallback:function(a){var b=a[0],c=a[2];b.activeRow=a[1];if(!b||b.activeRow)b.selectRow(b.activeRow,!0),c||b.focusOnNewEditableRow(),this.editConfig==this.EDIT_ROW?(b.setbAJAXFromEditableRow=
function(a){b.bAJAXFromEditableRow=b.getRightRow()!==a&&pega.util.Dom.isAncestor(b.getRightRow(),a)||b.getLeftRow()!==a&&pega.util.Dom.isAncestor(b.getLeftRow(),a)},pega.u.d.attachOnload(b.setbAJAXFromEditableRow,!0)):this.editConfig==this.EDIT_EXPANDPANE&&4==a.length&&l.processActionGridDetail_Success(a[3])},isElementDirty:function(a){for(var b=["input","textarea","select"],c=0;c<b.length;c++){var d;if((d=a.getElementsByTagName(b[c]))&&0<d.length)for(var e=d.length,g=0;g<e;g++){var h=d[g];if("TEXTAREA"==
h.tagName&&0==h.id.indexOf("PEGACKEDITOR")&&CKEDITOR&&CKEDITOR.instances[h.id]&&CKEDITOR.instances[h.id].checkDirty())return CKEDITOR.instances[h.id].updateElement(),!0;if("none"!=h.style.display&&("text"==h.type||"number"==h.type||"decimal"==h.type||"TEXTAREA"==h.tagName)){if(h.value!=h.defaultValue)return!0}else if("checkbox"==h.type||"radio"==h.type){if(h.checked!=h.defaultChecked)return!0}else if("SELECT"==h.tagName){for(var k=h.options,l=k.length,r=!1,q=0;q<l;q++){var p=k[q];if(p.defaultSelected&&
(r=!0,!p.selected))return!0}if(!r&&0<l){if(!k[0].selected)return!0;if(h.getAttribute("fixedwidth")&&"true"==h.getAttribute("fixedWidth")){if(this.leftrowbefore&&(a=f.getElementsById(h.id,this.leftrowbefore))&&a[0]&&a[0].value!=h.value)return!0;this.rightrowbefore&&f.getElementsById(h.id,this.rightrowbefore);return!0}}}}}return!1},checkRowIsDirty:function(){var a=this.getActiveRowIndex(),a=this.rightBodyTbl.rows[this.getIndex(a)];if(1==this.isElementDirty(a))return!0;if(this.bTreegrid||this.fixedCol)return a=
pega.util.Dom.getElementsById(a.id,this.leftBodyUL,"LI")[0],this.isElementDirty(a)},isDirty:function(){return this.dirty},markAsDirty:function(){this.dirty=!0},callUnregDD:function(){this.gridRowDDInst&&(this.gridRowDDInst.unreg(),this.gridRowDDInst=null)},submitRow:function(a,b,c,d){if(this.editConfig===this.EDIT_ROW&&b&&0<b.scrollLeft)return this.resetInCall(),!0;try{if(1==d)var e=!0;if(!this.activeRow)return this.resetInCall(),!0;var g;g=f.isAncestor(this.leftBodyUL,b)?this.leftBodyUL:f.isAncestor(this.rightBodyTbl,
b)?this.rightBodyTbl:null;if(this.hScrollDiv==b||f.isAncestor(this.hScrollDiv,b)||this.vScrollDiv==b||f.isAncestor(this.vScrollDiv,b))this.resetInCall();else{if(g&&"BUTTON"!=b.tagName&&"A"!=b.tagName&&"keypress"!=a&&"13"!=c){var h=this.findCell(null,g,b);if(h){var k=this.getRowIndex(h);if(!e&&k==this.activeRow&&"9"!=c){this.resetInCall();return}}}try{if(this.isTargetComplexProperty(b)||this.isElementLayeredAboveGrid(b)){this.resetInCall();return}}catch(D){}var n=this.rightBodyTbl.rows[this.getIndex(this.activeRow)],
r;if(this.bTreegrid||this.fixedCol)r=pega.util.Dom.getElementsById(n.id,this.leftBodyUL,"LI")[0];if(!r&&!n||n&&!pega.util.Dom.hasClass(n,"editMode"))this.resetInCall();else{var q=this.submitErrors?!0:this.checkRowIsDirty();this.bAJAXFromEditableRow&&(q||(q=!0),this.bAJAXFromEditableRow=!1,pega.u.d.detachOnload(this.setbAJAXFromEditableRow));if(q||!this.leftrowbefore&&!this.rightrowbefore||null!=this.gridcontDiv.getAttribute("editRowIndex")&&""!=this.gridcontDiv.getAttribute("editRowIndex")){this.markAsDirty();
var p=new SafeURL;p.put("PageListProperty",this.getPLPGProperty());p.put("refreshLayout",this.bRefreshOnUpdate?"true":"false");if(this.bPageGroup){var t=null!=this.gridcontDiv.getAttribute("editRowIndex")&&""!=this.gridcontDiv.getAttribute("editRowIndex")?f.getElementsById(this.gridcontDiv.getAttribute("editRowIndex"),this.rightBodyTbl)[0].getAttribute("PG_SUBSCRIPT"):this.getRightRow().getAttribute("PG_SUBSCRIPT");p.put("Subscript",t)}else{var v=this.getRightRow().getAttribute("PL_INDEX");p.put("IndexInList",
v);p.put("strIndexInList",v)}p.put("EditRow","false");p.put("pyPropRef",pega.ui.property.toReference(n.id));this.bFilteredGrid&&p.put("curRowNum",this.getCurrentRowNum());this.bRefreshOnUpdate&&(p.put("editRowIndex",this.getLeftRow().id),this.currentPageIndex&&""!=this.currentPageIndex&&(p.put("currentPageIndex",this.currentPageIndex),this.returnResultCount&&p.put("pyReturnResultCount",this.returnResultCount),this.pageMode&&p.put("pyPageMode",this.pageMode),p.put("pyPageSize",this.rangeSize),"Progressive Load"==
this.pageMode?(p.put("startIndex","1"),p.put("recordsInCurrentPage",(this.currentPageIndex+1)*this.rangeSize)):p.put("startIndex",(parseInt(this.currentPageIndex,10)-1)*parseInt(this.rangeSize,10)+1)),this.bFilteredGrid&&p.put("pyGridFilterCriteriaPage",this.gridFilterPage));(this.bReportDefinition||this.pyPaginateActivity)&&p.put("startIndex",(this.currentPageIndex-1)*this.rangeSize+1);var u=pega.u.d.getLayoutIndex(n),w={partialTrigger:"editRow"+this.getConfiguredPLPGProperty()+u,domElement:[r,n],
domAction:"replace",beforeDomAction:this.loadGridForEdit,beforeDomActionContext:this,beforeParams:null,afterDomAction:this.submitRowCallback,afterParams:[this,this.activeRow],sendSectionData:"true"},x=[this.getPLPGProperty(),this.activeRow];if("undefined"!=typeof pega.ctx.bClientValidation&&pega.ctx.bClientValidation&&"function"==typeof validation_validate&&(this.leftBodyUL&&!validation_validate(this.leftBodyUL)||!validation_validate(this.rightBodyTbl)))if(this.selectRow(this.activeRow,!0),pega.u.d.eventsArray=
[],this.submitErrors=!0,"undefined"!=typeof customClientErrorHandler){h=!1;if(!pega.u.d.modalDialog.body.contains(b)||pega.u.d.modalDialog.body.contains(this.gridDiv))h=customClientErrorHandler();if(h)return this.callUnregDD(),this.resetInCall(),"keypress"!=a?!1:!0}else return this.callUnregDD(),pega.u.d.modalDialog.body.contains(b)&&!pega.u.d.modalDialog.body.contains(this.gridDiv)||alert(form_submitCantProceed),this.resetInCall(),"keypress"!=a?!1:!0;this.gridcontDiv.setAttribute("editRowIndex",
"");p.put("gridAction",this.SUBMIT_ACTION);this.gridPreActivity&&p.put("gridPreActivity",this.gridPreActivity);this.gridPostActivity&&p.put("gridPostActivity",this.gridPostActivity);!this.isEnterKeyAppend&&"Progressive Load"===this.pageMode&&this.bFilteredGrid&&(p.put("partialRefresh","false"),p.put("editRowIndex",this.getLeftRow().id),p.put("refreshLayout","true"),p.put("pyGridFilterCriteriaPage",this.gridFilterPage),this.bRefreshOnUpdate=!0);p.put("KeepGridMessages",!0===pega.u.d.KEEP_GRID_MESSAGES?
"true":"false");var y=p.toQueryString();l.reloadRepeatLayout("pzdoGridAction",y,null,x,this.bRefreshOnUpdate?this.gridDiv:n,this.bRefreshOnUpdate?null:w,!0);this.bRefreshOnUpdate&&(this.eventQueueEnd=!0)}else if("keypress"!=a){a=0;var z;if(this.leftrowbefore&&(z=this.getResizedElement(this.leftrowbefore),a=parseInt(z[0].style.height),this.bTreegrid||this.fixedCol)){var A=f.getFirstChild(f.getFirstChild(r)),B=f.getFirstChild(f.getFirstChild(this.leftrowbefore));if(this.bTreegrid||this.bDragDrop)A=
f.getNextSibling(A),B=f.getNextSibling(B);this.bNumberedSkin&&(A=f.getNextSibling(A),B=f.getNextSibling(B));var C=f.getFirstChild(r);this.bTreegrid&&r.setAttribute("rowUniqueID",this.leftrowbefore.getAttribute("rowUniqueID"));pega.util.Dom.removeClass(r,"editMode");C.insertBefore(B,A);C.removeChild(A)}var E=pega.util.Dom.getFirstChild(this.rightBodyTbl);this.rightrowbefore&&(pega.util.Dom.hasClass(n,"notFocused")&&pega.util.Dom.addClass(this.rightrowbefore,"notFocused"),E.replaceChild(this.rightrowbefore,
n));this.leftrowbefore&&this.bRowResize&&(z=this.getResizedElement(this.leftrowbefore),this.doRowResize({height:a},[z[0],this,z[1]]));this.rightrowbefore=this.leftrowbefore=null;h?this.setHeadersWidth():this.selectRow(this.activeRow,!0);this.rightrowbefore=this.leftrowbefore=pega.u.d.activeStream=null;this.resetInCall()}else return pega.u.d.activeStream=null,this.resetInCall(),!1}}}catch(D){return this.resetInCall(),!1}},submitRowCallback:function(a){var b=a[0];a=a[1];b.rightrowbefore=b.leftrowbefore=
null;var c=pega.util.Dom.getElementsById("PegaRULESErrorFlag",b.rightBodyTbl);if(!c||0>=c.length){if(this.bTreegrid||this.fixedCol)c=pega.util.Dom.getElementsById("PegaRULESErrorFlag",b.leftBodyUL);if(!c||0>=c.length)b.isEnterKeyAppend?(pega.u.d.preReloadEle=null,b.action="INSERTAFTER",b.bFilteredGrid&&(b.refreshLayout=!0),b.insert(a),b.isEnterKeyAppend=!1):a==b.activeRow&&b.selectRow(a,!0);b.submitErrors=!1;b.bFilteredGrid&&(b.refreshLayout=!0)}c&&0<c.length&&(b.activeRow!=a&&(b.selectRow(b.activeRow,
!1),b.activeRow=a),b.selectRow(a,!0),pega.u.d.eventsArray=[],b.submitErrors=!0,b.callUnregDD(),b.focusOnNewEditableRow(),b.isEnterKeyAppend&&(b.isEnterKeyAppend=!1))},doExpandCollapse:function(a,b,c,d,e,g){if(b)var h=b;h||(h=e);h?(a=pega.ctx.dom.closest(h,"LI"))?(this.threadProcessing&&this.resetExecutionThread(),pega.util.Dom.hasClass(h,"expandNode")||pega.util.Dom.hasClass(h,"collapseNode")?(pega.util.Dom.hasClass(h,"expandNode")?(pega.util.Dom.removeClass(h,"expandNode"),pega.util.Dom.addClass(h,
"collapseNode"),h.title=pega.u.d.fieldValuesList.get("CollapseNodeTitle"),(b=f.getNextSibling(a.parentNode))&&"gridNode"==b.id?(d.expandCollapseNode(a,""),d.updateExpandStatus(a,"true"),d.resetInCall()):g?d.expandNodeUsingAjax(a,h,g):d.expandNodeUsingAjax(a,h)):(f.getNextSibling(a.parentNode)&&0==f.getChildren(f.getNextSibling(a.parentNode)).length&&a.parentNode.parentNode.removeChild(f.getNextSibling(a.parentNode)),pega.util.Dom.removeClass(h,"collapseNode"),pega.util.Dom.addClass(h,"expandNode"),
h.title=pega.u.d.fieldValuesList.get("ExpandNodeTitle"),d.expandCollapseNode(a,"none"),d.updateExpandStatus(a,"false"),d.resetInCall()),d.bTreegrid&&d.fixedRow&&d.setHeadersWidth()):(d.resetInCall(),g&&pega.util.Dom.hasClass(h,"noEC")&&(pega.util.Dom.removeClass(h,"noEC"),h.removeAttribute("tabIndex"),pega.util.Dom.addClass(h,"collapseNode"),d.callAppendChild(g)))):d.resetInCall():d.resetInCall()},expandCollapseNode:function(a,b){var c=pega.util.Dom.getNextSibling(a.parentNode);if(c&&"gridNode"==
c.id){c.style.display=b;if(a=this.rightBodyTbl){var d=f.getFirstChild(c);if(d)for(var e=f.getLastChild(c);;)if((c=f.getLastChild(e))&&"gridNode"==c.id&&0<f.getChildren(c).length)e=f.getLastChild(c);else break;c=e.id;d=f.getElementsById(d.id,a)[0];e=d.rowIndex;d=d.parentNode;c=f.getElementsById(c,a)[0].rowIndex;a=[];for(var g=e;g<=c;g++)e=d.rows[g],""==b?0<f.getElementsById(e.id,this.leftBodyUL,"LI")[0].offsetHeight&&a.push(g):e.style.display=b;if(""==b)for(b=0;b<a.length;b++)e=d.rows[a[b]],e.style.display=
""}this.gridResized()}},updateExpandStatus:function(a,b,c){var d=SafeURL_createFromURL(pega.ctx.url);c||(c=a.parentNode.parentNode);d.put("pyActivity","pzupdateExpandStatus");d.put("expanded",b);d.put("pyPropRef",pega.ui.property.toReference(c.id));var e=this;"undefined"!=typeof pega.ctx.KeepPageMessages&&d.put("pzKeepPageMessages",pega.ctx.KeepPageMessages);pega.u.d.asyncRequest("POST",d,{success:function(a){e.resetInCall()},failure:function(a){alert("AJAX call failed");e.resetInCall()}})},updateExpandStatusQueued:function(a,
b,c,d){this.updateExpandStatus(d[0],d[1],d[2])},expandNodeUsingAjax:function(a,b,c){var d=SafeURL_createFromURL(pega.ctx.url);pega.u.d.inCall&&c&&(b=this.getExpandCollNode(c),pega.util.Dom.removeClass(b,"expandNode"),pega.util.Dom.addClass(b,"collapseNode"),a=pega.ctx.dom.closest(b,"LI"));"harness"==this.editConfig&&this.gridDetailsThreadContext&&d.put("pzThreadName",this.gridDetailsThreadContext);var e=pega.u.d.getLayoutIndex(this.gridDiv),g=pega.u.d.getSectionDiv(a),h=a.parentNode.parentNode;d.put("pyActivity",
"pzgetChildNodes");pega.ctx.bClientValidation&&d.put("TreeGridClientVal",!0);d.put("StreamName",g.getAttribute("node_name"));g=pega.u.d.getSectionDiv(this.gridDiv).getAttribute("readonly");d.put("ReadOnly",g);d.put("BaseReference",l.getBaseRef(a));d.put("pyChildPropRef",this.getPLPGProperty());d.put("layoutIndex",e);d.put("pyPropRef",pega.ui.property.toReference(h.id));d.put("pyCustomActivity",this.deferLoadAct);this.bSortable&&(d.put("sortType",this.sortType),d.put("sortProperty",this.sortProperty));
this.bFilteredGrid&&d.put("pyGridFilterCriteriaPage",this.gridFilterPage);var m=this;a=null;this.editConfig!=this.EDIT_MODAL&&this.refreshLayout&&!this.bFilteredGrid&&(d.put("refreshLayout",this.refreshLayout),d.put("StreamClass","Rule-HTML-Section"),a=l.getRefreshCallbackArgs(this.gridDiv),d.put("RenderSingle",a.paramName),a=[a.expandInnerDiv,a.expandElement,a.paramName,a.innerDivExists,null,"reloadRepeat"],l.setBusyIndicator(),e=this.append(pega.ui.property.toReference(h.id),"",!1,!0),e.put("KeepGridMessages",
!0===pega.u.d.KEEP_GRID_MESSAGES?"true":"false"),d.put("PreActivity","pzdoGridAction"),d.put("ActivityParams",e.toQueryString()));l.isSafeToReload(h)&&(a={success:function(a){var d=a.responseText;if(a.argument)l.handleLoadSuccess(a);else{var e=d.split("||PEGA||GRID||");a={domAction:"append"};a.domElement=h;var g=0,n=0,v=null,v=m.rightBodyTbl,d=function(a){pega.u.d.loadHTMLEleCallback(a);var d=m.bTree||m.bTreegridSingleCol?!0:!1;if(v){a=document.createElement("div");document.body.appendChild(a);var f=
function(a){d?(pega.u.d.gIsScriptsLoading=!1,pega.c&&pega.c.actionSequencer&&!pega.u.d.isAjaxInProgress()&&pega.c.actionSequencer.resume()):pega.u.d.loadHTMLEleCallback(a);var e=pega.util.Dom,f=e.getFirstChild(a).rows;g=f.length;var k=e.getElementsById(h.id,v)[0];n=k.rowIndex;var l=f.length,p=k.parentNode,q=p.currentStyle?p.currentStyle.display:window.getComputedStyle?window.getComputedStyle(p,"").display:p.style.display;p.style.display="none";for(var r=[],t=f.length-1;0<=t;t--){var u=e.getNextSibling(k);
u?r.push(p.insertBefore(f[t],u)):r.push(p.appendChild(f[t]))}p.style.display=q;if(!pega.u.d.DISABLE_TREEGRID_HEIGHT_ADJUSTMENT){e=[];for(t=0;t<r.length;t++)e.push(m.leftBodyUL.querySelector('[id\x3d"'+r[t].id+'"]\x3eul.rowContent'));m.syncLeftRightTable(e,r)}m.activeRow>k.rowIndex&&(m.activeRow+=l);document.body.removeChild(a);pega.util.Dom.addClass(b,"collapseNode");pega.util.Dom.removeClass(b,"ExpandInProgress");m.gridResized();m.resetInCall();c&&m.callAppendChild(c);v&&"function"===typeof validation_init&&
validation_init(v)},k=e[1].split('\x3cDIV id\x3d"PegaOnlyOnce" style\x3d"display:none"\x3e');k[1]?pega.u.d.loadDOMObject(a,k[0]+'\x3cDIV id\x3d"PegaOnlyOnce" style\x3d"display:none"\x3e'+k[1],f):pega.u.d.loadDOMObject(a,e[1],f)}else pega.util.Dom.addClass(b,"collapseNode"),pega.util.Dom.removeClass(b,"ExpandInProgress"),m.gridResized();a=null;v||(m.resetInCall(),c&&m.callAppendChild(c));m.setHeadersWidth()};-1!=e[0].indexOf("\x3cUL")||-1!=e[0].indexOf("\x3cul")?pega.u.d.loadDOMObject(h.parentNode,
e[0],d,a):(pega.util.Dom.removeClass(b,"ExpandInProgress"),c?f.addClass(b,"collapseNode"):(f.addClass(b,"noEC"),b.setAttribute("tabIndex","-1")),m.resetInCall(),c&&(m.bTree&&m.editConfig==m.EDIT_ROW&&!m.action&&(m.action="ADDCHILD"),m.callAppendChild(c)),m.setHeadersWidth());if(k.isIE&&m.bTreegrid&&!m.fixedRow&&!m.fixedCol&&(a=m.rightBodyTbl,d=n+g,a.rows&&0<a.rows.length&&a.rows[0].cells&&0<a.rows[0].cells.length&&f.hasClass(a.rows[0].cells[0],"hiddenCell")))for(var u=n+1;u<d+1;u++)a.rows[u].cells[0].style.width=
"0%"}},failure:function(a){alert("AJAX call failed");m.resetInCall()},argument:a},pega.util.Dom.removeClass(b,"collapseNode"),pega.util.Dom.addClass(b,"ExpandInProgress"),"undefined"!=typeof pega.ctx.KeepPageMessages&&d.put("pzKeepPageMessages",pega.ctx.KeepPageMessages),pega.u.d.asyncRequest("POST",d,a))},indexOf:function(a,b){if(Array.prototype.indexOf)return a.indexOf(b);for(var c=a.length>>>0,d=0;d<c;d++)if(d in a&&a[d]===b)return d;return-1},unregRelatedDDTargets:function(){var a=pega.util.DragDropMgr.ids[this.gridDiv.id],
b=[];if(a)for(var c in a)pega.util.DragDropMgr.isTypeOfDD(a[c])&&(b[b.length]=a[c]);a=b.length;for(c=0;c<a;c++)b[c].unreg()},initDDTarget:function(a){if(!this.isTargetNoResultsMsg(k.getTarget(a)))if(this.bTreegrid||this.fixedCol){if(a=f.getAncestorBy(k.getTarget(a),function(a){return(a=a.parentNode)&&a.id&&0===a.id.indexOf("gridNode")?!0:!1})){var b=a.getElementsByTagName("ul")[0];"undefined"!=typeof b&&(b.id="ul"+a.id,"ul"!=b.id&&(pega.util.DragDropMgr.isDragDrop(b.id)||new pega.util.DDTarget(b,
this.gridDiv.id)))}}else{var c=this;(a=f.getAncestorBy(k.getTarget(a),function(a){return"TR"!==a.tagName?!1:(a=a.parentNode)&&a.parentNode==c.rightBodyTbl?!0:!1}))&&a.id&&(pega.util.DragDropMgr.isDragDrop(a.id)||new pega.ui.gridRowDD(a,this))}},attachDrag:function(a){var b=k.getTarget(a);if(this.bTreegrid&&b&&b.tagName){var c=b.tagName.toLowerCase();if("select"==c||"input"==c||"textarea"==c||"button"==c)return}if(!this.submitErrors&&!this.isTargetNoResultsMsg(b)){if(this.bTreegrid||this.fixedCol)if(0==
this.bTreegrid){for(;!b.getElementById&&"gridNode"!=b.id&&"dragHandle"!=b.id;)b=b.parentNode;if("object"==typeof b.getElementById)return}else{for(;!b.getElementById&&0>b.id.indexOf("gridNode")&&"iconExpandCollapse"!=b.id&&!b.getAttribute("PL_INDEX");)b=b.parentNode;if("object"==typeof b.getElementById||"iconExpandCollapse"==b.id||0<=b.id.indexOf("gridNode"))return}else{var d=this,b=f.getAncestorBy(k.getTarget(a),function(a){return"TR"!==a.tagName?!1:(a=a.parentNode)&&a.parentNode==d.rightBodyTbl?
!0:!1});if(!b||!b.id)return}this.scrollObjInfo||(this.scrollObjInfo=this.getScrollObj(this.gridDiv));pega.util.DragDropMgr.isDragDrop(b.id)?this.gridRowDDInst=pega.util.DDM.getDDById(b.id):(this.gridRowDDInst=new pega.ui.gridRowDD(b,this),this.gridRowDDInst.handleMouseDown(a,this.gridRowDDInst));this.gridRowDDInst.DDM.clickTimeThresh=1E5;"undefined"==typeof attachEvent&&pega.d.MouseEvent._doOnMouseClick(a);try{k.getTarget(a).focus()}catch(e){}}},reloadSequoiaRow:function(){var a=this.rightBodyTbl.rows[this.getIndex(this.activeRow)],
b;if(this.bTreegrid||this.fixedCol)b=pega.util.Dom.getElementsById(a.id,this.leftBodyUL,"LI")[0];var c=new SafeURL;c.put("PageListProperty",this.getPLPGProperty());if(pega.u.d.bPageGroup){var d=pega.u.d.activeStream[1].getAttribute("PG_SUBSCRIPT");c.put("Subscript",d)}else c.put("IndexInList",this.activeRow),c.put("strIndexInList",this.activeRow);c.put("EditRow","false");pega.u.d.bTreegrid&&c.put("pyPropRef",pega.ui.property.toReference(a.id));c.put("strIndexInList",this.activeRow);c.put("gridAction",
this.SUBMIT_ACTION);this.gridPreActivity&&c.put("gridPreActivity",this.gridPreActivity);this.gridPostActivity&&c.put("gridPostActivity",this.gridPostActivity);d=pega.u.d.getLayoutIndex(this.gridDiv);b={partialTrigger:"editRow"+this.getConfiguredPLPGProperty()+d,domElement:[b,a],domAction:"replace",beforeDomAction:this.loadGridForEdit,beforeDomActionContext:this,beforeParams:null,afterDomAction:null,afterParams:null,sendSectionData:"true"};d=[this.getPLPGProperty(),this.activeRow];c=c.toQueryString();
pega.u.d.reloadRepeatLayout("pzdoGridAction",c,null,d,a,b,!0)},setOtherRadioToFalse:function(a,b){b=a.name;if("undefined"==typeof a.id||""==a.id)a.id=b.replace(/[\d]/g,"");a=pega.util.Dom.getElementsById(a.id,this.gridDiv);for(var c=a.length,d=0;d<c;d++)a[d]&&a[d].name!=b&&(a[d].checked=!1)},validateGridPGSubscript:function(a){!0!==pega.u.d.validateSubScript(a)&&alert("Invalid Subscript")},checkAllIfInHeader:function(a,b){var c=a.checked,d,e=!1;if(a.getAttribute("data-click")||a.getAttribute("data-ctl"))e=
!0;for(;!pega.util.Dom.hasClass(a,"cellCont")&&!pega.util.Dom.hasClass(a,"gridCell");){d=a.parentNode.tagName;if(!d)return;a=a.parentNode}if(0==this.getRowIndex(a)&&f.isAncestor(this.gridcontDiv,a)){var g=this.getCellIndex(a);if(e){a=this.getTableLength(this.rightBodyTbl);var h=!1,k=null;0==g&&this.bPXFixed&&this.fixedCol&&"undefined"!=typeof this.leftBodyUL&&null!=this.leftBodyUL&&(h=!0,k=f.getChildren(this.leftBodyUL),a=k.length-1);for(b=1;b<=a;b++)if(this.rightBodyTbl.rows[b]&&!this.rightBodyTbl.rows[b].getAttribute("expanded")&&
this.rightBodyTbl.rows[b].cells.length>g&&(d=h&&k[b].getAttribute("PL_INDEX")?k[b]:this.rightBodyTbl.rows[b].cells[g],null!=d)){d=d.getElementsByTagName("input");for(var e=d.length,l=0;l<e;l++)"CHECKBOX"!=d[l].type.toUpperCase()||d[l].disabled||(d[l].checked=c?!0:!1)}}else for(e=pega.util.Dom.getElementsById("gridCheckBox",Grids.getActiveGrid(b).gridDiv),b=0;b<e.length;b++){d="";for(a=e[b];"TH"!=d&&"TD"!=d;)d=a.parentNode.tagName,a=a.parentNode;g==this.getCellIndex(a)&&(e[b].checked=c&&!e[b].disabled?
!0:!1)}}else{g=this.getCellIndex(a);h=!1;if(c)if(h=!0,e)for(a=this.getTableLength(this.rightBodyTbl),b=1;b<=a;b++){if(this.rightBodyTbl.rows[b]&&!this.rightBodyTbl.rows[b].getAttribute("expanded")&&(d=this.rightBodyTbl.rows[b].cells[g]))for(d=d.getElementsByTagName("input"),e=d.length,l=0;l<e&&("CHECKBOX"==d[l].type.toUpperCase()&&(h&=d[l].checked),h);l++);if(!h)break}else for(e=pega.util.Dom.getElementsById("gridCheckBox",Grids.getActiveGrid(b).gridDiv),b=1;b<e.length;b++){d="";for(a=e[b];"TH"!=
d&&"TD"!=d;)d=a.parentNode.tagName,a=a.parentNode;g==this.getCellIndex(a)&&(h&=e[b].checked);if(!h)break}if(d=null!=this.rightHeaderTbl?this.rightHeaderTbl.rows[0].cells[g]:this.rightBodyTbl.rows[0].cells[g])for(d=d.getElementsByTagName("input"),e=d.length,l=0;l<e;l++)"CHECKBOX"==d[l].type.toUpperCase()&&(d[l].checked=h)}},deselect:function(){"harness"==this.editConfig&&(this.gridDetailsDiv.innerHTML="");this.activeRow&&this.selectRow(this.activeRow,!1);this.activeRow=null},getIndex:function(a,b){if(!this.bCategorizedGrid&&
this.editConfig!=this.EDIT_EXPANDPANE||this.bPageGroup){if(this.editConfig==this.EDIT_EXPANDPANE&&this.bPageGroup){c=this.rightBodyTbl.rows;e=d=0;for(f=1;f<=a;){b=c[e];if(!b)break;"true"==b.getAttribute("expanded")?d++:null;b.getAttribute("PG_SUBSCRIPT")&&""!=b.getAttribute("PG_SUBSCRIPT")&&f++;e++}return parseInt(a,10)+d}return a}var c=this.rightBodyTbl.rows,d=0,e=0,f=1,h=0;b&&""!=b&&(f=c[b].getAttribute("PL_INDEX"),e=b);for(;f<=a;){b=c[e];if(!b)break;"true"==b.getAttribute("expanded")?d++:null;
!b.id&&pega.util.Dom.hasClass(b,"grid-categorize-header")&&h++;b.getAttribute("PL_INDEX")&&""!=b.getAttribute("PL_INDEX")&&f++;e++}return parseInt(a,10)+d+h},getPGRowIndex:function(a){var b=a;if(this.editConfig==this.EDIT_EXPANDPANE&&this.bPageGroup)for(var c=this.rightBodyTbl.rows,d=0,b=0;d<=a;)c[d].getAttribute("PG_SUBSCRIPT")&&""!=c[d].getAttribute("PG_SUBSCRIPT")&&b++,d++;return b},getFilteredRowIndex:function(a){var b=a;if((this.bCategorizedGrid||this.editConfig==this.EDIT_EXPANDPANE)&&this.bFilteredGrid)for(var c=
this.rightBodyTbl.rows,d=0,b=0;d<=a;)c[d].getAttribute("PL_INDEX")&&""!=c[d].getAttribute("PL_INDEX")&&b++,d++;return b},getLastRowToRetrieve:function(){var a;if(!this.bPageGroup){var b;b=this.bTreegrid?this.getTopLevelNodesLength(this.rightBodyTbl):this.editConfig==this.EDIT_EXPANDPANE?this.getExpandPaneTableLength():this.getTableLength(this.rightBodyTbl);-1<b&&(this.currentPageIndex&&this.rangeSize?3>b?f.getElementsById("Grid_NoResults",this.gridDiv)||(a=this.currentPageIndex*this.rangeSize-this.rangeSize+
(b+1)):a=this.currentPageIndex*this.rangeSize-this.rangeSize+(b+1):3>b?f.getElementsById("Grid_NoResults",this.gridDiv)||(a=b+1):a=b+1)}return a},openDDReport:function(a,b){a=this.getLeftRow(a);var c=SafeURL_createFromURL(pega.tools.SUtils.trim(pega.ctx.url));c.put("pyActivity","pzShowDrillDownReport");c.put("Page",pega.ui.property.toReference(a.id));b&&c.put("columnIndex",b);c.put("ReportName",this.RDName);c.put("ReportClassName",this.RDAppliesToClass);openUrlInWindow(c.toURL(),"DrillDownReport")},
releaseLock:function(a,b){var c=SafeURL_createFromURL(pega.ctx.url);c.put("pyActivity","pzBreakLock");pega.u.d.asyncRequest("GET",c,{success:function(c){l.url=l.url.replace(this.modalThreadContext,this.baseThreadContext);c=pega.ui.property.toHandle(a);c=this.bTreeGrid?f.getElementsById(c,this.leftBodyUL)[0]:f.getElementsById(c,this.rightBodyTbl)[0];c=f.getFirstChild(c);this.editConfig==this.EDIT_MODAL||this.isOpenLocalAction?pega.util.Event.fireEvent(f.getFirstChild(c),Grids.EVENT_DOUBLE_CLICK):this.jumpToIndex(null,
this.getActiveRowIndex(),b)},failure:function(a){},scope:this})},fixVisibleGrid:function(a){this.initScrollbars();this.setHeightForNoResults();this.performWriteOperations();this.triggerBrowserReflow();this.autoAdjustProgressiveGridHeight()},onPostMDCRenderFixGrid:function(a){this.fixVisibleGrid(a)},onExpandFixGrid:function(a){this.fixVisibleGrid(a);k.removeListener(a.currentTarget,"click",this.onExpandFixGrid)},changeExpandCollapseIconState:function(){this.bShowExpandCollapseColumn&&this.expandCollapseAnchor&&
"object"==typeof this.expandCollapseAnchor&&-1!=this.expandCollapseAnchor.className.indexOf("collapseRowDetails")&&(f.addClass(this.expandCollapseAnchor,"expandRowDetails"),f.removeClass(this.expandCollapseAnchor,"collapseRowDetails"),this.getRightRow().removeAttribute("rowExpanded"))},getDataRowSize:function(){var a=this.rightBodyTbl.rows,b=a.length-1;if(this.editConfig==this.EDIT_EXPANDPANE)for(var c=0;c<a.length;c++){var d=a[c];d&&"true"==d.getAttribute("expanded")&&b--}return b},updateTreeGridRowHeight:function(){this.syncLeftRightTable(jQuery(this.leftBodyUL).find("ul.rowContent"),
jQuery(this.rightBodyTbl).find("tr.cellCont"),1)},syncLeftRightTable:function(a,b,c){var d=[],e=function(a,b){jQuery(a).height(b-1+"px");jQuery(a).find(".oflowDiv").height(b+"px");jQuery(a).find("li").height(b+"px");jQuery(a).find("ul").height(b+"px")},f=function(a,b){jQuery(a).height(b+"px")};for(c=c?c:0;c<b.length;c++){var h=b[c],k=a[c];if(h&&h.offsetWidth&&k&&h.id==k.parentElement.id){var l=h.offsetHeight,r=k.offsetHeight;l>r?d.push({method:e,node:k,height:l}):l<r&&d.push({method:f,node:h,height:r})}}for(c=
0;c<d.length;c++)d[c].method.call(this,d[c].node,d[c].height)},dynamicGridHeaderA11y:function(){this.gridcontDiv.querySelectorAll("th").forEach(function(a){var b=a.querySelector("a#pui_colmenu");if(b){var c=a.querySelector(".cellIn"),d="";c&&(d=c.textContent+" ");a.setAttribute("aria-label",d.trim());if(c=a.querySelector("span#sort"))c.classList.contains("sort-ASC")?a.setAttribute("aria-sort","ascending"):c.classList.contains("sort-DESC")?a.setAttribute("aria-sort","descending"):a.removeAttribute("aria-sort"),
c.removeAttribute("tabindex"),c.removeAttribute("title"),c.setAttribute("aria-hidden","true");if(c=a.querySelector(".divCont")){c.setAttribute("role","button");var e=c.getAttribute("aria-describedby");c.removeAttribute("aria-describedby");c.querySelector("div#"+e).remove();"true"===a.getAttribute("bsortable")&&(a.removeAttribute("title"),c.setAttribute("title","Enter to sort"))}d+=b.getAttribute("title");b.setAttribute("role","button");b.setAttribute("title",d.trim())}})}}}()};
(function(){if(typeof (pega)=="undefined"){return }var B=pega.util.Dom;var A=pega.util.Event;var C=pega.util.DDM;pega.ui.gridRowDD=function(D,E){this.gridObj=E;pega.ui.gridRowDD.superclass.constructor.call(this,D,E.gridDiv.id,{dragElId:"yui_ddproxy"});this.leftParent=E.leftBodyDiv;this.baseGridNode=B.getFirstChild(this.leftParent);this.assocTable=E.rightBodyTbl;this.masterDiv=E.gridDiv;this.clickEl=D;this.destEl=null;if(this.gridObj.bTreegrid||this.gridObj.fixedCol){if(this.gridObj.bTreegrid){this.clickRow=D}else{this.clickRow=D.parentNode.parentNode}}else{this.clickRow=D;var F=this;this.on("mouseDownEvent",function(G){if(!B.isAncestor(F.clickRow.cells[0],A.getTarget(G))){return false}})}};pega.extend(pega.ui.gridRowDD,pega.util.DDProxy,{onMouseDown:function(E){var D=this.getDragEl();D.style.left=(A.getPageX(E)+10)+"px";D.style.top=(A.getPageY(E)+10)+"px"},b4StartDrag:function(J,H){var D=this.gridObj;var F=this.clickEl;if(D.editConfig==D.EDIT_ROW){var L=D.getRightRow();if(B.hasClass(L,"editMode")){var G={type:"mousedown",target:F,context:D,handler:D.submitRow,args:true};D.pushToQueue(G)}}else{if(D.editConfig==D.EDIT_READWRITE){if(D.leftBodyTbl){$(D.leftBodyTbl.rows[D.activeRow]).find(document.activeElement).blur()}else{if(D.rightBodyTbl){$(D.rightBodyTbl.rows[D.activeRow]).find(document.activeElement).blur()}}}}if(F&&F.nodeName.toUpperCase()=="LI"&&B.hasClass(F,"gridRow")){var I=B.getElementsById(F.id,this.assocTable,"tr")[0].rowIndex;D.pushToQueue({type:"action",handler:D.callSelectPage,context:D,args:[D.leftBodyUL,I]})}else{if(this.gridObj.bTreegrid||this.gridObj.fixedCol){var K=D.findCell(null,D.leftBodyUL,F);if(K){var I=D.getRowIndex(K);D.pushToQueue({type:"action",handler:D.callSelectPage,context:D,args:[D.leftBodyUL,I]})}}else{var I=F.rowIndex;D.pushToQueue({type:"action",handler:D.callSelectPage,context:D,args:[D.rightBodyTbl,I]})}}var E=this.getDragEl();this._resizeProxy();B.setStyle(E,"visibility","visible");B.setStyle(E,"display","block")},setDragElPos:function(F,E){var D=this.getDragEl();D.style.left=(F+10)+"px";D.style.top=(E+10)+"px"},adjustScrollBars:function(F,L){var E=this.assocTable.rows[F].offsetTop;this.bScrollGridUp=false;this.bScrollGridDown=false;var S=this;S.gridOffsetTop=S.gridObj.gridDiv.offsetTop;if(S.gridObj.gridDiv.offsetTop===0&&S.gridObj.gridDiv.offsetParent&&S.gridObj.gridDiv.offsetParent.tagName==="TD"){S.gridOffsetTop=$(S.gridObj.gridDiv.offsetParent).closest("table").length&&$(S.gridObj.gridDiv.offsetParent).closest("table")[0].offsetTop}var T=(!S.gridObj.fixedCol&&(S.gridObj.gridcontDiv.style.width!=""||S.gridObj.gridcontDiv.style.height!=""));var N=(S.gridObj.fixedRow&&!S.gridObj.fixedCol&&(S.gridObj.layoutWrapperDiv.getAttribute("noWidth")!=""||S.gridObj.layoutWrapperDiv.getAttribute("noHeight")!=""));var I=(S.gridObj.pageMode=="Progressive Load");if(this.gridObj.vScrollDiv){var M=this.gridObj.rightHeaderDiv?(this.gridObj.vScrollDiv.offsetHeight-this.gridObj.rightHeaderDiv.offsetHeight):this.gridObj.vScrollDiv.offsetHeight;var G=this.assocTable.rows[F].offsetHeight;if((E-G)<this.gridObj.vScrollDiv.scrollTop){this.gridObj.vScrollDiv.scrollTop=E-G}else{if(this.gridObj.vScrollDiv.scrollTop+M<=(E+G)){this.gridObj.vScrollDiv.scrollTop=this.gridObj.vScrollDiv.scrollTop+G}}if(S.gridObj.vScrollDiv.scrollTop>0&&(E+this.assocTable.rows[0].offsetHeight+10)>=this.gridObj.vScrollDiv.scrollTop&&(E-this.assocTable.rows[0].offsetHeight-10)<=this.gridObj.vScrollDiv.scrollTop){this.bScrollGridUp=true;var J=setInterval(function(){S.scrollGridUp(S,S.gridObj.vScrollDiv,J,G,S.gridObj.vScrollCont)},10)}if((S.gridObj.vScrollDiv.scrollTop+S.gridObj.vScrollDiv.offsetHeight<S.gridObj.vScrollCont.offsetHeight)&&(E+G+20>=this.gridObj.vScrollDiv.scrollTop+M-this.assocTable.rows[0].offsetHeight)&&(E+G-20<=this.gridObj.vScrollDiv.scrollTop+M-this.assocTable.rows[0].offsetHeight)){this.bScrollGridDown=true;var U=setInterval(function(){S.scrollGridDown(S,S.gridObj.vScrollDiv,U,G,S.gridObj.vScrollCont)},10)}}else{if(T||I||N){if(S.gridObj.fixedRow){var P=this.gridObj.layoutWrapperDiv;var M=P?(P.offsetHeight):this.gridObj.gridcontDiv.offsetHeight}else{var P=this.gridObj.gridcontDiv;var M=this.gridObj.rightHeaderDiv?(P.offsetHeight-this.gridObj.rightHeaderDiv.offsetHeight):P.offsetHeight}var G=this.assocTable.rows[F].offsetHeight;var R=0;if(S.gridObj.bDiscardInvisibleRows){if(S.gridObj.topBuffer.style.height!="auto"){R=S.gridObj.topBuffer.offsetHeight}E+=R}if((E-G)<P.scrollTop){if(S.gridObj.bDiscardInvisibleRows){if(R<=(E-G)){P.scrollTop=E-G}}else{P.scrollTop=E-G}}else{if(P.scrollTop+M<=(E+G)){P.scrollTop=P.scrollTop+G}}if(P.scrollTop>0&&(E+this.assocTable.rows[0].offsetHeight+10)>=P.scrollTop&&(E-this.assocTable.rows[0].offsetHeight-10)<=P.scrollTop){this.bScrollGridUp=true;var J=setInterval(function(){S.scrollGridUp(S,P,J,G,S.gridObj.gridcontDiv)},10)}if((P.scrollTop+P.offsetHeight<P.scrollHeight)&&(E+G+20>=P.scrollTop+M-this.assocTable.rows[0].offsetHeight)&&(E+G-20<=P.scrollTop+M-this.assocTable.rows[0].offsetHeight)){this.bScrollGridDown=true;var U=setInterval(function(){S.scrollGridDown(S,P,U,G,S.gridObj.gridcontDiv,true)},10)}}else{if(!this.gridObj.scrollObjInfo){this.gridObj.scrollObjInfo=this.gridObj.getScrollObj(this.gridObj.gridDiv)}var D=this.gridObj.scrollObjInfo[0];var K=this.gridObj.scrollObjInfo[2];var G=this.assocTable.rows[F].offsetHeight;var H=5;if(D.tagName=="BODY"||(D.id!=null&&D.id!="HARNESS_CONTENT")){var Q=L+G+K;if(Q>(D.scrollTop+D.offsetHeight)){D.scrollTop=D.scrollTop+G}if((S.gridObj.gridDiv.offsetHeight>D.offsetHeight)&&(Q<=G+50)){this.bScrollGridUp=true;var J=setInterval(function(){S.scrollGridUp(S,D,J,H,S.gridObj.gridDiv)},500)}if(Q>D.offsetHeight&&(D.offsetHeight+this.assocTable.rows[0].offsetHeight)>=Q){this.bScrollGridDown=true;var O=setInterval(function(){S.scrollGridDown(S,D,O,H,S.gridObj.gridDiv)},500)}if(D.scrollTop+D.offsetHeight<S.gridObj.gridDiv.offsetHeight&&Q>=D.scrollTop+D.offsetHeight-20&&Q<=D.scrollTop+D.offsetHeight+20){this.bScrollGridDown=true;var U=setInterval(function(){S.scrollGridDown(S,D,U,H,S.gridObj.gridDiv)},500)}}else{if(L+G>D.offsetHeight){D.scrollTop=D.scrollTop+G}else{if(L+D.scrollTop<(D.scrollTop+G)){D.scrollTop=D.scrollTop-G}}if(D.scrollTop>0&&(L-G<=0)){this.bScrollGridUp=true;var J=setInterval(function(){S.scrollGridUp(S,D,J,G,S.gridObj.gridDiv)},10)}if(L+G>=D.offsetHeight&&L<=D.offsetHeight){this.bScrollGridDown=true;var U=setInterval(function(){S.scrollGridDown(S,D,U,G,S.gridObj.gridDiv)},10)}}}}},scrollGridUp:function(J,H,E,G,I){var D=I.offsetTop;if(J.gridOffsetTop){D=J.gridOffsetTop}if(H.scrollTop<=D){J.bScrollGridUp=false}if(J.gridObj.bDiscardInvisibleRows){J.bScrollGridUp=true;var F=J.gridObj.topBuffer.offsetHeight;if(J.gridObj.topBuffer.style.height=="auto"){F=0}if((H.scrollTop-G)<F){J.bScrollGridUp=false}}if(J.bScrollGridUp){H.scrollTop=H.scrollTop-G}else{clearInterval(E)}},scrollGridDown:function(K,H,G,F,I,J){var D=I.offsetTop;if(K.gridOffsetTop){D=K.gridOffsetTop}if(J){if(I.scrollTop+I.offsetHeight>I.scrollHeight){K.bScrollGridDown=false}}else{if(H.scrollTop+H.offsetHeight>I.offsetHeight+D){K.bScrollGridDown=false}}if(K.gridObj.bDiscardInvisibleRows){K.bScrollGridDown=true;var E=K.gridObj.topBuffer.offsetHeight;if(K.gridObj.topBuffer.style.height=="auto"){E=0}E=E+K.gridObj.rightBodyTbl.offsetHeight-K.gridObj.layoutWrapperDiv.offsetHeight;if((H.scrollTop+F)>E){K.bScrollGridDown=false}}if(K.bScrollGridDown){H.scrollTop=H.scrollTop+F}else{clearInterval(G)}},resetConstraints:function(){},startDrag:function(D,E){this.DDM.useCache=false;this.gridObj.gridDiv.style.cursor="move"},onDragOver:function(K,D){if(this.gridObj.submitErrors){return }if(D=="dragHandle"){return false}var L;if(this.gridObj.bTreegrid||this.gridObj.fixedCol){var H=pega.util.Dom.getElementsById(D,this.gridObj.leftBodyDiv)[0];if(D.indexOf("ul")<0){return false}this.destEl=H.parentNode;if(this.destEl.id==""){return }this.assocDestEl=B.getElementsById(this.destEl.id,this.assocTable,"tr")[0];L=this.assocDestEl.rowIndex}else{var H=pega.util.Dom.getElementsById(D,this.gridObj.rightBodyTbl)[0];if(H.tagName.toUpperCase()!=="TR"||!H.getAttribute("PL_INDEX")){return false}this.destEl=this.assocDestEl=H;L=this.assocDestEl.rowIndex}var F=this.getDragEl();var N=A.getPageY(K);var O=A.getPageX(K);var J=this;if(typeof this.hoverToken!="undefined"){clearTimeout(this.hoverToken)}var E=this.getDropMode(this.clickRow,this.destEl,N);this.gridObj.onCellHover(this.assocDestEl,false);if(E=="child"){if(this.gridObj.bTreegrid){var I=pega.ctx.dom.querySelector("[id='"+D+"']");var M=B.getElementsById("iconExpandCollapse",I);if(M){var G=B.getChildren(M[0]);if(G){this.hoverToken=setTimeout(function(){if(B.hasClass(G[0],"expandNode")){var P={type:"click",target:G[0],keyCode:null,context:J};P.handler=J.gridObj.doExpandCollapse;P.args=J.gridObj;J.gridObj.pushToQueue(P)}},3000)}}}B.removeClass(F,"dragChild_Sibling");B.addClass(F,"dragChild_Add");B.removeClass(H,"insertAfter");B.removeClass(H,"insertBefore");B.addClass(H,"insertChild");B.removeClass(this.assocDestEl,"insertAfter");B.removeClass(this.assocDestEl,"insertBefore");B.addClass(this.assocDestEl,"insertChild")}else{if(E=="before"||E=="after"){B.removeClass(F,"dragChild_Add");B.addClass(F,"dragChild_Sibling");B.removeClass(H,"insertChild");B.removeClass(this.assocDestEl,"insertChild");if(E=="before"){B.removeClass(H,"insertAfter");B.addClass(H,"insertBefore");B.removeClass(this.assocDestEl,"insertAfter");B.addClass(this.assocDestEl,"insertBefore")}else{B.removeClass(H,"insertBefore");B.addClass(H,"insertAfter");B.removeClass(this.assocDestEl,"insertBefore");B.addClass(this.assocDestEl,"insertAfter")}}else{if(E=="invalid"){B.removeClass(F,"dragChild_Add");B.removeClass(F,"dragChild_Sibling");B.removeClass(H,"insertAfter");B.removeClass(H,"insertChild");B.removeClass(H,"insertBefore");B.removeClass(this.assocDestEl,"insertAfter");B.removeClass(this.assocDestEl,"insertChild");B.removeClass(this.assocDestEl,"insertBefore")}}}if(this.lastHighlightedElements&&this.lastHighlightedElements[0]!=H&&this.lastHighlightedElements[1]!=this.assocDestEl){B.removeClass(this.lastHighlightedElements[0],"insertAfter");B.removeClass(this.lastHighlightedElements[0],"insertChild");B.removeClass(this.lastHighlightedElements[0],"insertBefore");B.removeClass(this.lastHighlightedElements[1],"insertAfter");B.removeClass(this.lastHighlightedElements[1],"insertChild");B.removeClass(this.lastHighlightedElements[1],"insertBefore")}this.lastHighlightedElements=[H,this.assocDestEl];this.adjustScrollBars(L,N)},onDragOut:function(G,H){if(this.gridObj.submitErrors){return }var E;if(this.gridObj.bTreegrid||this.gridObj.fixedCol){E=B.getElementsById(H,this.gridObj.leftBodyDiv)[0]}else{E=B.getElementsById(H,this.gridObj.rightBodyTbl)[0]}B.removeClass(E,"insertAfter");B.removeClass(E,"insertChild");B.removeClass(E,"insertBefore");if(this.gridObj.bTreegrid||this.gridObj.fixedCol){E=E.parentNode;if(E.id==""){return }}else{if(E.tagName.toUpperCase()!=="TR"||!E.getAttribute("PL_INDEX")){return }}var F=B.getElementsById(E.id,this.assocTable,"tr")[0];B.removeClass(F,"insertAfter");B.removeClass(F,"insertChild");B.removeClass(F,"insertBefore");this.destEl=null;var D=this.getDragEl();B.removeClass(D,"dragChild_Add");B.removeClass(D,"dragChild_Sibling")},clearSelection:function(){if(document.selection){try{document.selection.empty()}catch(D){}}else{if(window.getSelection){window.getSelection().removeAllRanges()}}},onDrag:function(I){if(pega.env.ua.ie){this.clearSelection()}if(this.gridObj.pageMode=="Progressive Load"){A.removeListener(this.gridObj.layoutWrapperDiv,"scroll",this.gridObj.gridEventHandler)}if(this.gridObj.submitErrors){return }var F=A.getPageX(I);var J=A.getPageY(I);var E=this.getDragEl();var H=A.getTarget(I);var D=this.gridObj.findCell(null,this.assocTable,H);if(!D){var D=this.gridObj.findCell(null,this.gridObj.leftBodyUL,H);if(!D||(D&&D.id=="dragHandle"||D.id==""||B.hasClass(D,"headerCell"))){return }this.assocDestEl=B.getElementsById(D.parentNode.parentNode.id,this.assocTable,"tr")[0]}else{this.assocDestEl=D.parentNode}if(!B.isAncestor(this.assocTable,this.assocDestEl)){return }var G=this.assocDestEl.rowIndex;this.adjustScrollBars(G,J)},getDropMode:function(D,E,J){var K=B.getRegion(E);var L=B.getElementsById(D.id,this.assocTable,"tr")[0];var P=B.getElementsById(E.id,this.assocTable,"tr")[0];var Q="";if(this.gridObj.pageMode=="Progressive Load"&&P){var F=parseInt(this.gridObj.rightBodyTbl.rows[1].getAttribute("pl_index"));var G=parseInt(P.getAttribute("pl_index"));var N=G-F+1;if(this.gridObj.isDummyRow(N)){Q="invalid";var O=1;if(this.gridObj.currentPageIndex){O=((this.gridObj.currentPageIndex-1)*this.gridObj.rangeSize)+1;var I=this.gridObj.getLeftRow(O);if(this.gridObj.layoutWrapperDiv.scrollTop){this.gridObj.layoutWrapperDiv.scrollTop=I.offsetTop}}return Q}}if(this.gridObj.bTreegrid==true){if(B.isAncestor(D,E)){Q="invalid"}else{if(J<=K.top+5){if(L.rowIndex==P.rowIndex){Q="invalid"}else{Q="before"}}else{if(J>=K.bottom-5){if(L.rowIndex==P.rowIndex){Q="invalid"}else{Q="after"}}else{if(D.parentNode.parentNode==E){Q="invalid"}else{if(P.rowIndex==L.rowIndex){Q="invalid"}else{Q="child"}}}}}var H=this.destEl.parentNode.parentNode.id;var M=D.parentNode.parentNode.id;if(this.gridObj.bAlwaysExpandRoot&&!(H=="gridBody_left"&&M=="gridBody_left"&&Q!="child")){if((H=="gridBody_left"||M=="gridBody_left")&&Q!="child"){Q="invalid"}else{if(M=="gridBody_left"&&Q=="child"){Q="invalid"}}}}else{if(L.rowIndex==P.rowIndex){Q="invalid"}else{if(J<(K.top)+(E.offsetHeight/2)){Q="before"}else{Q="after"}}}return Q},onDragDrop:function(E,G){if(this.gridObj.submitErrors){return }var D=E.which||E.button;if(D>1){A.stopEvent(E);return }if(this.gridObj.bTreegrid||this.gridObj.fixedCol){if(this.gridObj.bTreegrid){var F=this;if(typeof this.hoverToken!="undefined"){clearTimeout(this.hoverToken)}}if(G=="dragHandle"){return false}G=G.substring(2);this.destEl=pega.ctx.dom.querySelector("[id='"+G+"']")}else{this.destEl=pega.util.Dom.getElementsById(G,this.gridObj.rightBodyTbl)[0]}this.assocDestEl=B.getElementsById(this.destEl.id,this.assocTable,"tr")[0]},endDrag:function(H){if(this.gridObj.submitErrors){return }if(this.gridObj.pageMode=="Progressive Load"){A.addListener(this.gridObj.layoutWrapperDiv,"scroll",this.gridObj.gridEventHandler,this.gridObj.gridDiv,this.gridObj)}this.gridObj.gridDiv.style.cursor="auto";if(this.gridObj.bTreegrid){var G=this;if(typeof this.hoverToken!="undefined"){clearTimeout(this.hoverToken)}}this.DDM.refreshCache();clearInterval(this.timeToken);var D=this.clickRow;var F=this.destEl;if(!F){return }if(A.isIE){this.gridObj.DDProcessing=true}var I=this.getDragEl();var E=I.id;var J=A.getPageY(H);var L=this.getDropMode(D,F,J);B.setStyle(I,"visibility","hidden");B.setStyle(I,"display","none");var K=new pega.util.Motion(I,{points:{to:B.getXY(F)}},0.2,pega.util.Easing.easeOut);var G=this;K.onComplete.subscribe(function(){B.setStyle(E,"visibility","hidden");if(L=="invalid"){G.gridObj.DDProcessing=false;return false}if(L=="child"){var O=B.getElementsById(F.id,this.assocTable,"tr")[0];var M=G.gridObj.getExpandCollNode(O.rowIndex);if(B.hasClass(M,"expandNode")){var N={type:"click",target:M,context:G.gridObj,handler:G.gridObj.doExpandCollapse,args:G.gridObj};G.gridObj.pushToQueue(N)}}setTimeout(function(){setTimeout(function(){var P={type:"action",context:G,handler:G.handleDrop,args:[D,F,L]};G.gridObj.pushToQueue(P)},1)},1)});K.animate();if(this.gridObj.pageMode=="Progressive Load"&&this.gridObj.isDummyRow(this.gridObj.rightBodyTbl.rows[parseInt(this.gridObj.getRowIndexFromPosition()+parseInt(this.gridObj.rangeSize))])){this.gridObj.progressiveLoadGrid()}},handleDrop:function(I){var W=I[0];var D=I[1];var E=I[2];var L=B.getElementsById(W.id,this.assocTable,"tr")[0];var R=B.getElementsById(D.id,this.assocTable,"tr")[0];B.setStyle(W,"visibility","");B.setStyle(L,"visibility","");var F;if(this.gridObj.bTreegrid||this.gridObj.fixedCol){W=pega.util.Dom.getElementsById(W.id,this.gridObj.leftBodyUL)[0]}else{W=pega.util.Dom.getElementsById(W.id,this.gridObj.rightBodyTbl)[0]}if(W.parentNode==D.parentNode){F="REORDER"}else{F="DND"}var H=pega.u.d.getBaseRef(this.masterDiv);var G;if(this.gridObj.bTreegrid||this.gridObj.fixedCol){G=W.parentNode.parentNode;if(B.hasClass(G,"gridRow")){var K=pega.ui.property.toReference(G.id)}else{var K=""}G=(E=="child")?D:D.parentNode.parentNode;if(B.hasClass(G,"gridRow")){var M=pega.ui.property.toReference(G.id)}else{var M=""}}else{var K="";var M=""}var P=(K==""||F=="DND")?this.gridObj.getPLPGProperty():this.gridObj.PLPGName;var O=W.getAttribute("PL_INDEX");if(E=="child"){var Y=""}else{var U=B.getPreviousSibling(D);if(E=="before"&&this.gridObj.bFilteredGrid&&U&&U.id!=""){if(!this.gridObj.bTreegrid||this.gridObj.bTreegrid&&U.id!="gridNode"){D=U;E="after"}}var Y=D.getAttribute("PL_INDEX");if(E=="after"&&F!="REORDER"){Y=parseInt(Y)+1}else{if(E=="before"&&F=="REORDER"&&(parseInt(O)<parseInt(Y))){Y=parseInt(Y)-1}}}if(W!=D){this.gridObj.markAsDirty();pega.u.d.registerFocusIn(W);var J=SafeURL_createFromURL(pega.u.d.url);var Q=pega.u.d.getLayoutIndex(this.gridObj.gridDiv);var T={partialTrigger:"dragdrop"+this.gridObj.getConfiguredPLPGProperty()+Q,beforeDomAction:this.handleSuccess,beforeParams:[W,D,E,F],beforeDomActionContext:this,afterParams:F};if(this.gridObj.editConfig==this.gridObj.EDIT_HARNESS){T.afterDomAction=this.refreshEmbeddedPane;T.afterDomActionContext=this}T.domAction="dragdrop";J.put("PageListProperty",P);var N=this.masterDiv;if(K==""){J.put("BaseReference",H)}if(M==""){J.put("DestBaseReference",H)}J.put("TargetIndex",Y);J.put("CurrentIndex",O);J.put("PageName",K);var S=pega.ui.property.toReference(W.id);var V=pega.ui.property.toReference(D.id);J.put("sourcePageName",S);if(this.gridObj.modalThreadContext&&this.gridObj.editConfig=="harness"){J.put("pzThreadName",this.gridObj.modalThreadContext)}if(E!="child"&&F=="REORDER"){J.put("targetPageName",V);J.put("gridActivity","ReorderPageList");J.put("gridAction","REORDER");if(this.gridObj.gridPreActivity){J.put("gridPreActivity",this.gridObj.gridPreActivity)}if(this.gridObj.gridPostActivity){J.put("gridPostActivity",this.gridObj.gridPostActivity)}if(parseInt(O)>Y&&E=="after"){J.put("TargetIndex",parseInt(Y)+1)}}else{J.put("targetPageName",V);J.put("destPageName",M);J.put("gridAction","DRAGDROP");if(this.gridObj.gridPreActivity){J.put("gridPreActivity",this.gridObj.gridPreActivity)}if(this.gridObj.gridPostActivity){J.put("gridPostActivity",this.gridObj.gridPostActivity)}J.put("gridActivity","pzPerformDragDrop")}if(this.gridObj.bFilteredGrid){J.put("pyGridFilterCriteriaPage",this.gridObj.gridFilterPage);J.put("refreshLayout","true");if((this.gridObj.currentPageIndex&&this.gridObj.currentPageIndex!=""&&this.gridObj.pyPaginateActivity=="")||this.gridObj.pageMode=="Progressive Load"){J.put("pyPageSize",this.gridObj.rangeSize);J.put("currentPageIndex",this.gridObj.currentPageIndex);if(this.gridObj.pageMode=="Progressive Load"){J.put("startIndex",1);J.put("recordsInCurrentPage",(this.gridObj.currentPageIndex+1)*this.gridObj.rangeSize);window.scrollTopBeforeReorder=this.gridObj.layoutWrapperDiv.scrollTop;if(this.gridObj.bDiscardInvisibleRows){J.put("startIndex",this.gridObj.getFirstLoadedRowIndex());J.put("bDiscardInvisibleRows",this.gridObj.bDiscardInvisibleRows);var X=0;X=3*this.gridObj.rangeSize;if(this.gridObj.currentPageIndex==1){X=2*this.gridObj.rangeSize}J.put("recordsInCurrentPage",X)}}else{J.put("startIndex",((parseInt(this.gridObj.currentPageIndex,10)-1)*parseInt(this.gridObj.rangeSize,10)+1))}}T=null}J.put("KeepGridMessages",pega.u.d.KEEP_GRID_MESSAGES===true?"true":"false");pega.u.d.reloadRepeatLayout("pzdoGridAction",J.toQueryString(),null,null,N,T,true)}},getLevel:function(H){var G=this.gridObj.dataSourceRef;var E=H.id;var D=E.split("$p");var F=pega.ui.property.toHandle(G).split("$p");return D.length-(F.length-1)},handleSuccess:function(l,R){var V=R.responseText;var o=document.createDocumentFragment();var U=document.createElement("DIV");U.style.display="none";o.appendChild(U);U.innerHTML=V;this.gridObj.DDProcessing=false;if(V.indexOf("GRIDCOMMIT")>-1){var O=V.split("||GRIDCOMMIT||")[1].split("||");var u=O[0];var D=SafeURL_createFromURL(pega.u.d.url);D.put("pzTransactionId",u);pega.u.d.url=D.toURL();if(document.forms&&pega.ctx.dom.getElementsByTagName("form")[0]){var T=pega.ctx.dom.getElementsByTagName("form")[0];var F=T.action;var c=SafeURL_createFromURL(F);c.put("pzTransactionId",u);T.action=c.toURL()}}if(B.getElementsById("ERRORTABLE",U)){return }else{var f=pega.ctx.dom.getElementById("ERRORTABLE");if(f&&f.parentNode){f.parentNode.removeChild(f)}}try{this.gridObj.selectRow(this.gridObj.getIndex(this.gridObj.activeRow),false)}catch(h){}var K=l[0];var E=l[1];var J=l[2];var m=l[3];var X=B.getElementsById(K.id,this.assocTable,"tr")[0];var e=B.getElementsById(E.id,this.assocTable,"tr")[0];var g=X.rowIndex;var t=e.rowIndex;var P=this.getLevel(K);var W=this.getLevel(E);if(P!=1){var a=parseInt(B.getFirstChild(K).style.paddingLeft)-(18*(P-1))}else{var a=parseInt(B.getFirstChild(K).style.paddingLeft)}K=pega.util.Dom.getElementsById(K.id,this.gridObj.leftBodyUL)[0];E=pega.util.Dom.getElementsById(E.id,this.gridObj.leftBodyUL)[0];var H=B.getNextSibling(K);var q=K.parentNode;if(q&&q.id=="gridNode"){var k=B.getChildren(q);if(k.length==1){var M=true}}if(J=="child"&&this.gridObj.pageMode=="Progressive Load"){if(P==1){var n=Math.ceil(g/this.gridObj.rangeSize)}}var Z=null;if(this.gridObj.editConfig==this.gridObj.EDIT_EXPANDPANE){var j=B.getElementsById("rowDetail"+X.id,this.gridObj.rightBodyTbl,"DIV");if(j&&j[0]){j=j[0]}else{j=this.createExpandPaneTR(X)}if(j){Z=j.parentNode.parentNode}}if(J=="before"){if(this.gridObj.bTreegrid||this.gridObj.fixedCol){B.insertBefore(K,E)}B.insertBefore(X,e);if(this.gridObj.editConfig==this.gridObj.EDIT_EXPANDPANE&&Z){B.insertBefore(Z,e)}if(g<t){t=t-1}}else{if(J=="after"){if(this.gridObj.bTreegrid||this.gridObj.fixedCol){B.insertAfter(K,E)}var p=null;var Y=null;if(this.gridObj.editConfig==this.gridObj.EDIT_EXPANDPANE){p=B.getNextSibling(e);if(p){Y=B.getElementsById("rowDetail"+e.id,p,"DIV");if(Y&&Y[0]){Y=Y[0]}}else{Y=this.createExpandPaneTR(e);p=B.getNextSibling(e)}}if(this.gridObj.editConfig==this.gridObj.EDIT_EXPANDPANE&&Y){B.insertAfter(X,p)}else{B.insertAfter(X,e)}if(this.gridObj.editConfig==this.gridObj.EDIT_EXPANDPANE&&Z){B.insertAfter(Z,X)}if(g>t){t=t+1}}else{if(J=="child"){var S=B.getElementsById("gridNode",E);if(S&&S[0]&&B.getChildren(S[0]).length>0){S=S[0];var d=true;var L;var b=B.getLastChild(S);B.insertAfter(K,b);while(d){if(b){L=B.getElementsById(b.id,this.gridObj.rightBodyTbl)[0];S=B.getElementsById("gridNode",b);if(S&&S[0]&&B.getChildren(S[0]).length>0){S=S[0];b=B.getLastChild(S)}else{d=false;break}}}B.insertAfter(X,L);var t=L.rowIndex+1}else{if(!S){var S=document.createElement("UL");S.id="gridNode";S.className="gridNode";E.appendChild(S)}else{S=S[0]}S.appendChild(K);B.insertAfter(X,e);var t=e.rowIndex+1}var s=this.gridObj.getExpandCollNode(e.rowIndex);if(B.hasClass(s,"noEC")){B.removeClass(s,"noEC");B.addClass(s,"collapseNode")}W=W+1}}}if(M){var I=B.getElementsById(q.parentNode.id,this.assocTable,"tr")[0];var N=this.gridObj.getExpandCollNode(I.rowIndex);q.parentNode.removeChild(q);if(B.hasClass(N,"collapseNode")){B.removeClass(N,"collapseNode");B.addClass(N,"noEC")}}this.defPadding=a;this.srcLevel=P;this.destLevel=W;if(P!=W){this.correctIndentation(K,W)}if(this.gridObj.bTreegrid){this.nextTarget=X;this.moveChildren(K)}if(this.gridObj.bTreegrid){if(J!="child"&&m=="REORDER"){this.updateHandlesAfterDD([g,t,J,K,E])}else{if(H){this.gridObj.updateTreeHandlesAfterDelete([H,K.id,K.getAttribute("PL_INDEX"),K.id,g,t])}this.gridObj.updateTreeHandlesAfterInsert(-1,[K,J,g,t])}}else{this.updateHandlesAfterDD([g,t,J,K,E])}var Q=this.DDM.getRelated(this,true);for(var r in Q){Q[r].unreg()}var G=this.gridObj.rightBodyTbl.rows[this.gridObj.getIndex(X.rowIndex)];this.gridObj.activeRow=0;this.gridObj.selectPage(null,null,X.rowIndex);pega.u.d.processOnloads(K);if(n&&this.gridObj.pageMode=="Progressive Load"){this.gridObj.bCustomLoad=true;this.gridObj.progressiveLoadGrid(n)}},createExpandPaneTR:function(F){var J=F.rowIndex;var H=F.cells.length;if(H==0&&F.id=="yui_modalrownew"){var E=pega.util.Dom.getPreviousSibling(F);H=(E)?E.cells.length:1}else{if(H==1&&(F.id==""||F.id==null)){H=F.cells[0].colSpan}}var I=this.gridObj.rightBodyTbl.insertRow(J+1);I.setAttribute("expanded","true");var D=I.insertCell(-1);D.colSpan=H;var G=document.createElement("DIV");G.id="rowDetail"+F.id;D.appendChild(G);return G},refreshEmbeddedPane:function(E){var D=null;if(this.gridObj.bTreegrid){D=this.gridObj.getLeftRow()}else{D=this.gridObj.getRightRow()}pega.u.d.preReloadEle=null;if(B.getElementsById("pyFlowActionHTML",this.gridObj.gridDetailsDiv)){this.gridObj.DONOT_SUBMIT=true}if(E=="DND"){this.gridObj.propRef="";if(this.gridObj.gridDetailsDiv){if(this.gridObj.gridDetailsDiv.children.length>0){this.gridObj.gridDetailsDiv.removeChild(B.getFirstChild(this.gridObj.gridDetailsDiv))}}}if(this.gridObj.propRef){this.gridObj.jumpToIndex(null,this.gridObj.activeRow,this.templateName)}else{var F={rowEle:D};this.gridObj.triggerEditInHarness(F)}},correctIndentation:function(D,F){var E=B.getFirstChild(D);E.style.paddingLeft=(this.defPadding+(F-1)*18)+"px";if(this.gridObj.bAlwaysExpandRoot){F=F-1}B.getFirstChild(E).style.left=((F-1)*18)+"px"},moveChildren:function(T){var L=B.getElementsById("gridNode",T);if(L&&L[0]){L=L[0];var H=B.getFirstChild(L);if(H){var J=B.getLastChild(L);while(1){var Q=B.getLastChild((J));if((Q)&&(Q.id=="gridNode")&&B.getChildren(Q).length>0){J=B.getLastChild(Q)}else{break}}var U=H.id;var N=J.id;var F=B.getElementsById(U,this.gridObj.rightBodyTbl)[0];var I=F.rowIndex;var K=B.getElementsById(N,this.gridObj.rightBodyTbl)[0];var M=K.rowIndex;var V=F.parentNode;var E=false;if(this.srcLevel!=this.destLevel){E=true;var R=this.destLevel-this.srcLevel}var O=new Array();for(var S=I;S<=M;S++){O.push(V.rows[S])}for(var S=0;S<O.length;S++){var G=O[S];if(E){var P=B.getElementsById(G.id,this.gridObj.leftBodyUL)[0];var D=this.getLevel(P);D=D+R;this.correctIndentation(P,D)}B.insertAfter(G,this.nextTarget);this.nextTarget=G}}}},updateHandlesAfterDD:function(I){var L=I[0];var g=I[1];var T=I[2];var f=I[3];var D=I[4];var Q=parseInt(f.getAttribute("PL_INDEX"));var d=parseInt(D.getAttribute("PL_INDEX"));var W=this.gridObj.dataSourceRef;var V=B.getChildrenBy(f.parentNode);if(this.gridObj.bTreegrid||this.gridObj.fixedCol){if(f.parentNode!=this.gridObj.leftBodyUL){Q=Q-1;d=d-1}}if(Q<d){if(T=="before"){d=d-1}}else{if(T=="after"){d=parseInt(d)+1}}var a,P,J,X,N,H,R,G,K,M="";if(this.gridObj.currentPageIndex&&this.gridObj.currentPageIndex!=""&&this.gridObj.pyPaginateActivity==""&&this.gridObj.pageMode!="Progressive Load"&&!this.gridObj.bReportDefinition){Q=Q-((this.gridObj.currentPageIndex-1)*this.gridObj.rangeSize);d=d-((this.gridObj.currentPageIndex-1)*this.gridObj.rangeSize)}if(this.gridObj.bDiscardInvisibleRows&&this.gridObj.rightBodyTbl.rows.length>1){var O=parseInt(this.gridObj.rightBodyTbl.rows[1].getAttribute("PL_INDEX"),10);if(Q<O){O=Q}if(d<O){O=d}Q=Q-O+1;d=d-O+1}var Y=Q;while(true){if(!((Q<d&&Y<=d)||(Q>d&&Y>=d))){break}if(this.gridObj.bTreegrid||this.gridObj.fixedCol){var S=V[Y]}else{var S=V[this.gridObj.getIndex(Y)]}a=S.id;if(this.gridObj.editConfig==this.gridObj.EDIT_EXPANDPANE&&a==null){continue}var E=B.getElementsById(S.id,this.gridObj.rightBodyTbl);if(E.length>1){if(Q<d){c=E[E.length-1]}else{c=E[0]}}else{var c=E[0]}J=P;P=a;X=S.getAttribute("PL_INDEX");H=N;N=X;K=M;M=N;if(this.gridObj.pyPaginateActivity||this.gridObj.bDiscardInvisibleRows||(this.gridObj.pageMode!="Progressive Load"&&parseInt(this.gridObj.currentPageIndex)>1)){if(!this.gridObj.bTreegrid&&this.gridObj.bNumberedSkin){var U=null;if(this.gridObj.fixedCol){U=pega.u.d.getNumberingElement(S)}else{U=pega.u.d.getNumberingElement(c)}M=U.innerHTML}}R=G;G=S.id;if(Y==Q){var h=null;if(this.gridObj.bTreegrid||this.gridObj.fixedCol){h=V[d]}else{h=V[this.gridObj.getIndex(d)]}J=h.id;H=h.getAttribute("PL_INDEX");R=J;K=H;if(this.gridObj.pyPaginateActivity||this.gridObj.bDiscardInvisibleRows||(this.gridObj.pageMode!="Progressive Load"&&parseInt(this.gridObj.currentPageIndex)>1)){if(!this.gridObj.bTreegrid&&this.gridObj.bNumberedSkin){var b=pega.u.d.getNumberingElement(h);if(b){K=b.innerHTML}}}}if(!this.gridObj.bTreegrid&&this.gridObj.bNumberedSkin){if(this.gridObj.fixedCol){pega.u.d.setLeftTableValues(S,K)}else{pega.u.d.setLeftTableValues(c,K)}}if(this.gridObj.editConfig==this.gridObj.EDIT_EXPANDPANE){var e=B.getNextSibling(c);var F=pega.util.Dom.getElementsById("rowDetail"+a,e,"DIV");if(F&&F[0]){if(F.length>1){if(Q<d){F=F[F.length-1]}else{F=F[0]}}else{F=F[0]}}if(F){pega.u.d.updateInnerHTML(F.parentNode.parentNode,P,J);if(this.gridObj.propRef!=""&&this.gridObj.propRef==pega.ui.property.toReference(P)){this.gridObj.propRef=pega.ui.property.toReference(J)}}}a=a.replace(/\$/g,"\\$");if(this.gridObj.bTreegrid||this.gridObj.fixedCol){pega.u.d.updateHandles(S,a,J,X,H,R,W)}pega.u.d.updateHandles(c,a,J,X,H,R,W);var Z=B.getLastChild(S);if(Z&&Z.id=="gridNode"){this.gridObj.updateChildHandles(Z,J,L,g,f.id,W)}if(Q<d){Y++}else{Y--}}return false},_resizeProxy:function(){if(this.resizeFrame){var D=this.getDragEl();B.addClass(D,"dragProxy");D.style.border="1px solid #000000";D.style.borderTop="1px solid #c0c0c0";D.style.borderLeft="1px solid #c0c0c0";D.style.height="20px";D.style.width="auto";var E=this.gridObj.getFirstCellVal();if(E.indexOf("CONTROL_NOT_VISIBLE_IN_DDPROXY")!=-1){E=""}D.innerHTML=E;D.style.opacity=0.8;D.style.filter="alpha(opacity="+80+")"}},onMouseUp:function(D){if(this.lastHighlightedElements){B.removeClass(this.lastHighlightedElements[0],"insertAfter");B.removeClass(this.lastHighlightedElements[0],"insertChild");B.removeClass(this.lastHighlightedElements[0],"insertBefore");B.removeClass(this.lastHighlightedElements[1],"insertAfter");B.removeClass(this.lastHighlightedElements[1],"insertChild");B.removeClass(this.lastHighlightedElements[1],"insertBefore")}this.bScrollGridUp=false;this.bScrollGridDown=false;this.unreg()}});pega.ui.gridColDD=function(G,D,F,E){this.gridObj=E;pega.ui.gridColDD.superclass.constructor.call(this,G,E.gridDiv.id);this.masterDiv=F;this.goingLeft=false;this.lastX=0;this.clickEl=null;this.table=G;this.clickIndex=0;this.assocTable=D;this.assocClickIndex=0;this.destIndex=0;this.assocDestIndex=0;this.lastDestEl=null};pega.extend(pega.ui.gridColDD,pega.util.DDProxy,{findParentTD:function(D){if(D.nodeName.toLowerCase()=="td"){return D}var E=D.parentNode;while(E&&!E.getElementById){if(E.nodeName.toLowerCase()=="td"){return E}E=E.parentNode}return null},calculateIndex:function(D){this.bFixedRow=(this.gridObj.fixedRow!=false);this.bFixedColumn=(this.gridObj.fixedCol!=false);var E=D.cellIndex;if(E%2==0){return null}if(this.bFixedRow&&this.bFixedColumn){return[[E,E],[(E+1)/2]]}else{if(this.bFixedRow){return[[E,E],[(E+1)/2]]}else{if(this.bFixedColumn){return[[E],[E,(E+1)/2]]}else{return[[E],[E,(E+1)/2]]}}}},onMouseDown:function(D){this.__yui_events.mouseDownEvent.subscribe(this.onMouseDownEvent,this);this.fireEventsCopy=this.DDM.fireEvents;this.DDM.fireEvents=this.fireEventsCustom},onMouseDownEvent:function(G){var H=A.getTarget(G);this.clickEl=this.findParentTD(H);H=this.clickEl;if(!H){return false}if(!B.isAncestor(this.table.rows[0],H)){return false}var E=this.calculateIndex(H);if(!E){return false}this.clickIndex=E[0][0];if(this.clickIndex==0||this.clickIndex==this.table.rows[0].cells.length-1){return false}var F=E[1].length;this.assocClickIndex=E[1][F-1];var D=this.getDragEl();this.initConstraints();this.deltaX=0;this.deltaY=0;this.deltaSetXY=[0,0];if(!this.insertIndicate.proxInitialized){this.insertIndicate.init(this)}},insertIndicate:{init:function(D){this.obj=D;this.proxy=document.createElement("div");B.addClass(this.proxy,"col-move-up");document.body.insertBefore(this.proxy,document.body.firstChild);this.proxInitialized=true},getEl:function(){return this.proxy},show:function(){B.setStyle(this.proxy,"visibility","visible")},hide:function(){B.setStyle(this.proxy,"visibility","hidden")},setLeftTop:function(F,E){var D=this.getEl();B.setXY(D,[F,E-4])}},b4Drag:function(F){var E=A.getTarget(F);var D=this.findParentTD(E);if(B.isAncestor(this.table,D)){if(D){this.destEl=D}}else{if(this.lastDestEl){this.destEl=this.lastDestEl}}},startDrag:function(D,E){},initConstraints:function(){var G=this.table.parentNode;var F=pega.ctx.dom.getElementById("HARNESS_CONTENT");this.dragRegionH=G;var E=B.getRegion(this.dragRegionH);this.dragRegionH=this.assocTable.parentNode;var D=this.table.rows[0].cells;this.lastCell=D[D.length-1];this.constrainX=true;this.minX=E.left+5;this.maxX=E.right-(2*this.lastCell.offsetWidth+15);this.dragRegionV=G;var E=B.getRegion(this.dragRegionV);this.constrainY=true;this.minY=E.top;this.maxY=E.bottom},_resizeProxy:function(){if(this.resizeFrame){var H=this.clickEl;var D=this.getDragEl();var F=parseInt(B.getStyle(D,"borderTopWidth"),10);var G=parseInt(B.getStyle(D,"borderRightWidth"),10);var I=parseInt(B.getStyle(D,"borderBottomWidth"),10);var K=parseInt(B.getStyle(D,"borderLeftWidth"),10);if(isNaN(F)){F=0}if(isNaN(G)){G=0}if(isNaN(I)){I=0}if(isNaN(K)){K=0}var J=this.assocTable.parentNode;if(J.offsetHeight>this.assocTable.offsetHeight){var E=Math.max(0,this.assocTable.offsetHeight+this.table.offsetHeight-this.table.rows[0].offsetHeight)}else{var E=Math.max(0,J.offsetHeight-F-I+this.table.offsetHeight-this.table.rows[0].offsetHeight)}B.setStyle(D,"height",E+"px");B.setStyle(D,"width","42px");B.addClass(D,"dragChild");B.setStyle(D,"cursor","default")}},onDrag:function(I){var O=A.getPageX(I);var G=this.getDragEl();var M=this.destEl;if(!M){M=this.lastDestEl}if(!M){return false}var Q=this.calculateIndex(M);if(!Q){return false}var J=Q[0][0];var F=Q[1].length;var P=Q[1][F-1];var E=this.table.rows[0];var L=this.assocTable.rows[F];if(O<this.lastX){this.goingLeft=true;B.setStyle(G,"backgroundImage","url(images/pzdrag-left.png)")}else{if(O>this.lastX){this.goingLeft=false;B.setStyle(G,"backgroundImage","url(images/pzdrag-right.png)")}}function D(){if(P>=1&&J>=2&&!H.stopScroll&&H.startScroll){H.dragRegionH.scrollLeft-=L.cells[P].offsetWidth;--P}else{clearInterval(H.timeToken)}}var N=0;if(L){N=L.cells.length-1}function K(){if(P+1<=N&&!H.stopScroll&&H.startScroll){H.dragRegionH.scrollLeft+=L.cells[P].offsetWidth;++P}else{clearInterval(H.timeToken)}}var H=this;if(O>this.maxX){if(!this.startScroll){this.timeToken=setInterval(K,200)}this.startScroll=true;this.stopScroll=false}else{if(O<this.minX){if(!this.startScroll){this.timeToken=setInterval(D,200)}this.startScroll=true;this.stopScroll=false}else{this.stopScroll=true;this.startScroll=false;if(!this.goingLeft){this.applyBorder(J+1,O)}else{if(this.goingLeft){this.applyBorder(J-1,O)}}}}this.lastX=O},applyBorder:function(F,E){var G=this.table;var J=G.rows[0];if(F>=0){var I=J.cells[F];var H=B.getRegion(I);if(H){var D=this.getDragEl();this.insertIndicate.setLeftTop(H.right+4,H.top);this.insertIndicate.show();this.setDragElPos(E,H.bottom)}if(I){this.lastDestEl=I}}},onDragDrop:function(K,D){var M=false;var H=this.destEl;if(!H){return }if(H&&H.tagName&&(H.tagName.toLowerCase()=="td")){M=true;var O=this.calculateIndex(H);if(!O){return false}var F=O[0][0];this.destIndex=F;var E=O[1].length;var N=O[1][E-1];this.assocDestIndex=N}var J=this.clickIndex;var L=this.assocClickIndex;if(J==F){return false}for(var G=0,I=this.assocTable.rows.length;G<I;G++){if(G<O[0].length){if(!this.goingLeft){this.moveCell(this.table,G,J,F+2,M);if(F<J){this.moveCell(this.table,G,J+1,F+3,M)}else{this.moveCell(this.table,G,J,F+2,M)}}else{if(this.goingLeft){this.moveCell(this.table,G,J,F,M);if(F<J){this.moveCell(this.table,G,J+1,F+1,M)}else{this.moveCell(this.table,G,J,F,M)}}}}if(G==0){}else{if(!this.goingLeft){this.moveCell(this.assocTable,G,L,N+1,M)}else{if(this.goingLeft){this.moveCell(this.assocTable,G,L,N,M)}}}}},moveCell:function(H,G,E,F,I){var K=H.rows[G].cells[E];if(I){try{var D=H.rows[G].cells[F];K.parentNode.insertBefore(K,D)}catch(J){}}else{setTimeout(function(){K.parentNode.appendChild(K)},0)}},endDrag:function(H){var G=this.assocTable.rows;var E=G[G.length-1].cells.length-2;this.insertIndicate.hide();if(this.destEl&&this.destEl.nodeName.toLowerCase()=="td"){var I=pega.u.d.getBaseRef(this.masterDiv);var D=SafeURL_createFromURL(pega.u.d.url);D.put("PageListProperty",this.assocTable.getAttribute("pl_prop"));D.put("BaseReference",I);var F=(this.assocDestIndex==0?this.assocClickIndex:this.assocDestIndex);if(this.assocClickIndex<this.assocDestIndex){if(this.goingLeft){F--}}if(this.assocClickIndex>this.assocDestIndex){if(this.goingLeft){F+=0}}if(F<=0){return false}if(F>E){F=E}D.put("TargetIndex",F);D.put("CurrentIndex",this.assocClickIndex);if(F==this.assocClickIndex){return false}this.gridObj.markAsDirty();pega.u.d.reloadRepeatLayout("ReorderPageList",D.toQueryString(),H,null,this.masterDiv,null,true)}},onMouseUp:function(D){this.DDM.fireEvents=this.fireEventsCopy},fireEventsCustom:function(W,M){var c=this.dragCurrent;if(!c||c.isLocked()||c.dragOnly){return }var O=pega.util.Event.getPageX(W),N=pega.util.Event.getPageY(W),Q=new pega.util.Point(O,N),L=c.getTargetCoord(Q.x,Q.y),G=c.getDragEl(),F=["out","over","drop","enter"],V=new pega.util.Region(L.y,L.x+G.offsetWidth,L.y+G.offsetHeight,L.x),J=[],E={},R=[],d={outEvts:[],overEvts:[],dropEvts:[],enterEvts:[]};for(var T in this.dragOvers){var f=this.dragOvers[T];if(!this.isTypeOfDD(f)){continue}if(!this.isOverTarget(Q,f,this.mode,V)){d.outEvts.push(f)}J[T]=true;delete this.dragOvers[T]}for(var S in c.groups){if("string"!=typeof S){continue}for(T in this.ids[S]){var H=this.ids[S][T];if(!this.isTypeOfDD(H)){continue}if(H.isTarget&&!H.isLocked()){if(this.isOverTarget(Q,H,this.mode,V)){E[S]=true;if(M){d.dropEvts.push(H)}else{if(!J[H.id]){d.enterEvts.push(H)}else{d.overEvts.push(H)}this.dragOvers[H.id]=H}}}}}this.interactionInfo={out:d.outEvts,enter:d.enterEvts,over:d.overEvts,drop:d.dropEvts,point:Q,draggedRegion:V,sourceRegion:this.locationCache[c.id],validDrop:M};for(var D in E){R.push(D)}if(M&&!d.dropEvts.length){this.interactionInfo.validDrop=false;if(c.events.invalidDrop){c.onInvalidDrop(W);c.fireEvent("invalidDropEvent",{e:W})}}for(T=0;T<F.length;T++){var Z=null;if(d[F[T]+"Evts"]){Z=d[F[T]+"Evts"]}if(Z&&Z.length){var I=F[T].charAt(0).toUpperCase()+F[T].substr(1),Y="onDrag"+I,K="b4Drag"+I,P="drag"+I+"Event",X="drag"+I;if(this.mode){if(c.events[K]){c[K](W,Z,R);c.fireEvent(K+"Event",{event:W,info:Z,group:R})}if(c.events[X]){c[Y](W,Z,R);c.fireEvent(P,{event:W,info:Z,group:R})}}else{for(var a=0,U=Z.length;a<U;++a){if(c.events[K]){c[K](W,Z[a].id,R[0]);c.fireEvent(K+"Event",{event:W,info:Z[a].id,group:R[0]})}if(c.events[X]){c[Y](W,Z[a].id,R[0]);c.fireEvent(P,{event:W,info:Z[a].id,group:R[0]})}}}}}}})})();
(function(){if("undefined"!=typeof pega){var c=pega.util.Dom,h=pega.util.Event,l=pega.lang,k=function(a,b){k.superclass.constructor.call(this,a,b||{})};k._instances={};k.getResizeById=function(a){return k._instances[a]?k._instances[a]:!1};pega.extend(k,pega.util.Element,{CSS_RESIZE:"yui-resize",CSS_DRAG:"yui-draggable",CSS_HOVER:"yui-resize-hover",CSS_PROXY:"yui-resize-proxy",CSS_WRAP:"yui-resize-wrap",CSS_KNOB:"yui-resize-knob",CSS_HIDDEN:"yui-resize-hidden",CSS_HANDLE:"yui-resize-handle",CSS_STATUS:"yui-resize-status",
CSS_GHOST:"yui-resize-ghost",CSS_RESIZING:"yui-resize-resizing",_resizeEvent:null,dd:null,browser:pega.env.ua,_positioned:null,_dds:null,_wrap:null,_proxy:null,_handles:null,_currentHandle:null,_currentDD:null,_cache:null,_active:null,_createProxy:function(){this.get("proxy")?(this._proxy=document.createElement("div"),this._proxy.className=this.CSS_PROXY,this._proxy.style.height=this.get("element").clientHeight+"px",this._proxy.style.width=this.get("element").clientWidth+"px",this._wrap.parentNode.appendChild(this._proxy)):
this.set("animate",!1)},_createWrap:function(){this._positioned=!1;switch(this.get("element").tagName.toLowerCase()){case "img":case "textarea":case "input":case "iframe":case "select":this.set("wrap",!0)}if(this.get("wrap")){this._wrap=document.createElement("div");this._wrap.id=this.get("element").id+"_wrap";this._wrap.className=this.CSS_WRAP;c.setStyle(this._wrap,"width",this.get("width"));c.setStyle(this._wrap,"height",this.get("height"));c.setStyle(this._wrap,"z-index",this.getStyle("z-index"));
this.setStyle("z-index",0);var a=c.getStyle(this.get("element"),"position");c.setStyle(this._wrap,"position","static"==a?"relative":a);c.setStyle(this._wrap,"top",c.getStyle(this.get("element"),"top"));c.setStyle(this._wrap,"left",c.getStyle(this.get("element"),"left"));"absolute"==c.getStyle(this.get("element"),"position")&&(this._positioned=!0,c.setStyle(this.get("element"),"position","relative"),c.setStyle(this.get("element"),"top","0"),c.setStyle(this.get("element"),"left","0"));this.get("element").parentNode.replaceChild(this._wrap,
this.get("element"));this._wrap.appendChild(this.get("element"))}else this._wrap=this.get("element"),"absolute"==c.getStyle(this._wrap,"position")&&(this._positioned=!0);this.get("draggable")&&this._setupDragDrop();this.get("hover")&&c.addClass(this._wrap,this.CSS_HOVER);this.get("knobHandles")&&c.addClass(this._wrap,this.CSS_KNOB);this.get("hiddenHandles")&&c.addClass(this._wrap,this.CSS_HIDDEN);c.addClass(this._wrap,this.CSS_RESIZE)},_setupDragDrop:function(){c.addClass(this._wrap,this.CSS_DRAG);
this.dd=new pega.util.DD(this._wrap,this.get("id")+"-resize",{dragOnly:!0});this.dd.on("dragEvent",function(){this.fireEvent("dragEvent",arguments)},this,!0)},_createHandles:function(){this._handles={};this._dds={};for(var a=this.get("handles"),b=0;b<a.length;b++){this._handles[a[b]]=document.createElement("div");this._handles[a[b]].id=c.generateId(this._handles[a[b]]);this._handles[a[b]].className=this.CSS_HANDLE+" "+this.CSS_HANDLE+"-"+a[b];var e=document.createElement("div");e.className=this.CSS_HANDLE+
"-inner-"+a[b];this._handles[a[b]].appendChild(e);this._wrap.appendChild(this._handles[a[b]]);h.on(this._handles[a[b]],"mouseover",this._handleMouseOver,this,!0);h.on(this._handles[a[b]],"mouseout",this._handleMouseOut,this,!0);this._dds[a[b]]=new pega.util.DragDrop(this._handles[a[b]],this.get("id")+"-handle-"+a);this._dds[a[b]].setPadding(15,15,15,15);this._dds[a[b]].on("startDragEvent",this._handleStartDrag,this._dds[a[b]],this);this._dds[a[b]].on("mouseDownEvent",this._handleMouseDown,this._dds[a[b]],
this)}this._status=document.createElement("span");this._status.className=this.CSS_STATUS;document.body.insertBefore(this._status,document.body.firstChild)},_ieSelectFix:function(){return!1},_ieSelectBack:null,_setAutoRatio:function(a){this.get("autoRatio")&&(a&&a.shiftKey?this.set("ratio",!0):this.set("ratio",this._configs.ratio._initialConfig.value))},_handleMouseDown:function(a){"absolute"==c.getStyle(this._wrap,"position")&&(this._positioned=!0);a&&this._setAutoRatio(a);this.browser.ie&&(this._ieSelectBack=
document.body.onselectstart)},_handleMouseOver:function(a){c.removeClass(this._wrap,this.CSS_RESIZE);this.get("hover")&&c.removeClass(this._wrap,this.CSS_HOVER);a=h.getTarget(a);c.hasClass(a,this.CSS_HANDLE)||(a=a.parentNode);if(c.hasClass(a,this.CSS_HANDLE)&&!this._active){c.addClass(a,this.CSS_HANDLE+"-active");for(var b in this._handles)if(l.hasOwnProperty(this._handles,b)&&this._handles[b]==a){c.addClass(a,this.CSS_HANDLE+"-"+b+"-active");break}}c.addClass(this._wrap,this.CSS_RESIZE)},_handleMouseOut:function(a){c.removeClass(this._wrap,
this.CSS_RESIZE);this.get("hover")&&!this._active&&c.addClass(this._wrap,this.CSS_HOVER);a=h.getTarget(a);c.hasClass(a,this.CSS_HANDLE)||(a=a.parentNode);if(c.hasClass(a,this.CSS_HANDLE)&&!this._active){c.removeClass(a,this.CSS_HANDLE+"-active");for(var b in this._handles)if(l.hasOwnProperty(this._handles,b)&&this._handles[b]==a){c.removeClass(a,this.CSS_HANDLE+"-"+b+"-active");break}}c.addClass(this._wrap,this.CSS_RESIZE)},_handleStartDrag:function(a,b){a=b.getDragEl();if(c.hasClass(a,this.CSS_HANDLE)){"absolute"==
c.getStyle(this._wrap,"position")&&(this._positioned=!0);this._active=!0;this._currentDD=b;this._proxy&&(this._proxy.style.visibility="visible",this._proxy.style.zIndex="1000",this._proxy.style.height=this.get("element").clientHeight+"px",this._proxy.style.width=this.get("element").clientWidth+"px");for(var e in this._handles)if(l.hasOwnProperty(this._handles,e)&&this._handles[e]==a){this._currentHandle=e;var d="_handle_for_"+e;c.addClass(a,this.CSS_HANDLE+"-"+e+"-active");b.on("dragEvent",this[d],
this,!0);b.on("mouseUpEvent",this._handleMouseUp,this,!0);break}c.addClass(a,this.CSS_HANDLE+"-active");this.get("proxy")&&(b=c.getXY(this.get("element")),c.setXY(this._proxy,b),this.get("ghost")&&this.addClass(this.CSS_GHOST));c.addClass(this._wrap,this.CSS_RESIZING);this._setCache();this._updateStatus(this._cache.height,this._cache.width,this._cache.top,this._cache.left);this.fireEvent("startResize",{type:"startresize",target:this})}},_setCache:function(){this._cache.xy=c.getXY(this._wrap);c.setXY(this._wrap,
this._cache.xy);this._cache.height=$(this._configs.element.value).height();this._cache.width=$(this._configs.element.value).width();this._cache.start.height=this._cache.height;this._cache.start.width=this._cache.width;this._cache.start.top=this._cache.xy[1];this._cache.start.left=this._cache.xy[0];this._cache.top=this._cache.xy[1];this._cache.left=this._cache.xy[0];this.set("height",this._cache.height,!0);this.set("width",this._cache.width,!0)},_handleMouseUp:function(a){this._active=!1;this._currentDD.unsubscribe("dragEvent",
this["_handle_for_"+this._currentHandle],this,!0);this._currentDD.unsubscribe("mouseUpEvent",this._handleMouseUp,this,!0);this._proxy&&(this._proxy.style.visibility="hidden",this._proxy.style.zIndex="-1",this.get("setSize")?this.resize(a,this._cache.height,this._cache.width,this._cache.top,this._cache.left,!0):this.fireEvent("resize",{ev:"resize",target:this,height:this._cache.height,width:this._cache.width,top:this._cache.top,left:this._cache.left}),this.get("ghost")&&this.removeClass(this.CSS_GHOST));
this.get("hover")&&c.addClass(this._wrap,this.CSS_HOVER);this._status&&c.setStyle(this._status,"display","none");this.browser.ie&&(document.body.onselectstart=this._ieSelectBack);this.browser.ie&&c.removeClass(this._wrap,this.CSS_RESIZE);for(var b in this._handles)l.hasOwnProperty(this._handles,b)&&c.removeClass(this._handles[b],this.CSS_HANDLE+"-active");this.get("hover")&&!this._active&&c.addClass(this._wrap,this.CSS_HOVER);c.removeClass(this._wrap,this.CSS_RESIZING);c.removeClass(this._handles[this._currentHandle],
this.CSS_HANDLE+"-"+this._currentHandle+"-active");c.removeClass(this._handles[this._currentHandle],this.CSS_HANDLE+"-active");this.browser.ie&&c.addClass(this._wrap,this.CSS_RESIZE);this._currentHandle=this._resizeEvent=null;this.get("animate")||(this.set("height",this._cache.height,!0),this.set("width",this._cache.width,!0));this.fireEvent("endResize",{ev:"endResize",target:this,height:this._cache.height,width:this._cache.width,top:this._cache.top,left:this._cache.left})},_setRatio:function(a,b,
e,c){var d=a,f=b;if(this.get("ratio")){var d=parseInt(this.get("height"),10),f=parseInt(this.get("width"),10),l=this.get("maxHeight"),m=this.get("minHeight");this.get("maxWidth");this.get("minWidth");switch(this._currentHandle){case "l":a=Math.min(Math.max(m,b/f*d),l);b=a/d*f;e=this._cache.start.top- -((d-a)/2);c=this._cache.start.left- -(f-b);break;case "r":a=Math.min(Math.max(m,b/f*d),l);b=a/d*f;e=this._cache.start.top- -((d-a)/2);break;case "t":b=a/d*f;a=b/f*d;c=this._cache.start.left- -((f-b)/
2);e=this._cache.start.top- -(d-a);break;case "b":b=a/d*f;a=b/f*d;c=this._cache.start.left- -((f-b)/2);break;case "bl":a=b/f*d;b=a/d*f;c=this._cache.start.left- -(f-b);break;case "br":a=b/f*d;b=a/d*f;break;case "tl":a=b/f*d;b=a/d*f;c=this._cache.start.left- -(f-b);e=this._cache.start.top- -(d-a);break;case "tr":a=b/f*d,b=a/d*f,c=this._cache.start.left,e=this._cache.start.top- -(d-a)}d=this._checkHeight(a);f=this._checkWidth(b);if(d!=a||f!=b)c=e=0,d!=a&&(f=this._cache.width),f!=b&&(d=this._cache.height)}return[d,
f,e,c]},_updateStatus:function(a,b,e,d){this._resizeEvent&&!l.isString(this._resizeEvent)&&(this.get("status")&&c.setStyle(this._status,"display","inline"),a=0===a?this._cache.start.height:a,b=0===b?this._cache.start.width:b,d=parseInt(this.get("height"),10),e=parseInt(this.get("width"),10),isNaN(d)&&(d=parseInt(a,10)),isNaN(e)&&(e=parseInt(b,10)),d=parseInt(a,10)-d,e=parseInt(b,10)-e,this._cache.offsetHeight=d,this._cache.offsetWidth=e,this._status.innerHTML="\x3cstrong\x3e"+parseInt(a,10)+" x "+
parseInt(b,10)+"\x3c/strong\x3e\x3cem\x3e"+(0<d?"+":"")+d+" x "+(0<e?"+":"")+e+"\x3c/em\x3e",c.setXY(this._status,[h.getPageX(this._resizeEvent)+12,h.getPageY(this._resizeEvent)+12]))},reset:function(){this.resize(null,this._cache.start.height,this._cache.start.width,this._cache.start.top,this._cache.start.left,!0);return this},resize:function(a,b,e,d,g,f,l){this._resizeEvent=a;var m=this._wrap,k=this.get("animate"),h=!0;this._proxy&&!f&&(m=this._proxy,k=!1);this._setAutoRatio(a);this._positioned&&
this._proxy&&(d=this._cache.top-d,g=this._cache.left-g);a=this._setRatio(b,e,d,g);b=parseInt(a[0],10);e=parseInt(a[1],10);d=parseInt(a[2],10);g=parseInt(a[3],10);0==d&&(d=c.getY(m));0==g&&(g=c.getX(m));this._positioned&&(this._proxy&&f?k?(d=this._proxy.style.top,g=this._proxy.style.left):(m.style.top=this._proxy.style.top,m.style.left=this._proxy.style.left):(this.get("ratio")||this._proxy||(d=this._cache.top+-d,g=this._cache.left+-g),d&&(this.get("minY")&&d<this.get("minY")&&(d=this.get("minY")),
this.get("maxY")&&d>this.get("maxY")&&(d=this.get("maxY"))),g&&(this.get("minX")&&g<this.get("minX")&&(g=this.get("minX")),this.get("maxX")&&g+e>this.get("maxX")&&(g=this.get("maxX")-e))));if(!l&&!1===this.fireEvent("beforeResize",{ev:"beforeResize",target:this,height:b,width:e,top:d,left:g}))return!1;this._updateStatus(b,e,d,g);!this._positioned||this._proxy&&f||(d&&(c.setY(m,d),this._cache.top=d),g&&(c.setX(m,g),this._cache.left=g));b&&(k||(h=!0,this._proxy&&f&&(this.get("setSize")||(h=!1)),h&&
(m.style.height=b+"px"),(this._proxy&&f||!this._proxy)&&this._wrap!=this.get("element")&&(this.get("element").style.height=b+"px")),this._cache.height=b);e&&(this._cache.width=e,k||(h=!0,this._proxy&&f&&(this.get("setSize")||(h=!1)),h&&(m.style.width=e+"px"),(this._proxy&&f||!this._proxy)&&this._wrap!=this.get("element")&&(this.get("element").style.width=e+"px")));k?pega.util.Anim&&(f=new pega.util.Anim(m,{height:{to:this._cache.height},width:{to:this._cache.width}},this.get("animateDuration"),this.get("animateEasing")),
this._positioned&&(d&&(f.attributes.top={to:parseInt(d,10)}),g&&(f.attributes.left={to:parseInt(g,10)})),this._wrap!=this.get("element")&&f.onTween.subscribe(function(){this.get("element").style.height=m.style.height;this.get("element").style.width=m.style.width},this,!0),f.onComplete.subscribe(function(){this.set("height",b);this.set("width",e);this.fireEvent("resize",{ev:"resize",target:this,height:b,width:e,top:d,left:g})},this,!0),f.animate()):this._proxy&&!f?this.fireEvent("proxyResize",{ev:"proxyresize",
target:this,height:b,width:e,top:d,left:g}):this.fireEvent("resize",{ev:"resize",target:this,height:b,width:e,top:d,left:g});return this},_handle_for_br:function(a){var b=this._setWidth(a.e),c=this._setHeight(a.e);this.resize(a.e,c+1,b,0,0)},_handle_for_bl:function(a){var b=this._setWidth(a.e,!0),c=this._setHeight(a.e);this.resize(a.e,c,b,0,b-this._cache.width)},_handle_for_tl:function(a){var b=this._setWidth(a.e,!0),c=this._setHeight(a.e,!0);this.resize(a.e,c,b,c-this._cache.height,b-this._cache.width)},
_handle_for_tr:function(a){var b=this._setWidth(a.e),c=this._setHeight(a.e,!0);this.resize(a.e,c,b,c-this._cache.height,0)},_handle_for_r:function(a){this._dds.r.setYConstraint(0,0);var b=this._setWidth(a.e);this.resize(a.e,0,b,0,0)},_handle_for_l:function(a){this._dds.l.setYConstraint(0,0);var b=this._setWidth(a.e,!0);this.resize(a.e,0,b,0,b-this._cache.width)},_handle_for_b:function(a){this._dds.b.setXConstraint(0,0);var b=this._setHeight(a.e);this.resize(a.e,b,0,0,0)},_handle_for_t:function(a){this._dds.t.setXConstraint(0,
0);var b=this._setHeight(a.e,!0);this.resize(a.e,b,0,b-this._cache.height,0)},_setWidth:function(a,b){var c=this._cache.xy[0];a=h.getPageX(a);var d=a-c;b&&(d=c-a+parseInt(this.get("width"),10));d=this._snapTick(d,this.get("yTicks"));return d=this._checkWidth(d)},_checkWidth:function(a){this.get("minWidth")&&a<=this.get("minWidth")&&(a=this.get("minWidth"));this.get("maxWidth")&&a>=this.get("maxWidth")&&(a=this.get("maxWidth"));return a},_checkHeight:function(a){this.get("minHeight")&&a<=this.get("minHeight")&&
(a=this.get("minHeight"));this.get("maxHeight")&&a>=this.get("maxHeight")&&(a=this.get("maxHeight"));return a},_setHeight:function(a,b){var c=this._cache.xy[1];a=h.getPageY(a);var d=a-c;b&&(d=c-a+parseInt(this.get("height"),10));d=this._snapTick(d,this.get("xTicks"));return d=this._checkHeight(d)},_snapTick:function(a,b){if(!a||!b)return a;var c=a,d=a%b;0<d&&(c=d>b/2?a+(b-d):a-d);return c},init:function(a,b){this._cache={xy:[],height:0,width:0,top:0,left:0,offsetHeight:0,offsetWidth:0,start:{height:0,
width:0,top:0,left:0}};k.superclass.init.call(this,a,b);this.set("setSize",this.get("setSize"));b.height&&this.set("height",parseInt(b.height,10));b.width&&this.set("width",parseInt(b.width,10));l.isString(a)||(a=c.generateId(a));k._instances[a]=this;this._active=!1;this._createWrap();this._createProxy();this._createHandles()},getProxyEl:function(){return this._proxy},getWrapEl:function(){return this._wrap},getStatusEl:function(){return this._status},getActiveHandleEl:function(){return this._handles[this._currentHandle]},
isActive:function(){return this._active?!0:!1},initAttributes:function(a){k.superclass.initAttributes.call(this,a);this.setAttributeConfig("setSize",{value:!1===a.setSize?!1:!0,validator:pega.lang.isBoolean});this.setAttributeConfig("wrap",{writeOnce:!0,validator:pega.lang.isBoolean,value:a.wrap||!1});this.setAttributeConfig("handles",{writeOnce:!0,value:a.handles||["r","b","br"],validator:function(a){l.isString(a)&&"all"==a.toLowerCase()&&(a="t b r l bl br tl tr".split(" "));l.isArray(a)||(a=a.replace(/, /g,
","),a=a.split(","));this._configs.handles.value=a}});this.setAttributeConfig("width",{value:a.width||parseInt(this.getStyle("width"),10),validator:pega.lang.isNumber,method:function(a){a=parseInt(a,10);0<a&&(this.get("setSize")&&this.setStyle("width",a+"px"),this._cache.width=a,this._configs.width.value=a)}});this.setAttributeConfig("height",{value:a.height||parseInt(this.getStyle("height"),10),validator:pega.lang.isNumber,method:function(a){a=parseInt(a,10);0<a&&(this.get("setSize")&&this.setStyle("height",
a+"px"),this._cache.height=a,this._configs.height.value=a)}});this.setAttributeConfig("minWidth",{value:a.minWidth||15,validator:pega.lang.isNumber});this.setAttributeConfig("minHeight",{value:a.minHeight||15,validator:pega.lang.isNumber});this.setAttributeConfig("maxWidth",{value:a.maxWidth||1E4,validator:pega.lang.isNumber});this.setAttributeConfig("maxHeight",{value:a.maxHeight||1E4,validator:pega.lang.isNumber});this.setAttributeConfig("minY",{value:a.minY||!1});this.setAttributeConfig("minX",
{value:a.minX||!1});this.setAttributeConfig("maxY",{value:a.maxY||!1});this.setAttributeConfig("maxX",{value:a.maxX||!1});this.setAttributeConfig("animate",{value:a.animate||!1,validator:function(a){a=!0;pega.util.Anim||(a=!1);return a}});this.setAttributeConfig("animateEasing",{value:a.animateEasing||function(){var a=!1;try{a=pega.util.Easing.easeOut}catch(e){}return a}()});this.setAttributeConfig("animateDuration",{value:a.animateDuration||.5});this.setAttributeConfig("proxy",{value:a.proxy||!1,
validator:pega.lang.isBoolean});this.setAttributeConfig("ratio",{value:a.ratio||!1,validator:pega.lang.isBoolean});this.setAttributeConfig("ghost",{value:a.ghost||!1,validator:pega.lang.isBoolean});this.setAttributeConfig("draggable",{value:a.draggable||!1,validator:pega.lang.isBoolean,method:function(a){a&&this._wrap?this._setupDragDrop():this.dd&&(c.removeClass(this._wrap,this.CSS_DRAG),this.dd.unreg())}});this.setAttributeConfig("hover",{value:a.hover||!1,validator:pega.lang.isBoolean});this.setAttributeConfig("hiddenHandles",
{value:a.hiddenHandles||!1,validator:pega.lang.isBoolean});this.setAttributeConfig("knobHandles",{value:a.knobHandles||!1,validator:pega.lang.isBoolean});this.setAttributeConfig("xTicks",{value:a.xTicks||!1});this.setAttributeConfig("yTicks",{value:a.yTicks||!1});this.setAttributeConfig("status",{value:a.status||!1,validator:pega.lang.isBoolean});this.setAttributeConfig("autoRatio",{value:a.autoRatio||!1,validator:pega.lang.isBoolean})},destroy:function(){var a=this.get("id")+"-handle-"+this.get("handles"),
b;for(b in this._handles)l.hasOwnProperty(this._handles,b)&&(h.purgeElement(this._handles[b]),this._handles[b].parentNode?this._handles[b].parentNode.removeChild(this._handles[b]):delete this._handles[b],this._dds[b].removeFromGroup(a));this._proxy&&(this._proxy.parentNode?this._proxy.parentNode.removeChild(this._proxy):delete this._proxy);this._status&&(this._status.parentNode?this._status.parentNode.removeChild(this._status):delete this._status);this.dd&&(this.dd.unreg(),c.removeClass(this._wrap,
this.CSS_DRAG));this._wrap!=this.get("element")&&(this.setStyle("position",""),this.setStyle("top",""),this.setStyle("left",""),this._wrap.parentNode&&this._wrap.parentNode.replaceChild(this.get("element"),this._wrap));this.removeClass(this.CSS_RESIZE);delete pega.util.Resize._instances[this.get("id")];for(var e in this)l.hasOwnProperty(this,e)&&(this[e]=null,delete this[e])},toString:function(){return this.get?"Resize (#"+this.get("id")+")":"Resize Utility"}});pega.util.Resize=k}})();
"undefined"!=typeof pega&&pega.register("resize",pega.util.Resize,{version:"2.5.2",build:"1076"});
