pega.ui.RDL={attachScrubberEvents:function(A){pega.ctx.dom.$(".rdl-scrubber").each(function(F,C){var G=C.parentNode.firstElementChild;pega.u.d.registerSinglePageNav(C,G);var B=$(G);var E=$(C);var D=E.find("a[href^='#']").filter(function(){return this.href.match(/#[a-zA-Z]/)});var H=function(){D.each(function(I,J){var K=B.find("a[id='"+J.hash.substring(1)+"']").first();K=K.next().get(0);if(pega.u.d.isSectionCurrentlyInView(K,G)){D.removeClass("Strong");$(J).addClass("Strong")}})};B.on("scroll",function(){H()});H()})},triggerAsyncBasedOnScrollHeight:function(C,B,J){var I=0,D,H,F;if(C.offsetHeight==0){return }H=C;if(J){I=parseInt($(H).css("max-height"),10)}else{if(B==document){F=B.body}else{F=B}}$(".lazyload-layout").css("display","none");D=J?H.offsetHeight<I:F.scrollHeight<=F.clientHeight;$(".lazyload-layout").css("display","");if(D){var E=this.getNextRowIndex(H);var G=H.getAttribute("data-pagesize");pega.ctx.RDL.isLoading=true;var A=H.getAttribute("data-uniqueid");setTimeout(function(){pega.ui.template.pzRDLTemplate.loadPage(E,G,H,event,function(){pega.ui.RDL.triggerAsyncBasedOnScrollHeight(C,B,J)})},0)}},attachScrollEvents:function(F,A){if(!A){A=document}else{if(A.target){A=A.target}}if($(A).hasClass("progressive-bodyScroll")||$(A).hasClass("progressive-rdlScroll")){A=A.parentNode}if(!F||F=="bodyScroll"){pega.ui.RDL.scrollTrigger=function(I){var H=pega.ctx.dom.getElementById("RDL_PAGINATE");if(!H||!$(H).is(":visible")){if(H){H.removeAttribute("id")}H=$(pega.ctx.dom.getContextRoot()).find(".progressive-bodyScroll:visible");H=H&&H.get(0)}if(H&&H.classList.contains("progressive-bodyScroll")){H.setAttribute("id","RDL_PAGINATE");$(H).addClass("rdl-loading");clearTimeout($.data(this,"scrollTimer"));$.data(this,"scrollTimer",setTimeout(function(){if(!pega.ctx.RDL.isLoading&&$(H).hasClass("progressive-bodyScroll")){pega.ui.RDL.paginate(H,"bodyScroll",I)}else{$(H).removeClass("rdl-loading")}},250));window.LayoutGroupModule&&LayoutGroupModule.initialiseLGTreatment()}};var B={};var E="";var D=$(A).find(".progressive-bodyScroll");if(D&&D.get(0)){D=D.get(0);if($(D).css("max-height")=="none"){window.LayoutGroupModule&&LayoutGroupModule.initialiseLGTreatment()}var C=$(D).scrollParent();if(C.length>0){C=C[0]}if(C==document||C.tagName=="BODY"){if(!$(document.body).hasClass("rdl-scrolllistener")){$(window).on("scroll",pega.ui.RDL.scrollTrigger);$(document.body).addClass("rdl-scrolllistener");B.scrollElement="window";E=pega.u.d.getSectionId(pega.u.d.getSectionDiv(D))}}else{if(!C.classList.contains("rdl-scrolllistener")){var G=$(C);G.on("scroll",pega.ui.RDL.scrollTrigger);G.addClass("rdl-scrolllistener");B.scrollElement=C;E=pega.u.d.getSectionId(pega.u.d.getSectionDiv(D))}}if(B.scrollElement){B.nullify=function(){var H,I;if(typeof this.scrollElement=="string"&&this.scrollElement=="window"){H=document.body;I=window}else{if(typeof this.scrollElement=="object"){H=this.scrollElement;I=this.scrollElement}}$(I).off("scroll",pega.ui.RDL.scrollTrigger);$(H).removeClass("rdl-scrolllistener");this.scrollElement=null};pega.u.d.registerAsHarnessElement(B,E)}pega.ui.RDL.triggerAsyncBasedOnScrollHeight(D,C)}}if(!F||F=="rdlScroll"){$(A).find(".progressive-rdlScroll").each(function(H,J){if(!$(J).hasClass("rdl-scrolllistener")){B={};var I=$(J).css("max-height");I=parseInt(I);$(J).addClass("rdl-scrolllistener");var K=function(){if(I&&$(J).height()==I){$(J).addClass("rdl-loading")}clearTimeout($.data(this,"scrollTimer"));$.data(this,"scrollTimer",setTimeout(function(){if(!pega.ctx.RDL.isLoading&&$(J).hasClass("progressive-rdlScroll")){pega.ui.RDL.paginate(J,"rdlScroll")}else{$(J).removeClass("rdl-loading")}},250));window.LayoutGroupModule&&LayoutGroupModule.initialiseLGTreatment()};$(J).on("scroll",K);B.scrollElement=J;E=pega.u.d.getSectionId(pega.u.d.getSectionDiv(J));if(B.scrollElement){B.nullify=function(){$(this.scrollElement).off("scroll",pega.ui.RDL.scrollTrigger);$(this.scrollElement).removeClass("rdl-scrolllistener");this.scrollElement=null};pega.u.d.registerAsHarnessElement(B,E)}pega.ui.RDL.triggerAsyncBasedOnScrollHeight(J,C,true)}})}},getNextRowIndex:function(F){var B=0;var E=0;for(var D=0;D<F.children.length;D++){var G=F.children[D];var A=G.getAttribute("base_ref");if(A){var C=parseInt(A.substring(A.lastIndexOf("(")+1,A.length-1),10);if(C>E){E=C}}}B=E;return ++B},paginate:function(H,I,A){var C=pega.ctxmgr.getCurrentHarnessContext();var D=pega.ctxmgr.getContextByTarget(H);pega.ctxmgr.setContext(D);if(pega.ui.RDL.evaluateScrollPosition(H,I)){var F;if(H){F=this.getNextRowIndex(H)}var G=H.getAttribute("data-pagesize");if(F<G){var E=document.createElement("div");pega.ctx.RDL.isLoading=false;pega.ui.template.pzRDLTemplate.loadNoMoreDataDiv(H,E,null);return }pega.ctx.RDL.isLoading=true;var B=H.getAttribute("data-uniqueid");setTimeout(function(){pega.ui.template.pzRDLTemplate.loadPage(F,G,H,A);$(H).removeClass("rdl-loading")},0)}else{$(H).removeClass("rdl-loading");pega.ctx.RDL.isLoading=false}pega.ctxmgr.resetContext(C)},evaluateScrollPosition:function(G,H){var A=false;if(H=="bodyScroll"){var D=window.innerHeight;var I=0;if(G.getClientRects()[0]){I=G.getClientRects()[0].top}var F=G.clientHeight;A=I+F-40<=D}else{var E=G.scrollTop;var B=G.offsetHeight;var C=G.scrollHeight;A=E+B+40>=C}return A},filterHiddenElements:function(A){if(!A){return[]}A=Array.from(A);return A.filter(function(B){if(!B.style||isNaN(B.offsetWidth)){return true}return !(B.style.display==="none"||B.style.visibility==="hidden"||B.offsetWidth===0)})},getInnerElementsFromRDLRow:function(D){if(!D){return[]}var C=D.querySelectorAll("img,i,input,a,button,textarea,select");var B=Array.from(D.querySelectorAll('[data-uniqueid*="RDL"]')||[]);var A=Array.from(D.querySelectorAll('[id="PEGA_GRID_CONTENT"]')||[]);if(!C){return[]}C=Array.from(C);C=pega.ui.RDL.filterHiddenElements(C);B=pega.ui.RDL.filterHiddenElements(B);A=pega.ui.RDL.filterHiddenElements(A);C=C.filter(function(G){var F=false;for(var E=0;E<B.length;E++){if(B[E].contains(G)){F=true;break}}for(var E=0;E<A.length;E++){if(A[E].contains(G)){F=true;break}}return !F});C=C.concat(B);C=C.concat(A);return C},changeElementsTabIndex:function(D,A,C){var B=pega.ui.RDL.getInnerElementsFromRDLRow(D);if(B&&B.length>0){B.forEach(function(F){var E=F.getAttribute("tabindex");if(!(C&&E==="0")){F.setAttribute("tabindex",A)}})}},changeTabIndexOfRDLNodes:function(B,A){if(!B){return }var C=B.childNodes;C=pega.ui.RDL.getFirstLevelBaseReferences(C);if(C&&C.length>0){C.forEach(function(D){D.setAttribute("tabindex",A)})}},focusFirstFormElement:function(B){var A=pega.ui.RDL.getInnerElementsFromRDLRow(B);if(A&&A.length>0){A[0].focus()}},addARIAToAllRequiredElements:function(C,A,D){var B=pega.ui.RDL.getInnerElementsFromRDLRow(C);if(B&&B.length>0){B=Array.from(B);B.forEach(function(E){E.setAttribute(A,D)})}},addColIndexToAllRequiredElements:function(C){var B=pega.ui.RDL.getInnerElementsFromRDLRow(C);if(B&&B.length>0){B=Array.from(B);var A=0;B.forEach(function(D){D.setAttribute("aria-colindex",A+"");A++})}},getFocusableElements:function(A){var C=pega.ui.RDL.getInnerElementsFromRDLRow(A);var D=[];for(var B=0;B<C.length;B++){D.push(C[B])}return D},getFirstLevelBaseReferences:function(A){if(!A||A.length===0){return[]}A=Array.from(A);return A.filter(function(B){if(B.getAttribute){if(B.style.display==="none"||B.style.visibility==="hidden"){return false}if(B.getAttribute("data-node-id")==="pyRDLNoMoreData"){return true}return !!B.getAttribute("base_ref")}return false})},createRDLCellContext:function(A,E){if(!A){return }if(!pega.ctx.accessRDLCellContext){pega.ctx.accessRDLCellContext={}}var B=A.getAttribute("base_ref");var C=pega.ctx.accessRDLCellContext[E+B];if(!B||(C&&C.active)){return }var D=pega.ui.RDL.getFocusableElements(A);pega.ctx.accessRDLCellContext[E+B]={nodes:D,currentIndex:0,active:false}},getRDLNodeFromTarget:function(B){if(!B){return null}var A=B.closest("div[data-repeat-source]");return A},getRDLCellFromTarget:function(E){var B=null;var C=null;var A=50;while(!C){if(A===0){return null}if(!E){return null}B=E.getAttribute&&E.getAttribute("base_ref");if(B){var D=pega.ui.RDL.getRDLNodeFromTarget(E);var F=D&&D.getAttribute("data-uniqueid");C=pega.ctx.accessRDLCellContext[F+B]}if(C){return E}E=E.parentElement;A--}},handleRDLCellEvent:function(H){var E=pega.ui.RDL.getRDLCellFromTarget(H.target);if(!E){return }var A=E.getAttribute("base_ref");var I=pega.ui.RDL.getRDLNodeFromTarget(H.target);var G=I.getAttribute("data-uniqueid");var J=G+A;var B=pega.ctx.accessRDLCellContext[J];var C=pega.ui.RDL.getFocusableElements(E);var F=B.currentIndex;if(!C||C.length===0){return }switch(H.keyCode){case 27:if(H.target){pega.ui.RDL.changeElementsTabIndex(E,"-1")}pega.ctx.accessRDLCellContext[J].currentIndex=0;pega.ctx.accessRDLCellContext[J].active=false;E.setAttribute("aria-label",rdlRowViewDetails);H.stopPropagation();break;case 39:if(!B.active){return }H.stopPropagation();H.preventDefault();if(F===C.length-1){return }pega.ui.RDL.changeElementsTabIndex(E,"-1");pega.ui.RDL.addARIAToAllRequiredElements(E,"aria-hidden","true");F++;C[F].setAttribute("tabindex","0");C[F].removeAttribute("aria-hidden");C[F].focus();pega.ctx.accessRDLCellContext[J].currentIndex=F;break;case 37:if(!B.active){return }H.stopPropagation();H.preventDefault();if(F===0){return }pega.ui.RDL.changeElementsTabIndex(E,"-1");pega.ui.RDL.addARIAToAllRequiredElements(E,"aria-hidden","true");F--;C[F].setAttribute("tabindex","0");C[F].removeAttribute("aria-hidden");C[F].focus();pega.ctx.accessRDLCellContext[J].currentIndex=F;break;case 40:case 38:var D=pega.ui.RDL.getInnerElementsFromRDLRow(E);if(B.active&&D.length!==1){H.stopPropagation();return }break;default:console.log("invalid key code given")}},addArrowKeyEventListener:function(D,G){if(D&&D.offsetHeight>0){var A=this;if(!A.eventTracker){A.eventTracker={}}else{var F=A.eventTracker[G];if(F&&F.length>0){F.forEach(function(H){var I=Object.keys(H);I.forEach(function(J){D.removeEventListener(J,H[J])})})}}var C=function(U){try{var L=(U.target.tagName==="INPUT"&&U.target.type==="text")||U.target.tagName==="TEXTAREA";if(L){return }var K=U.target===U.target.closest("div[data-repeat-source]>div[name='BASE_REF']");if(!K&&U.keyCode===13){return }var Z=(U.target.getAttribute("data-uniqueid")&&U.target.getAttribute("data-uniqueid").indexOf("RDL")!==-1);if(Z){pega.ui.RDL.attachAccessibilityEventsToAnRDLNode(U.target);var W=U.target.childNodes;W=pega.ui.RDL.getFirstLevelBaseReferences(W);W.length&&W[0].focus();return }var O=U.target.getAttribute("data-node-id")==="pyRDLNoMoreData";if(!O&&!K){pega.ui.RDL.handleRDLCellEvent(U);var M=pega.ui.RDL.getRDLCellFromTarget(U.target);var J=pega.ui.RDL.getInnerElementsFromRDLRow(M);if(U.keyCode===39||(U.keyCode===40&&J.length!==1)||U.keyCode===37||(U.keyCode===38&&J.length!==1)){return }}var N=G;var V=pega.ctx.visibleRDLsOnPage[N];var R=V.nodes;var H=V.currentIndex;if(!R||R.length===0){return }switch(U.keyCode){case 39:var M=pega.ui.RDL.getRDLCellFromTarget(U.target);var J=pega.ui.RDL.getInnerElementsFromRDLRow(M);if(J.length===1){return }case 40:U.stopPropagation();if(H===R.length-1){return }H++;R.forEach(function(b){b.setAttribute("tabindex","-1")});var J=pega.ui.RDL.getInnerElementsFromRDLRow(R[H]);if(J.length!==1){R[H].setAttribute("tabindex","0");R[H].focus()}else{J[0].focus()}break;case 37:var M=pega.ui.RDL.getRDLCellFromTarget(U.target);var J=pega.ui.RDL.getInnerElementsFromRDLRow(M);if(J.length===1){return }case 38:U.stopPropagation();if(H===0){return }H--;R.forEach(function(b){b.setAttribute("tabindex","-1")});var J=pega.ui.RDL.getInnerElementsFromRDLRow(R[H]);if(J.length!==1){R[H].setAttribute("tabindex","0");R[H].focus()}else{J[0].focus()}break;case 27:R.forEach(function(b){b.setAttribute("tabindex","-1")});R[H].setAttribute("tabindex","0");R[H].focus();U.stopPropagation();break;case 13:if(O){return }var M=pega.ui.RDL.getRDLCellFromTarget(U.target);var J=pega.ui.RDL.getInnerElementsFromRDLRow(M);if(J.length===1){return }if(M){var X=M.getAttribute("title");var P=M.getAttribute("base_ref");var Y=pega.ui.RDL.getRDLNodeFromTarget(M);var N=Y.getAttribute("data-uniqueid");var a=N+P;var I=pega.ctx.accessRDLCellContext[a];var Q=pega.ui.RDL.getFocusableElements(M);var S=I.currentIndex;M.setAttribute("title",rdlRowNavigationInfo);setTimeout(function(){if(X){M.setAttribute("title",X)}else{M.removeAttribute("title")}},300);pega.ui.RDL.changeElementsTabIndex(M,"-1");pega.ui.RDL.addARIAToAllRequiredElements(M,"aria-hidden","true");Q[S].setAttribute("tabindex","0");Q[S].removeAttribute("aria-hidden");Q[S].focus();pega.ctx.accessRDLCellContext[a].active=true}break;default:console.log("invalid key code given")}pega.ctx.visibleRDLsOnPage[N].nodes=R;pega.ctx.visibleRDLsOnPage[N].currentIndex=H}catch(T){}};var E=function(H){try{if(H.keyCode===27){H.stopPropagation()}}catch(I){}};D.addEventListener("keydown",C);D.addEventListener("keyup",E);var B={keyup:E,keydown:C};if(!A.eventTracker[G]){A.eventTracker[G]=[B]}else{A.eventTracker[G].push(B)}}},addAriaAttributes:function(A){A.setAttribute("role","grid");A.setAttribute("aria-rowcount","-1");var B=A.childNodes;B=pega.ui.RDL.getFirstLevelBaseReferences(B);A.setAttribute("aria-label",B.length+" items");B.forEach(function(D,C){D.setAttribute("role","row");D.setAttribute("aria-rowindex",C+"")})},setRDLNodeContext:function(E,B,A){if(A===undefined){A=-1}if(!B){return }var D=B.childNodes;D=pega.ui.RDL.getFirstLevelBaseReferences(D);if(A===-1){A=0}var C=pega.ui.RDL.getInnerElementsFromRDLRow(D[A]);if(C.length===1){C[0].setAttribute("tabindex","0")}else{D[A].setAttribute("tabindex","0")}pega.ctx.visibleRDLsOnPage[E]={nodes:D,currentIndex:A}},attachAccessibilityEventsToAnRDLNode:function(B){var D=B.getAttribute("data-uniqueid");if(!D){return }pega.ui.RDL.addAriaAttributes(B);var C=B.childNodes;C=pega.ui.RDL.getFirstLevelBaseReferences(C);if(C&&C.length>0){var A=-1;C=Array.from(C);C.forEach(function(F,E){if(F.getAttribute("tabindex")==="0"){A=E}});C.forEach(function(F){if(F.getAttribute("data-node-id")!=="pyRDLNoMoreData"){var E=pega.ui.RDL.getInnerElementsFromRDLRow(F);if(E.length>1){F.setAttribute("aria-label",rdlRowViewDetails)}}F.setAttribute("tabindex","-1");pega.ui.RDL.changeElementsTabIndex(F,"-1",true);pega.ui.RDL.addARIAToAllRequiredElements(F,"role","gridcell");pega.ui.RDL.addARIAToAllRequiredElements(F,"aria-hidden","true");pega.ui.RDL.addColIndexToAllRequiredElements(F);pega.ui.RDL.createRDLCellContext(F,D)});pega.ui.RDL.setRDLNodeContext(D,B,A);pega.ui.RDL.addArrowKeyEventListener(B,D)}},attachAccessibilityEvents:function(B,A){if(!B||B.length===0){return }if(!pega.ctx.visibleRDLsOnPage){pega.ctx.visibleRDLsOnPage={}}B.forEach(function(D){if(!A){A=pega.ctx.dom}var C=A.querySelectorAll("[data-uniqueid='"+D+"']");if(!C){return }C=Array.from(C);C.forEach(function(E){pega.ui.RDL.attachAccessibilityEventsToAnRDLNode(E)})})},attachOnLoadEvents:function(B){if(B.target){B=B.target}try{var A=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);if(!A&&B){setTimeout(function(){pega.ui.RDL.attachAccessibilityEvents(pega.ctx.RDLUniqueIds,B)},500)}}catch(C){}if(pega.ctx.isMDC&&B.getAttribute("data-mdc-recordid")&&B.classList.contains("hide")){if(pega.ui.EventsEmitter){pega.ui.EventsEmitter.subscribeOnce("postMDCRender",function(){var D=pega.ctx.dom.getContextRoot();pega.ui.RDL.attachScrubberEvents(D);pega.ui.RDL.attachScrollEvents("",D)},null)}}else{pega.ui.RDL.attachScrubberEvents(B);pega.ui.RDL.attachScrollEvents("",B)}setTimeout(function(){if(!pega.ctx.RDL.sortableInstances){pega.ctx.RDL.sortableInstances=[]}if(!pega.ctx.RDL.noResultsHashMap){pega.ctx.RDL.noResultsHashMap={}}var H;if(B instanceof Node){H=B.querySelectorAll("[data-sortable-rdl] > .content")}else{H=pega.ctx.dom.querySelectorAll("[data-sortable-rdl] > .content")}for(var G=0;G<H.length;G++){var F={};F.animation=150;F.dragClass="draggingClass";F.filter=".no-item-section";var J=H[G];var E=JSON.parse($(J).closest("[data-sortable-rdl]")[0].dataset.sortableRdl);if(J.classList.contains("rdlHasNoRows")){var I=J.querySelector("div");if(I){I.classList.add("no-item-section")}}var D=new pega.ui.Sortable(J,pega.ctxmgr.getContextByTarget(J).pzHarnessID+E.groupName,F);D.preActivity=E.preActivity;D.postActivity=E.postActivity;D.onStart=function(L){for(var M=0;M<pega.ctx.RDL.sortableInstances.length;M++){var N=pega.ctx.RDL.sortableInstances[M];if(this.group.name===N.group.name){var O=N.el.classList.contains("rdlHasNoRows");if(O){if(N.el.children.length>0){var K=N.el.children[0];pega.ctx.RDL.noResultsHashMap["Sortable-"+M]=K;N.el.removeChild(K)}else{pega.ctx.RDL.noResultsHashMap["Sortable-"+M]=N.el.text}N.el.text=null}}}};D.onMove=function(K){if(K.sourceLocation.children.length==0||(K.sourceLocation.children.length==1&&K.sourceLocation.children[0]==K.draggedElement)){K.sourceLocation.text=null}return !K.relatedElement.classList.contains("rdl-nomoredatasection")};D.onDrop=function(M){var L=M.sourceLocation.dataset.repeatSource;var K=M.targetLocation.dataset.repeatSource;var N=++M.oldIndex;var P=++M.newIndex;if(M.sourceLocation===M.targetLocation&&N===P){return }var O=SafeURL_createFromURL(pega.ctx.url);O.put("pyActivity","@baseclass.pzRepeatingListsDropHandler");O.put("fromFullRefToPageList",L);O.put("toFullRefToPageList",K);O.put("fromIndex",N);O.put("toIndex",P);O.put("preActivityName",this.preActivity);O.put("postActivityName",this.postActivity);O.remove("pzPrimaryPageName");pega.u.d.asyncRequest("POST",O,{success:function(Q){pega.ui.EventsEmitter.publishSync("RDL.DROPSUCCESS",M);if(M.sourceLocation!==M.targetLocation){pega.u.d.reloadSection(M.sourceLocation,"","",false,false,-1,false,null,null,null,null)}pega.u.d.reloadSection(M.targetLocation,"","",false,false,-1,false,null,null,null,null)},failure:function(Q){pega.ui.logger.LogHelper.debug("Unable to successfully drop");pega.ui.EventsEmitter.publishSync("RDL.DROPFAILURE",M);if(M.sourceLocation!==M.targetLocation){pega.u.d.reloadSection(M.sourceLocation,"","",false,false,-1,false,null,null,null,null)}pega.u.d.reloadSection(M.targetLocation,"","",false,false,-1,false,null,null,null,null);pega.u.d.ajaxFailureSecondaryCount=-1}})};D.onEnd=function(K){for(var L=0;L<pega.ctx.RDL.sortableInstances.length;L++){var M=pega.ctx.RDL.sortableInstances[L];if(pega.ctx.RDL.noResultsHashMap["Sortable-"+L]&&M.el.children.length==0){if(pega.ctx.RDL.noResultsHashMap["Sortable-"+L] instanceof Node){M.el.appendChild(pega.ctx.RDL.noResultsHashMap["Sortable-"+L])}else{M.el.text=pega.ctx.RDL.noResultsHashMap["Sortable-"+L]}}}pega.ctx.RDL.noResultsHashMap={}};pega.ctx.RDL.sortableInstances.push(D)}},0)},cleanUpOnUnloadEvents:function(){$(window).off("scroll",pega.ui.RDL.scrollTrigger);if(pega.ctx.RDL.sortableInstances){for(var A=0;A<pega.ctx.RDL.sortableInstances.length;A++){pega.ctx.RDL.sortableInstances[A].destroy()}pega.ctx.RDL.sortableInstances=[]}if(pega.ctx.RDL.noResultsHashMap){pega.ctx.RDL.noResultsHashMap={}}},getAllRDLInfo:function(A){if(A){var B=pega.ui.DataRepeaterUtils.getAbsoluteDataSourceFromDataSource(A);datsource=B.datasource;if(!A){return[]}var D=pega.ctx.dom.querySelectorAll("[data-repeat-source='"+A+"']");var E=[];for(var C=0;C<D.length;C++){E[C]=this.getRDLInfo(D[C])}return E}},getRDLInfo:function(A){var B={};B.RDLNode=A;B.templatingStatus=A.hasAttribute("data-template")?"Y":"N";if(A.classList.contains("progressive-rdlScroll")||A.classList.contains("progressive-bodyScroll")||(A.lastElementChild&&A.lastElementChild.classList.contains("rdl-nomoredatasection"))){B.paginationType="scroll"}else{if(A.classList.contains("progressive-useraction")){B.paginationType="useraction"}else{B.paginationType="none"}}B.isCategorized=A.classList.contains("content-categorized");return B},getAndUpdateAllRDLsForPartialRefresh:function(B,J,E){var N=["data-expr-id","rw"];var A=["data-expr-id-temp","rw-temp"];var M=N;var H=A;if(J){M=A;H=N}var K=null;if(E){K=[this.getRDLInfo(E)]}else{K=this.getAllRDLInfo(B)}for(var I=0;I<K.length;I++){var C=true;if(K[I].paginationType=="scroll"){var G=K[I].RDLNode.lastElementChild;if(G){if(!G.classList.contains("rdl-nomoredatasection")){C=false}}}else{if(K[I].paginationType=="useraction"){if($(K[I].RDLNode).siblings(".RDLPaginator:visible")[0]){C=false}}}if(K[I].isCategorized){C=false}var D=K[I].isCategorized||K[I].RDLNode.children.length<=1;if(!D){for(var F=0;F<M.length;F++){if(K[I].RDLNode.hasAttribute(M[F])){var L=K[I].RDLNode.getAttribute(M[F]);K[I].RDLNode.setAttribute(H[F],L);K[I].RDLNode.removeAttribute(M[F]);break}}}if(!C){K.splice(I,1);I--}}if(!J){return K}},getRDLsToRefresh:function(A,D){var J=pega.ui.RDL.getAndUpdateAllRDLsForPartialRefresh(A,false,D);var I=[];for(var F=0;F<J.length;F++){var G=pega.u.d.getSectionDiv(J[F].RDLNode);var H=pega.u.d.getBaseRef(G)||pega.u.d.primaryPageName;var E=G.getAttribute("node_name");var B=J[F].templatingStatus;var C=J[F].RDLNode.getAttribute("data-rowmethodname")||"";I.push(H+","+E+","+C+","+B)}return I},appendRow:function(C,H,E){var F=H.match(/\|\|RDLROWMARKUP_BEGIN\|\|([\s\S]*?)\|\|RDLROWMARKUP_END\|\|/g);if(!F||F.length==0){return }var I=pega.ui.RDL&&pega.ui.RDL.getAndUpdateAllRDLsForPartialRefresh(C,false,E);if(I){for(var G=0;G<I.length;G++){var B=I[G].isCategorized?"replace":"append";var J=I[G].RDLNode;if(I[G].paginationType=="scroll"){B="insert";J=I[G].RDLNode.lastElementChild}var D=F.shift();var A=D.match(/\|\|RDLROWMARKUP_BEGIN\|\|([\s\S]*?)\|\|RDLROWMARKUP_END\|\|/);A=A[1];if(A){pega.u.d.loadDOMObject(I[G].RDLNode,A,null,{domAction:B,domElement:J})}}}setTimeout(function(){pega.ui.RDL.getAndUpdateAllRDLsForPartialRefresh(C,true,E)},0)},loadAll:function(B,C){C=C||{};var F=C.rdlNode;C.generateNoMoreDataDiv=!0;F?B=F.getAttribute("data-repeat-source"):F=document.querySelector("div[data-repeat-source='"+B+"']");var G=F.getAttribute("data-uniqueid")?F.parentNode.querySelector("div.rdl-paginatorsection"):F.parentNode.querySelector("div.RDLPaginator");G.style.display="none";var E=F.querySelectorAll(".rdlShowless");pega.ui.RDL.focusNewRow=false;if(0<E.length){pega.ui.RDL.focusNewRow=true;for(var D=0;D<E.length;D++){E[D].classList.remove("rdlShowless")}pega.ui.RDL.changeTabIndexOfRDLNodes(F,"-1");var A=parseInt(E[0].getAttribute("aria-rowindex"))||1;var H=F.getAttribute("data-uniqueid");pega.ui.RDL.setRDLNodeContext(H,F,A-1);E[0].tabIndex=0;E[0].focus()}else{pega.ui.RDL.fetchAndAppend(B,C)}},showless:function(B,C){C=C||{};var E=C.rdlNode;E?B=E.getAttribute("data-repeat-source"):E=document.querySelector("div[data-repeat-source='"+B+"']");var A=parseInt(E.getAttribute("data-pagesize"));var F=E.getAttribute("data-uniqueid")?E.parentNode.querySelector("div.rdl-paginatorsection"):E.parentNode.querySelector("div.RDLPaginator");F.style.display="block";for(var D=A;D<E.children.length;D++){E.children[D].classList.add("rdlShowless")}pega.ui.RDL.changeTabIndexOfRDLNodes(E,"-1");var G=E.getAttribute("data-uniqueid");pega.ui.RDL.setRDLNodeContext(G,E);if(E.children.length>0){E.children[0].tabIndex=0;E.children[0].focus()}},fetchAndAppend:function(A,M){M=M||{};var I=M.rdlNode;if(I){A=I.getAttribute("data-repeat-source")}if(M.fetchLastRow){var G=this.getRDLsToRefresh(A,I);var L=G.join("||");if(L){var E=pega.ui.HarnessContextMgr;var C=SafeURL_createFromURL(E.get("url"));C.put("listSource",A);C.put("pyTargetStream","pzGetRowMarkup");C.put("pyActivity","ShowStream");var B=new SafeURL();B.put("streamList",L);var K={success:function(N){pega.ui.RDL.appendRow(A,N.responseText,I)},failure:function(N){}};pega.u.d.asyncRequest("POST",C,K,B)}}else{I=I||document.querySelector("div[data-repeat-source='"+A+"']");var F=I.children.length,J=0,H,D=typeof M.recordsToFetch!="undefined"?M.recordsToFetch:-1;if(F>0){J=this.getNextRowIndex(I)}pega.ui.template.pzRDLTemplate.loadPage(parseInt(J),D,I,null,null,{calledFromFetchAndAppend:true,generateNoMoreDataDiv:M.generateNoMoreDataDiv})}}};pega.u.d.attachOnload(pega.ui.RDL.attachOnLoadEvents,true);pega.u.d.attachOnUnload(pega.ui.RDL.cleanUpOnUnloadEvents);pega.ui.Doc.prototype.isSectionCurrentlyInView=function(E,D){var K=$(E);var L=D?$(D):$(window);var M=L.height();var H=L.scrollTop();var I=L.offset().top;var C=K.offset().top;var G=K.height();var F=I>C&&C+G>I;var B=Math.floor(I)==Math.floor(C);var A=H+M==L[0].scrollHeight;var J=M==L[0].scrollHeight;if(!J&&(F||B||A)){return true}else{return false}};